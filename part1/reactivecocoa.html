
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Writing is nice · Objective-C</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Sam Lau">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-local-video/video-js.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-ace/ace.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../part2/" />
    
    
    <link rel="prev" href="./" />
    

    
    
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="./">
            
                <a href="./">
            
                    
                    Part I
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.1" data-path="reactivecocoa.html">
            
                <a href="reactivecocoa.html">
            
                    
                    Writing is nice
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../part2/">
            
                <a href="../part2/">
            
                    
                    Part II
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../part2/stackview.html">
            
                <a href="../part2/stackview.html">
            
                    
                    We love feedback
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Writing is nice</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#&#x57FA;&#x7840;"><b>1. </b>&#x57FA;&#x7840;</a></li><ul><li><span class="title-icon "></span><a href="#racsignal-&#x89E6;&#x53D1;&#x6D41;&#x7A0B;"><b>1.1. </b>RACSignal &#x89E6;&#x53D1;&#x6D41;&#x7A0B;</a></li><li><span class="title-icon "></span><a href="#racsubject&#x3001;racreplaysubject"><b>1.2. </b>RACSubject&#x3001;RACReplaySubject</a></li></ul><li><span class="title-icon "></span><a href="#&#x51B7;&#x4FE1;&#x53F7;&#x4E0E;&#x70ED;&#x4FE1;&#x53F7;"><b>2. </b>&#x51B7;&#x4FE1;&#x53F7;&#x4E0E;&#x70ED;&#x4FE1;&#x53F7;</a></li><ul><li><span class="title-icon "></span><a href="#&#x70ED;&#x4FE1;&#x53F7;"><b>2.1. </b>&#x70ED;&#x4FE1;&#x53F7;</a></li><li><span class="title-icon "></span><a href="#&#x51B7;&#x4FE1;&#x53F7;"><b>2.2. </b>&#x51B7;&#x4FE1;&#x53F7;</a></li><li><span class="title-icon "></span><a href="#&#x51B7;&#x4FE1;&#x53F7;&#x3001;&#x70ED;&#x4FE1;&#x53F7;&#x6BD4;&#x8F83;"><b>2.3. </b>&#x51B7;&#x4FE1;&#x53F7;&#x3001;&#x70ED;&#x4FE1;&#x53F7;&#x6BD4;&#x8F83;</a></li></ul><li><span class="title-icon "></span><a href="#&#x57FA;&#x7840;&#x4F7F;&#x7528;"><b>3. </b>&#x57FA;&#x7840;&#x4F7F;&#x7528;</a></li><ul><li><span class="title-icon "></span><a href="#racmulticastconnection"><b>3.1. </b>RACMulticastConnection</a></li><li><span class="title-icon "></span><a href="#&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;"><b>3.2. </b>&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x8282;&#x6D41;throttle"><b>3.3. </b>&#x4FE1;&#x53F7;&#x8282;&#x6D41;:throttle</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x9519;&#x8BEF;&#x91CD;&#x8BD5;retry"><b>3.4. </b>&#x4FE1;&#x53F7;&#x9519;&#x8BEF;&#x91CD;&#x8BD5;:retry</a></li><li><span class="title-icon "></span><a href="#&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;-switchtolatest"><b>3.5. </b>&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;: switchToLatest</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x987A;&#x5E8F;donext&#x3001;docompleted"><b>3.6. </b>&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x987A;&#x5E8F;:doNext&#x3001;doCompleted</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x53D6;&#x503C;take&#x3001;takeuntil&#x3001;takelast"><b>3.7. </b>&#x4FE1;&#x53F7;&#x53D6;&#x503C;:take&#x3001;takeUntil&#x3001;takeLast</a></li><li><span class="title-icon "></span><a href="#map&#x3001;flattenmap&#x62E6;&#x622A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x6570;&#x636E;"><b>3.8. </b>map&#x3001;flattenMap(&#x62E6;&#x622A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x6570;&#x636E;)</a></li><ul><li><span class="title-icon "></span><a href="#&#x793A;&#x4F8B;"><b>3.8.1. </b>&#x793A;&#x4F8B;</a></li><li><span class="title-icon "></span><a href="#&#x793A;&#x4F8B;_1"><b>3.8.2. </b>&#x793A;&#x4F8B;</a></li></ul><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;delay&#x5EF6;&#x8FDF;"><b>3.9. </b>&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;:delay(&#x5EF6;&#x8FDF;)</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;interval&#x5B9A;&#x65F6;"><b>3.10. </b>&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;:interval(&#x5B9A;&#x65F6;)</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;timeout&#x8D85;&#x65F6;"><b>3.11. </b>&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;:timeout(&#x8D85;&#x65F6;)</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;distinctuntilchanged"><b>3.12. </b>&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;:distinctUntilChanged</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;ignore&#x5FFD;&#x7565;"><b>3.13. </b>&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;:ignore(&#x5FFD;&#x7565;)</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;filter&#x8FC7;&#x6EE4;"><b>3.14. </b>&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;:filter(&#x8FC7;&#x6EE4;)</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x5408;&#x5E76;combinelatest&#x7ED3;&#x5408;&#x3001;reduce&#x805A;&#x5408;"><b>3.15. </b>&#x4FE1;&#x53F7;&#x5408;&#x5E76;:combineLatest(&#x7ED3;&#x5408;)&#x3001;reduce(&#x805A;&#x5408;)</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x5408;&#x5E76;zipwith&#x538B;&#x7F29;"><b>3.16. </b>&#x4FE1;&#x53F7;&#x5408;&#x5E76;:zipWith(&#x538B;&#x7F29;)</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x5408;&#x5E76;merge&#x5408;&#x5E76;"><b>3.17. </b>&#x4FE1;&#x53F7;&#x5408;&#x5E76;:merge(&#x5408;&#x5E76;)</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x62FC;&#x63A5;then&#x8FDE;&#x63A5;"><b>3.18. </b>&#x4FE1;&#x53F7;&#x62FC;&#x63A5;:then(&#x8FDE;&#x63A5;)</a></li><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x62FC;&#x63A5;concat&#x5408;&#x5E76;"><b>3.19. </b>&#x4FE1;&#x53F7;&#x62FC;&#x63A5;:concat(&#x5408;&#x5E76;)</a></li><li><span class="title-icon "></span><a href="#racobserve"><b>3.20. </b>RACObserve</a></li><li><span class="title-icon "></span><a href="#&#x5176;&#x4ED6;&#x4F7F;&#x7528;"><b>3.21. </b>&#x5176;&#x4ED6;&#x4F7F;&#x7528;</a></li></ul><li><span class="title-icon "></span><a href="#raccommand"><b>4. </b>RACCommand</a></li><ul><li><span class="title-icon "></span><a href="#&#x4F7F;&#x7528;"><b>4.1. </b>&#x4F7F;&#x7528;</a></li></ul><li><span class="title-icon "></span><a href="#racchannel"><b>5. </b>RACChannel</a></li><ul><li><span class="title-icon "></span><a href="#racchannel&#x5B9E;&#x73B0;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;"><b>5.1. </b>RACChannel&#x5B9E;&#x73B0;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;</a></li></ul><li><span class="title-icon "></span><a href="#foundation"><b>6. </b>Foundation</a></li><ul><li><span class="title-icon "></span><a href="#nsobject"><b>6.1. </b>NSObject</a></li><ul><li><span class="title-icon "></span><a href="#nsobjectraclifting"><b>6.1.1. </b>NSObject+RACLifting</a></li></ul><li><span class="title-icon "></span><a href="#nsnotificationcenter"><b>6.2. </b>NSNotificationCenter</a></li><li><span class="title-icon "></span><a href="#nsstring"><b>6.3. </b>NSString</a></li></ul><li><span class="title-icon "></span><a href="#uikit"><b>7. </b>UIKit</a></li><ul><li><span class="title-icon "></span><a href="#uicontrolracsignalsupportprivate"><b>7.1. </b>UIControl+RACSignalSupportPrivate</a></li><li><span class="title-icon "></span><a href="#uitextfieldracsignalsupport"><b>7.2. </b>UITextField+RACSignalSupport</a></li></ul><li><span class="title-icon "></span><a href="#&#x4FE1;&#x53F7;&#x76F8;&#x5173;&#x7C7B;"><b>8. </b>&#x4FE1;&#x53F7;&#x76F8;&#x5173;&#x7C7B;</a></li><li><span class="title-icon "></span><a href="#disposable"><b>9. </b>Disposable</a></li><li><span class="title-icon "></span><a href="#tips"><b>10. </b>Tips</a></li><li><span class="title-icon "></span><a href="#racmvvm&#x5F00;&#x53D1;&#x89C4;&#x7EA6;"><b>11. </b>RAC&amp;MVVM&#x5F00;&#x53D1;&#x89C4;&#x7EA6;</a></li><ul><li><span class="title-icon "></span><a href="#vm&#x5C42;"><b>11.1. </b>VM&#x5C42;</a></li><li><span class="title-icon "></span><a href="#v&#x5C42;"><b>11.2. </b>V&#x5C42;</a></li><ul><li><span class="title-icon "></span><a href="#controller"><b>11.2.1. </b>Controller</a></li><li><span class="title-icon "></span><a href="#&#x81EA;&#x5B9A;&#x4E49;uiview"><b>11.2.2. </b>&#x81EA;&#x5B9A;&#x4E49;UIView</a></li><li><span class="title-icon "></span><a href="#&#x81EA;&#x5B9A;&#x4E49;&#x590D;&#x7528;&#x673A;&#x5236;uiview"><b>11.2.3. </b>&#x81EA;&#x5B9A;&#x4E49;&#x590D;&#x7528;&#x673A;&#x5236;UIView</a></li></ul></ul><li><span class="title-icon "></span><a href="#mvvmrac"><b>12. </b>MVVM&amp;RAC</a></li><ul><li><span class="title-icon "></span><a href="#&#x4F7F;&#x7528;&#x8BBE;&#x8BA1;"><b>12.1. </b>&#x4F7F;&#x7528;&#x8BBE;&#x8BA1;</a></li><li><span class="title-icon "></span><a href="#&#x793A;&#x4F8B;&#xFF1A;&#x5217;&#x8868;&#x5237;&#x65B0;"><b>12.2. </b>&#x793A;&#x4F8B;&#xFF1A;&#x5217;&#x8868;&#x5237;&#x65B0;</a></li><ul><li><span class="title-icon "></span><a href="#circlelistviewcontroller"><b>12.2.1. </b>CircleListViewController</a></li><li><span class="title-icon "></span><a href="#viewmodel"><b>12.2.2. </b>ViewModel</a></li><li><span class="title-icon "></span><a href="#view"><b>12.2.3. </b>View</a></li></ul><li><span class="title-icon "></span><a href="#tableviewuibutton"><b>12.3. </b>TableView&amp;UIButton</a></li><li><span class="title-icon "></span><a href="#tableviewuitextfield"><b>12.4. </b>TableView&amp;UITextField</a></li><ul><li><span class="title-icon "></span><a href="#tableviewcelluitextfield"><b>12.4.1. </b>TableViewCell&amp;UITextField</a></li></ul><li><span class="title-icon "></span><a href="#&#x793A;&#x4F8B;&#xFF1A;&#x767B;&#x5F55;"><b>12.5. </b>&#x793A;&#x4F8B;&#xFF1A;&#x767B;&#x5F55;</a></li><li><span class="title-icon "></span><a href="#&#x793A;&#x4F8B;&#xFF1A;&#x8C46;&#x74E3;&#x5217;&#x8868;"><b>12.6. </b>&#x793A;&#x4F8B;&#xFF1A;&#x8C46;&#x74E3;&#x5217;&#x8868;</a></li><li><span class="title-icon "></span><a href="#raccommand&#x4E2D;&#x7684;senderror&#x6CA1;&#x53CD;&#x5E94;&#x7684;&#x89E3;&#x7B54;"><b>12.7. </b>RACCommand&#x4E2D;&#x7684;sendError&#x6CA1;&#x53CD;&#x5E94;&#x7684;&#x89E3;&#x7B54;</a></li><li><span class="title-icon "></span><a href="#&#x793A;&#x4F8B;&#x591A;&#x63A5;&#x53E3;&#x8BF7;&#x6C42;"><b>12.8. </b>&#x793A;&#x4F8B;:&#x591A;&#x63A5;&#x53E3;&#x8BF7;&#x6C42;</a></li><li><span class="title-icon "></span><a href="#&#x793A;&#x4F8B;&#xFF1A;rac&#x3001;distinctuntilchanged"><b>12.9. </b>&#x793A;&#x4F8B;&#xFF1A;RAC&#x3001;distinctUntilChanged</a></li><li><span class="title-icon "></span><a href="#&#x793A;&#x4F8B;&#xFF1A;&#x53D1;&#x90AE;&#x4EF6;"><b>12.10. </b>&#x793A;&#x4F8B;&#xFF1A;&#x53D1;&#x90AE;&#x4EF6;</a></li></ul><li><span class="title-icon "></span><a href="#&#x8D44;&#x6599;"><b>13. </b>&#x8D44;&#x6599;</a></li></ul></div><a href="#&#x57FA;&#x7840;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><p><a href="https://gitee.com/samcoding/RACExample.git" target="_blank">&#x4EE3;&#x7801;&#x7684;&#x4ED3;&#x5E93;</a></p>
<h1 id="&#x57FA;&#x7840;"><a name="&#x57FA;&#x7840;" class="plugin-anchor" href="#&#x57FA;&#x7840;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x57FA;&#x7840;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x7840;"><i class="fa fa-link" aria-hidden="true"></i></a>1. &#x57FA;&#x7840;</h1>
<h2 id="racsignal-&#x89E6;&#x53D1;&#x6D41;&#x7A0B;"><a name="racsignal-&#x89E6;&#x53D1;&#x6D41;&#x7A0B;" class="plugin-anchor" href="#racsignal-&#x89E6;&#x53D1;&#x6D41;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="racsignal-&#x89E6;&#x53D1;&#x6D41;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#racsignal-&#x89E6;&#x53D1;&#x6D41;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. RACSignal &#x89E6;&#x53D1;&#x6D41;&#x7A0B;</h2>
<p>&#x4E0B;&#x9762;&#x4EE3;&#x7801;&#x662F;<code>RACSignal</code>&#x521B;&#x5EFA;&#x548C;&#x88AB;&#x8BA2;&#x9605;&#x7684;&#x6F14;&#x793A;&#x3002;</p>
<pre><code class="lang-objc">-(<span class="hljs-keyword">void</span>)test_sig_1{
    <span class="hljs-comment">//Create a Signal.</span>
    RACSignal *signal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">NSInteger</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">5</span>; i++) {
            [subscriber sendNext:@(i)];
        }
        [subscriber sendCompleted];
        <span class="hljs-keyword">return</span> [RACDisposable disposableWithBlock:^{
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RACDisposable block&quot;</span>);
        }];
    }];
    <span class="hljs-comment">// Subscribe a Signal</span>
    <span class="hljs-comment">// English: disposable: adj.&#x53EF;&#x4EFB;&#x610F;&#x5904;&#x7406;&#x7684;&#xFF1B;&#x53EF;&#x81EA;&#x7531;&#x4F7F;&#x7528;&#x7684;&#xFF1B;&#x7528;&#x5B8C;&#x5373;&#x53EF;&#x4E22;&#x5F03;&#x7684;</span>
    RACDisposable * disposable = [signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Recive signal:%@&quot;</span>,x);
    } error:^(<span class="hljs-built_in">NSError</span> * _Nullable error) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Recive signal:%@&quot;</span>,error.localizedDescription);
    } completed:^{
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;completed!&quot;</span>);
    }] ;

    <span class="hljs-comment">// Release the Subscriber</span>
    [disposable dispose];
}
</code></pre>
<p><code>RACSignal</code>&#x5E95;&#x5C42;&#x5B9E;&#x73B0;:</p>
<ul>
<li>&#x521B;&#x5EFA;&#x4FE1;&#x53F7;&#xFF0C;&#x9996;&#x5148;&#x628A;<code>didSubscribe</code>&#x4FDD;&#x5B58;&#x5230;&#x4FE1;&#x53F7;&#x4E2D;&#xFF0C;&#x8FD8;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#x3002;</li>
<li>&#x5F53;&#x4FE1;&#x53F7;&#x88AB;&#x8BA2;&#x9605;(&#x8C03;&#x7528;signal&#x7684;<code>subscribeNext:nextBlock</code>)&#x65F6;&#xFF1A;<ul>
<li><code>subscribeNext</code>&#x5185;&#x90E8;&#x4F1A;&#x521B;&#x5EFA;&#x8BA2;&#x9605;&#x8005;<code>subscriber</code>&#xFF0C;&#x5E76;&#x4E14;&#x628A;<code>nextBlock</code>&#x4FDD;&#x5B58;&#x5230;<code>subscriber</code>&#x4E2D;</li>
<li><code>subscribeNext</code>&#x5185;&#x90E8;&#x4F1A;&#x8C03;&#x7528;siganl&#x7684;<code>didSubscribe</code></li>
<li>&#x5F53;&#x4FE1;&#x53F7;&#x8BA2;&#x9605;&#x5B8C;&#x6210;, &#x4E0D;&#x5728;&#x53D1;&#x9001;&#x6570;&#x636E;&#x7684;&#x65F6;&#x5019;, &#x6700;&#x597D;&#x8C03;&#x7528;&#x5B8C;&#x6210;&#x53D1;&#x9001;&#x7684;<code>[subscriber sendCompleted]</code></li>
<li>&#x8BA2;&#x9605;&#x5B8C;&#x6210;&#x7684;&#x65F6;&#x5019;, &#x5185;&#x90E8;&#x4F1A;&#x81EA;&#x52A8;&#x8C03;&#x7528;<code>[RACDisposable disposable]</code>&#x53D6;&#x6D88;&#x8BA2;&#x9605;&#x4FE1;&#x53F7;</li>
</ul>
</li>
<li>&#x5F53;siganl&#x7684;<code>didSubscribe</code>&#x4E2D;&#x8C03;&#x7528;<code>[subscriber sendNext:@1]</code>&#x65F6;&#xFF0C;<code>sendNext</code>&#x5E95;&#x5C42;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x6267;&#x884C;<code>subscriber</code>&#x7684;<code>nextBlock</code></li>
</ul>
<p><code>RACSignal</code>&#x7684;&#x4E00;&#x4E9B;&#x5B50;&#x7C7B;&#x53CA;&#x4F5C;&#x7528;&#xFF1A;</p>
<pre><code class="lang-objc"><span class="hljs-comment">//  `RACDynamicSignal`(&#x52A8;&#x6001;&#x4FE1;&#x53F7;) &#x662F;`RACSignal`&#x7684;&#x5B50;&#x7C7B;,&#x4F7F;&#x7528;&#x4E00;&#x4E2A;`block`&#x6765;&#x5B9E;&#x73B0;&#x8BA2;&#x9605;&#x884C;&#x4E3A;&#x3002;</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">RACDynamicSignal</span> : <span class="hljs-title">RACSignal</span></span>
<span class="hljs-comment">// block &#x4E2D; id&lt;RACSubscriber&gt; subscriber</span>
+ (RACSignal *)createSignal:(RACDisposable * (^)(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber))didSubscribe;
<span class="hljs-keyword">@end</span>
<span class="hljs-comment">// &#x4E00;&#x5143;&#x4FE1;&#x53F7;&#xFF0C;&#x7528;&#x6765;&#x5B9E;&#x73B0; RACSignal &#x7684; +return:&#x65B9;&#x6CD5;</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">RACReturnSignal</span>&lt;<span class="hljs-title">__covariant</span> <span class="hljs-title">ValueType</span>&gt; : <span class="hljs-title">RACSignal</span>&lt;<span class="hljs-title">ValueType</span>&gt;</span>
+ (RACSignal&lt;ValueType&gt; *)<span class="hljs-keyword">return</span>:(ValueType)value;
<span class="hljs-keyword">@end</span>
<span class="hljs-comment">// &#x9519;&#x8BEF;&#x4FE1;&#x53F7;&#xFF0C;&#x7528;&#x6765;&#x5B9E;&#x73B0; RACSignal &#x7684; +error: &#x65B9;&#x6CD5;</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">RACErrorSignal</span> : <span class="hljs-title">RACSignal</span></span>
+ (RACSignal *)error:(<span class="hljs-built_in">NSError</span> *)error;
<span class="hljs-keyword">@end</span>

<span class="hljs-comment">// &#x901A;&#x9053;&#x7EC8;&#x7AEF;&#xFF0C;&#x4EE3;&#x8868; RACChannel &#x7684;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#xFF0C;&#x7528;&#x6765;&#x5B9E;&#x73B0;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">RACChannelTerminal</span>&lt;<span class="hljs-title">ValueType</span>&gt; : <span class="hljs-title">RACSignal</span>&lt;<span class="hljs-title">ValueType</span>&gt; &lt;<span class="hljs-title">RACSubscriber</span>&gt;</span>
- (instancetype)init __attribute__((unavailable(<span class="hljs-string">&quot;Instantiate a RACChannel instead&quot;</span>)));
- (<span class="hljs-keyword">void</span>)sendNext:(nullable ValueType)value;
<span class="hljs-keyword">@end</span>

<span class="hljs-comment">// &#x4FE1;&#x53F7;&#x63D0;&#x4F9B;&#x8005;&#xFF0C;&#x81EA;&#x5DF1;&#x53EF;&#x4EE5;&#x5145;&#x5F53;&#x4FE1;&#x53F7;&#xFF0C;&#x53C8;&#x80FD;&#x53D1;&#x9001;&#x4FE1;&#x53F7;</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">RACSubject</span>&lt;<span class="hljs-title">ValueType</span>&gt; : <span class="hljs-title">RACSignal</span>&lt;<span class="hljs-title">ValueType</span>&gt; &lt;<span class="hljs-title">RACSubscriber</span>&gt;</span>
+ (instancetype)subject;
- (<span class="hljs-keyword">void</span>)sendNext:(nullable ValueType)value;
<span class="hljs-keyword">@end</span>
</code></pre>
<p><code>RACSubscriber</code> &#x8BA2;&#x9605;&#x8005;&#x534F;&#x8BAE;&#x7684;&#x5185;&#x5BB9;&#xFF1A;</p>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@protocol</span> <span class="hljs-title">RACSubscriber</span> &lt;<span class="hljs-title">NSObject</span>&gt;</span>
- (<span class="hljs-keyword">void</span>)sendNext:(nullable <span class="hljs-keyword">id</span>)value;
- (<span class="hljs-keyword">void</span>)sendError:(nullable <span class="hljs-built_in">NSError</span> *)error;
- (<span class="hljs-keyword">void</span>)sendCompleted;
- (<span class="hljs-keyword">void</span>)didSubscribeWithDisposable:(RACCompoundDisposable *)disposable;
<span class="hljs-keyword">@end</span>
</code></pre>
<h2 id="racsubject&#x3001;racreplaysubject"><a name="racsubject&#x3001;racreplaysubject" class="plugin-anchor" href="#racsubject&#x3001;racreplaysubject"><i class="fa fa-link" aria-hidden="true"></i></a><a name="racsubject&#x3001;racreplaysubject" class="anchor-navigation-ex-anchor" href="#racsubject&#x3001;racreplaysubject"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. RACSubject&#x3001;RACReplaySubject</h2>
<p><code>RACSubject</code> &#x4FE1;&#x53F7;&#x63D0;&#x4F9B;&#x8005;&#xFF1A;</p>
<ul>
<li><code>RACSubject(&#x4FE1;&#x53F7;&#x63D0;&#x4F9B;&#x8005;)</code>&#xFF0C;&#x81EA;&#x5DF1;&#x53EF;&#x4EE5;&#x5145;&#x5F53;&#x4FE1;&#x53F7;&#xFF0C;&#x53C8;&#x80FD;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;</li>
<li>&#x89E6;&#x53D1;&#x6761;&#x4EF6;&#xFF1A;&#x5148;&#x8BA2;&#x9605;, &#x518D;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;</li>
<li>&#x4F7F;&#x7528;&#x573A;&#x666F;:&#x901A;&#x5E38;&#x7528;&#x6765;&#x4EE3;&#x66FF;&#x4EE3;&#x7406;/&#x901A;&#x77E5;&#x3002;</li>
</ul>
<p><code>RACReplaySubject</code> &#x91CD;&#x590D;&#x63D0;&#x4F9B;&#x4FE1;&#x53F7;&#xFF1A;</p>
<ul>
<li>&#x5148;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF0C;&#x518D;&#x8BA2;&#x9605;&#x4FE1;&#x53F7;</li>
</ul>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">TestViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) RACSignal *signal;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) RACReplaySubject *replaySubject;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) RACSubject *subject;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">TestViewModel</span></span>
-(RACReplaySubject *)replaySubject{
    <span class="hljs-keyword">if</span> (!_replaySubject) {
        _replaySubject = [RACReplaySubject subject];
    }
    <span class="hljs-keyword">return</span> _replaySubject;
}

-(RACSubject *)subject{
    <span class="hljs-keyword">if</span> (!_subject) {
        _subject = [RACSubject subject];
    }
    <span class="hljs-keyword">return</span> _subject;
}
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">TestViewController</span> ()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *registerButton;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *loginButton;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UILabel</span> *textLabel;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITextField</span> *textField;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *sendSingnalButton;

<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) TestViewModel *viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">TestViewController</span></span>


- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    [[<span class="hljs-keyword">self</span>.loginButton rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;you clicked the login button!&quot;</span>);
        [<span class="hljs-keyword">self</span>.viewModel.replaySubject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RACReplaySubject %@&quot;</span>,x);
        }];
        [<span class="hljs-keyword">self</span>.viewModel.subject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RACSubject %@&quot;</span>,x);
        }];
    }];
    [[<span class="hljs-keyword">self</span>.registerButton rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;you clicked the register button!&quot;</span>);
        [<span class="hljs-keyword">self</span>.viewModel.replaySubject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RACReplaySubject %@&quot;</span>,x);
        }];
        [<span class="hljs-keyword">self</span>.viewModel.subject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RACSubject %@&quot;</span>,x);
        }];
    }];
    [[<span class="hljs-keyword">self</span>.sendSingnalButton rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
        [<span class="hljs-keyword">self</span>.viewModel.subject sendNext:@<span class="hljs-number">2</span>];
        [<span class="hljs-keyword">self</span>.viewModel.replaySubject sendNext:@<span class="hljs-number">2</span>];
    }];
}
-(TestViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [TestViewModel new];
        [_viewModel.replaySubject sendNext:@<span class="hljs-number">1</span>];
        [_viewModel.subject sendNext:@<span class="hljs-number">1</span>];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-keyword">@end</span>

<span class="hljs-comment">/*
you clicked the login button!
RACReplaySubject 1 ==&gt; RACReplaySubject &#x5148;&#x53D1;&#x9001;&#x4E86;&#x4FE1;&#x53F7;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x70B9;&#x51FB;login&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x8BA2;&#x9605;&#x3002;&#x8FD9;&#x91CC;&#x6CA1;&#x6709; RACSubject &#x7684;&#x6253;&#x5370;&#x4FE1;&#x606F;&#xFF0C;&#x662F;&#x56E0;&#x4E3A; RACSubject &#x5FC5;&#x987B;&#x5148;&#x8BA2;&#x9605;&#x518D;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;

you clicked the register button!
RACReplaySubject 1 ==&gt; RACReplaySubject &#x5148;&#x53D1;&#x9001;&#x4E86;&#x4FE1;&#x53F7;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x70B9;&#x51FB;login&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x8BA2;&#x9605;&#x3002;&#x8FD9;&#x91CC;&#x6CA1;&#x6709; RACSubject &#x7684;&#x6253;&#x5370;&#x4FE1;&#x606F;&#xFF0C;&#x662F;&#x56E0;&#x4E3A; RACSubject &#x5FC5;&#x987B;&#x5148;&#x8BA2;&#x9605;&#x518D;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;

RACSubject 2
RACSubject 2 ==&gt; login register &#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x5404;&#x8BA2;&#x9605;&#x4E86;&#x4E00;&#x6B21;&#x4FE1;&#x53F7;&#xFF0C;&#x70B9;&#x51FB;&#x51E0;&#x6B21;&#x65B9;&#x6CD5;&#x5C31;&#x4F1A;&#x91CD;&#x590D;&#x8BA2;&#x9605;
RACReplaySubject 2 ==&gt; login register &#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x5404;&#x8BA2;&#x9605;&#x4E86;&#x4E00;&#x6B21;&#x4FE1;&#x53F7;&#xFF0C;&#x70B9;&#x51FB;&#x51E0;&#x6B21;&#x65B9;&#x6CD5;&#x5C31;&#x4F1A;&#x91CD;&#x590D;&#x8BA2;&#x9605;
RACReplaySubject 2

RACSubject 2
RACSubject 2
RACReplaySubject 2
RACReplaySubject 2
*/</span>
</code></pre>
<p><img src="../assets/images/iOS/rac/02.gif"></p>
<p>&#x505A;&#x4E00;&#x4E2A;<code>RACSubject</code>&#x4F5C;&#x4E3A;&#x4EE3;&#x7406;&#x7684;&#x7B80;&#x5355;&#x793A;&#x4F8B;&#xFF1A;</p>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">TestViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) RACSubject *subject;

-(<span class="hljs-keyword">void</span>)loadData;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">TestViewModel</span></span>
-(<span class="hljs-keyword">void</span>)loadData{
    <span class="hljs-comment">// request service data,return data to vc</span>
    [<span class="hljs-keyword">self</span>.subject sendNext:@<span class="hljs-number">1</span>];
}

-(RACSubject *)subject{
    <span class="hljs-keyword">if</span> (!_subject) {
        _subject = [RACSubject subject];
    }
    <span class="hljs-keyword">return</span> _subject;
}
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">TestViewController</span> ()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *registerButton;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *loginButton;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UILabel</span> *textLabel;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITextField</span> *textField;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *sendSingnalButton;

<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) TestViewModel *viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">TestViewController</span></span>


- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    [<span class="hljs-keyword">self</span>.viewModel.subject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Service data: %@&quot;</span>,x);
    }];
    @weakify(<span class="hljs-keyword">self</span>)
    [[<span class="hljs-keyword">self</span>.loginButton rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
        @strongify(<span class="hljs-keyword">self</span>)
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;you clicked the login button!&quot;</span>);
        [<span class="hljs-keyword">self</span>.viewModel loadData];
    }];
}
-(TestViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [TestViewModel new];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-keyword">@end</span>
</code></pre>
<p><img src="../assets/images/iOS/rac/03.gif"></p>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="&#x51B7;&#x4FE1;&#x53F7;&#x4E0E;&#x70ED;&#x4FE1;&#x53F7;"><a name="&#x51B7;&#x4FE1;&#x53F7;&#x4E0E;&#x70ED;&#x4FE1;&#x53F7;" class="plugin-anchor" href="#&#x51B7;&#x4FE1;&#x53F7;&#x4E0E;&#x70ED;&#x4FE1;&#x53F7;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x51B7;&#x4FE1;&#x53F7;&#x4E0E;&#x70ED;&#x4FE1;&#x53F7;" class="anchor-navigation-ex-anchor" href="#&#x51B7;&#x4FE1;&#x53F7;&#x4E0E;&#x70ED;&#x4FE1;&#x53F7;"><i class="fa fa-link" aria-hidden="true"></i></a>2. &#x51B7;&#x4FE1;&#x53F7;&#x4E0E;&#x70ED;&#x4FE1;&#x53F7;</h1>
<h2 id="&#x70ED;&#x4FE1;&#x53F7;"><a name="&#x70ED;&#x4FE1;&#x53F7;" class="plugin-anchor" href="#&#x70ED;&#x4FE1;&#x53F7;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x70ED;&#x4FE1;&#x53F7;" class="anchor-navigation-ex-anchor" href="#&#x70ED;&#x4FE1;&#x53F7;"><i class="fa fa-link" aria-hidden="true"></i></a>2.1. &#x70ED;&#x4FE1;&#x53F7;</h2>
<ul>
<li><strong>&#x70ED;&#x4FE1;&#x53F7;&#x662F;&#x4E3B;&#x52A8;&#x7684;&#xFF0C;&#x5373;&#x4F7F;&#x4F60;&#x6CA1;&#x6709;&#x8BA2;&#x9605;&#x4E8B;&#x4EF6;&#xFF0C;&#x5B83;&#x4ECD;&#x7136;&#x4F1A;&#x65F6;&#x523B;&#x63A8;&#x9001;&#x3002;</strong> &#x4F8B;&#x4E2D;&#xFF1A;&#x4FE1;&#x53F7;&#x5728; 19:37:55 &#x88AB;&#x521B;&#x5EFA;&#xFF0C;&#x5728; 19:37:56 &#x53D1;&#x51FA;&#x4FE1;&#x53F7;1&#xFF0C;&#x4F46;&#x662F;&#x6CA1;&#x6709;&#x8BA2;&#x9605;&#xFF0C;&#x5728; 19:37:57&#x53D1;&#x51FA;&#x4FE1;&#x53F7;2&#xFF0C;&#x8FD9;&#x662F;&#x6709;&#x4E00;&#x4E2A;&#x8BA2;&#x9605;&#x3002;</li>
<li><strong>&#x70ED;&#x4FE1;&#x53F7;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x4E2A;&#x8BA2;&#x9605;&#x8005;&#xFF0C;&#x662F;&#x4E00;&#x5BF9;&#x591A;&#xFF0C;&#x4FE1;&#x53F7;&#x53EF;&#x4EE5;&#x4E0E;&#x8BA2;&#x9605;&#x8005;&#x5171;&#x4EAB;&#x4FE1;&#x606F;&#x3002;</strong> &#x4F8B;&#x4E2D;&#xFF1A;&#x8BA2;&#x9605;&#x8005;1&#x548C;&#x8BA2;&#x9605;&#x8005;2&#x90FD;&#x5728; 19:37:58 &#x6536;&#x5230;&#x4E86;&#x6570;&#x636E;&#x3002;</li>
</ul>
<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];

    RACMulticastConnection * connection = [[RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1</span> schedule:^{
            [subscriber sendNext:@<span class="hljs-number">1</span>];
        }];
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">2</span> schedule:^{
            [subscriber sendNext:@<span class="hljs-number">2</span>];
        }];
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">3</span> schedule:^{
            [subscriber sendNext:@<span class="hljs-number">3</span>];
        }];
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">4</span> schedule:^{
            [subscriber sendCompleted];
        }];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }]publish];
    [connection connect];
    RACSignal *signal = connection.signal;
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Signal was created.&quot;</span>);

    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1</span> schedule:^{
        [signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 1 recveive: %@&quot;</span>, x);
        }];
    }];
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">2.1</span> schedule:^{
        [signal subscribeNext:^(<span class="hljs-keyword">id</span> x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 2 recveive: %@&quot;</span>, x);
        }];
    }];
}
<span class="hljs-comment">/*
2020-05-28 19:37:55.689906+0800 RACExample[56065:11840136] Signal was created. 
2020-05-28 19:37:57.690140+0800 RACExample[56065:11840136] Subscriber 1 recveive: 2
2020-05-28 19:37:58.690022+0800 RACExample[56065:11840136] Subscriber 1 recveive: 3
2020-05-28 19:37:58.690210+0800 RACExample[56065:11840136] Subscriber 2 recveive: 3
*/</span>
</code></pre>
<h2 id="&#x51B7;&#x4FE1;&#x53F7;"><a name="&#x51B7;&#x4FE1;&#x53F7;" class="plugin-anchor" href="#&#x51B7;&#x4FE1;&#x53F7;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x51B7;&#x4FE1;&#x53F7;" class="anchor-navigation-ex-anchor" href="#&#x51B7;&#x4FE1;&#x53F7;"><i class="fa fa-link" aria-hidden="true"></i></a>2.2. &#x51B7;&#x4FE1;&#x53F7;</h2>
<ul>
<li><strong>&#x51B7;&#x4FE1;&#x53F7;&#x662F;&#x88AB;&#x52A8;&#x7684;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x4F60;&#x8BA2;&#x9605;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B83;&#x624D;&#x4F1A;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x3002;</strong></li>
<li><strong>&#x51B7;&#x4FE1;&#x53F7;&#x53EA;&#x80FD;&#x4E00;&#x5BF9;&#x4E00;&#xFF0C;&#x5F53;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x8BA2;&#x9605;&#x8005;&#xFF0C;&#x6D88;&#x606F;&#x4F1A;&#x4ECE;&#x65B0;&#x5B8C;&#x6574;&#x53D1;&#x9001;&#x3002;</strong> &#x4F8B;&#x4E2D;&#xFF1A;&#x4E24;&#x4E2A;&#x8BA2;&#x9605;&#x8005;&#x6CA1;&#x6709;&#x8054;&#x7CFB;&#xFF0C;&#x90FD;&#x662F;&#x57FA;&#x4E8E;&#x5404;&#x81EA;&#x7684;&#x8BA2;&#x9605;&#x65F6;&#x95F4;&#x5F00;&#x59CB;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x7684;&#x3002;</li>
</ul>
<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];

    RACSignal *signal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1</span> schedule:^{
            [subscriber sendNext:@<span class="hljs-number">1</span>];
        }];
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">2</span> schedule:^{
            [subscriber sendNext:@<span class="hljs-number">2</span>];
        }];
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">3</span> schedule:^{
            [subscriber sendNext:@<span class="hljs-number">3</span>];
        }];
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">4</span> schedule:^{
            [subscriber sendCompleted];
        }];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Signal was created.&quot;</span>);

    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1</span> schedule:^{
        [signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 1 recveive: %@&quot;</span>, x);
        }];
    }];
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">2.1</span> schedule:^{
        [signal subscribeNext:^(<span class="hljs-keyword">id</span> x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 2 recveive: %@&quot;</span>, x);
        }];
    }];
}
<span class="hljs-comment">/*
2020-05-28 19:42:38.439542+0800 RACExample[56245:11843585] Signal was created.
2020-05-28 19:42:40.540420+0800 RACExample[56245:11843585] Subscriber 1 recveive: 1
2020-05-28 19:42:41.537044+0800 RACExample[56245:11843585] Subscriber 1 recveive: 2
2020-05-28 19:42:41.849789+0800 RACExample[56245:11843585] Subscriber 2 recveive: 1
2020-05-28 19:42:42.669102+0800 RACExample[56245:11843585] Subscriber 1 recveive: 3
2020-05-28 19:42:42.884800+0800 RACExample[56245:11843585] Subscriber 2 recveive: 2
2020-05-28 19:42:43.841321+0800 RACExample[56245:11843585] Subscriber 2 recveive: 3
*/</span>
</code></pre>
<h2 id="&#x51B7;&#x4FE1;&#x53F7;&#x3001;&#x70ED;&#x4FE1;&#x53F7;&#x6BD4;&#x8F83;"><a name="&#x51B7;&#x4FE1;&#x53F7;&#x3001;&#x70ED;&#x4FE1;&#x53F7;&#x6BD4;&#x8F83;" class="plugin-anchor" href="#&#x51B7;&#x4FE1;&#x53F7;&#x3001;&#x70ED;&#x4FE1;&#x53F7;&#x6BD4;&#x8F83;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x51B7;&#x4FE1;&#x53F7;&#x3001;&#x70ED;&#x4FE1;&#x53F7;&#x6BD4;&#x8F83;" class="anchor-navigation-ex-anchor" href="#&#x51B7;&#x4FE1;&#x53F7;&#x3001;&#x70ED;&#x4FE1;&#x53F7;&#x6BD4;&#x8F83;"><i class="fa fa-link" aria-hidden="true"></i></a>2.3. &#x51B7;&#x4FE1;&#x53F7;&#x3001;&#x70ED;&#x4FE1;&#x53F7;&#x6BD4;&#x8F83;</h2>
<pre><code class="lang-objc"><span class="hljs-comment">// &#x51B7;&#x4FE1;&#x53F7;&#x4EE3;&#x7801;</span>
-(<span class="hljs-keyword">void</span>)test_Signal{
    <span class="hljs-comment">// Create an RACReplaySubject signals</span>
    RACSignal *signal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-comment">// Send Signals</span>
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1</span> schedule:^{
            [subscriber sendNext:<span class="hljs-string">@&quot;replaySubject send package 1&quot;</span>];
        }];
        <span class="hljs-comment">// Send Signals</span>
        [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">2</span> schedule:^{
            [subscriber sendNext:<span class="hljs-string">@&quot;replaySubject send package 2&quot;</span>];
        }];
        <span class="hljs-keyword">return</span> [RACDisposable disposableWithBlock:^{
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;disposable&quot;</span>);
        }];
    }];
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;create Signal&quot;</span>);

    <span class="hljs-comment">// Subscribe the signal</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">0.1</span> schedule:^{
        <span class="hljs-comment">//Subscriber1</span>
        [signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 1 get a next value: %@ from replay subject&quot;</span>, x);
        }];

        <span class="hljs-comment">//Subscriber2</span>
        [signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 2 get a next value: %@ from replay subject&quot;</span>, x);
        }];
    }];

    <span class="hljs-comment">// Subscribe the signal</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1.1</span> schedule:^{
        <span class="hljs-comment">//Subscriber3</span>
        [signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 3 get a next value: %@ from replay subject&quot;</span>, x);
        }];

        <span class="hljs-comment">//Subscriber4</span>
        [signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 4 get a next value: %@ from replay subject&quot;</span>, x);
        }];
    }];
}
<span class="hljs-comment">// Subject &#x70ED;&#x4FE1;&#x53F7;&#x4EE3;&#x7801;</span>
-(<span class="hljs-keyword">void</span>)test_RACSubject{
    <span class="hljs-comment">// Create a RACSubject signal</span>
    RACSubject *subject = [RACSubject subject];
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;create Signal&quot;</span>);

    <span class="hljs-comment">// Subscribe the signal</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">0.1</span> schedule:^{
        <span class="hljs-comment">//Subscriber1</span>
        [subject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 1 get a next value: %@ from subject&quot;</span>, x);
        }];
        <span class="hljs-comment">//Subscriber2</span>
        [subject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 2 get a next value: %@ from subject&quot;</span>, x);
        }];
    }];

    <span class="hljs-comment">// Send Signals</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1</span> schedule:^{
        [subject sendNext:<span class="hljs-string">@&quot;subject send package 1&quot;</span>];
    }];

    <span class="hljs-comment">// Subscribe the signal</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1.1</span> schedule:^{
        <span class="hljs-comment">//Subscriber3</span>
        [subject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 3 get a next value: %@ from subject&quot;</span>, x);
        }];

        <span class="hljs-comment">//Subscriber4</span>
        [subject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 4 get a next value: %@ from subject&quot;</span>, x);
        }];

    }];

    <span class="hljs-comment">// Send Signals</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">2</span> schedule:^{
        [subject sendNext:<span class="hljs-string">@&quot;subject send package 2&quot;</span>];
    }];
}
<span class="hljs-comment">// ReplaySubject &#x70ED;&#x4FE1;&#x53F7;&#x4EE3;&#x7801;</span>
-(<span class="hljs-keyword">void</span>)test_RACReplaySubject{
    <span class="hljs-comment">// Create an RACReplaySubject signals</span>
    RACSubject *replaySubject = [RACReplaySubject subject];
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;create Signal&quot;</span>);

    <span class="hljs-comment">// Subscribe the signal</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">0.1</span> schedule:^{
        <span class="hljs-comment">//Subscriber1</span>
        [replaySubject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 1 get a next value: %@ from replay subject&quot;</span>, x);
        }];

        <span class="hljs-comment">//Subscriber2</span>
        [replaySubject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 2 get a next value: %@ from replay subject&quot;</span>, x);
        }];
    }];

    <span class="hljs-comment">// Send Signals</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1</span> schedule:^{
        [replaySubject sendNext:<span class="hljs-string">@&quot;replaySubject send package 1&quot;</span>];
    }];

    <span class="hljs-comment">// Subscribe the signal</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">1.1</span> schedule:^{
        <span class="hljs-comment">//Subscriber3</span>
        [replaySubject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 3 get a next value: %@ from replay subject&quot;</span>, x);
        }];

        <span class="hljs-comment">//Subscriber4</span>
        [replaySubject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Subscriber 4 get a next value: %@ from replay subject&quot;</span>, x);
        }];
    }];

    <span class="hljs-comment">// Send Signals</span>
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">2</span> schedule:^{
        [replaySubject sendNext:<span class="hljs-string">@&quot;replaySubject send package 2&quot;</span>];
    }];
}
</code></pre>
<p><code>RACSignal</code>&#x548C;&#x70ED;&#x4FE1;&#x53F7;<code>RACSubject</code>&#x65F6;&#x95F4;&#x6BD4;&#x8F83;&#xFF1A;</p>
<ul>
<li><code>RACSubject</code>&#x4E2D;&#xFF0C;4&#x4E2A;&#x8BA2;&#x9605;&#x8005;&#x5171;&#x4EAB;<code>subject</code>,&#x5728;<code>subject</code>&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x8BA2;&#x9605;&#x8005;&#x90FD;&#x80FD;&#x6536;&#x5230;&#x4FE1;&#x53F7;&#x6570;&#x636E;&#xFF1B;&#x56E0;&#x4E3A;<code>subscriber3</code>&#x3001;<code>subscriber4</code>&#x8BA2;&#x9605;&#x7684;&#x65F6;&#x95F4;&#x7A0D;&#x540E;&#xFF0C;&#x9519;&#x8FC7;&#x4E86;<code>subject</code>&#x53D1;&#x9001;&#x7684;&#x4FE1;&#x53F7;&#x6570;&#x636E;&#x3002;</li>
<li>&#x5BF9;&#x6BD4;&#x53D1;&#x73B0;: <code>subject</code>&#x7C7B;&#x4F3C;<mark>&#x76F4;&#x64AD;&#xFF0C;&#x9519;&#x8FC7;&#x4E86;&#x5C31;&#x4E0D;&#x518D;&#x5904;&#x7406;</mark>&#x3002;&#x800C;<code>signal</code>&#x7C7B;&#x4F3C;<mark>&#x70B9;&#x64AD;&#xFF0C;&#x6BCF;&#x6B21;&#x8BA2;&#x9605;&#x90FD;&#x4F1A;&#x4ECE;&#x5934;&#x5F00;&#x59CB;</mark>&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x6709;&#x7406;&#x7531;&#x8BA4;&#x5B9A;<code>subject</code>&#x5929;&#x7136;&#x5C31;&#x662F;&#x70ED;&#x4FE1;&#x53F7;&#x3002;</li>
</ul>
<p><img src="../assets/images/iOS/rac/07.png"></p>
<p>&#x51B7;&#x4FE1;&#x53F7;<code>RACSignal</code>&#x548C;&#x70ED;&#x4FE1;&#x53F7;<code>ReplayRACSubject</code>&#x65F6;&#x95F4;&#x6BD4;&#x8F83;&#xFF1A;</p>
<p><img src="../assets/images/iOS/rac/08.png"></p>
<p>&#x70ED;&#x4FE1;&#x53F7;<code>RACSubject</code>&#x548C;&#x70ED;&#x4FE1;&#x53F7;<code>ReplayRACSubject</code>&#x65F6;&#x95F4;&#x6BD4;&#x8F83;&#xFF1A;</p>
<ul>
<li><code>ReplayRACSubject</code>&#x4E2D;&#xFF0C;<code>Subscriber 3</code>&#x4E0E;<code>Subscriber 4</code>&#x5728;&#x8BA2;&#x9605;&#x540E;&#x9A6C;&#x4E0A;&#x63A5;&#x6536;&#x5230;&#x4E86;&#x201C;&#x5386;&#x53F2;&#x503C;&#x201D;&#x3002;&#x5BF9;&#x4E8E;<code>Subscriber 3</code>&#x548C;<code>Subscriber 4</code>&#x6765;&#x8BF4;&#xFF0C;&#x5B83;&#x4EEC;&#x53EA;&#x5173;&#x5FC3;&#x201C;&#x5386;&#x53F2;&#x7684;&#x503C;&#x201D;&#x800C;&#x4E0D;&#x5173;&#x5FC3;&#x201C;&#x5386;&#x53F2;&#x7684;&#x65F6;&#x95F4;&#x7EBF;&#x201D;&#x3002;&#xB7;</li>
</ul>
<p><img src="../assets/images/iOS/rac/09.png"></p>
<p>&#x70ED;&#x4FE1;&#x53F7;&#x548C;&#x51B7;&#x4FE1;&#x53F7;&#x7C7B;&#xFF1A;</p>
<p><img src="../assets/images/iOS/rac/10.png"></p>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="&#x57FA;&#x7840;&#x4F7F;&#x7528;"><a name="&#x57FA;&#x7840;&#x4F7F;&#x7528;" class="plugin-anchor" href="#&#x57FA;&#x7840;&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x57FA;&#x7840;&#x4F7F;&#x7528;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x7840;&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>3. &#x57FA;&#x7840;&#x4F7F;&#x7528;</h1>
<h2 id="racmulticastconnection"><a name="racmulticastconnection" class="plugin-anchor" href="#racmulticastconnection"><i class="fa fa-link" aria-hidden="true"></i></a><a name="racmulticastconnection" class="anchor-navigation-ex-anchor" href="#racmulticastconnection"><i class="fa fa-link" aria-hidden="true"></i></a>3.1. RACMulticastConnection</h2>
<pre><code class="lang-objc">RACSignal *signal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x4FE1;&#x53F7;1&quot;</span>);
    [subscriber sendNext:<span class="hljs-string">@&quot;1&quot;</span>];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}];
[signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) { <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x7B2C;&#x4E00;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;%@&quot;</span>,x);}];
[signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) { <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x7B2C;&#x4E8C;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;%@&quot;</span>,x);}];
<span class="hljs-comment">/*
2020-06-08 16:20:16.479977+0800 RACExample[46980:352112] &#x53D1;&#x9001;&#x4FE1;&#x53F7;1
2020-06-08 16:20:16.480517+0800 RACExample[46980:352112] &#x7B2C;&#x4E00;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;1
2020-06-08 16:20:16.480976+0800 RACExample[46980:352112] &#x53D1;&#x9001;&#x4FE1;&#x53F7;1
2020-06-08 16:20:16.481336+0800 RACExample[46980:352112] &#x7B2C;&#x4E8C;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;1
*/</span>
</code></pre>
<p>&#x5728;&#x4FE1;&#x53F7;<code>signal</code>&#x88AB;&#x8BA2;&#x9605;2&#x6B21;&#x4EE5;&#x540E;&#xFF0C;<code>createSignal:</code>block&#x4E5F;&#x88AB;&#x89E6;&#x53D1;&#x4E86;2&#x6B21;&#x3002;&#x901A;&#x8FC7;<code>RACMulticastConnection</code>&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x4FE1;&#x53F7;&#x88AB;n&#x6B21;&#x8BA2;&#x9605;&#x540E;&#xFF0C;block&#x4E5F;&#x4F1A;&#x88AB;&#x89E6;&#x53D1;n&#x6B21;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<pre><code class="lang-objc">RACSignal *signal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x4FE1;&#x53F7;1&quot;</span>);
    [subscriber sendNext:<span class="hljs-string">@&quot;1&quot;</span>];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}];
RACMulticastConnection *signalBconnect = [signal publish];
[signalBconnect.signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) { <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x7B2C;&#x4E00;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;%@&quot;</span>,x);}];
[signalBconnect.signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) { <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x7B2C;&#x4E8C;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;%@&quot;</span>,x);}];
[signalBconnect connect];
<span class="hljs-comment">/*
2020-06-08 16:25:18.009553+0800 RACExample[47186:354797] &#x53D1;&#x9001;&#x4FE1;&#x53F7;1
2020-06-08 16:25:18.009805+0800 RACExample[47186:354797] &#x7B2C;&#x4E00;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;1
2020-06-08 16:25:18.009907+0800 RACExample[47186:354797] &#x7B2C;&#x4E8C;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;1
*/</span>
</code></pre>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>RACSignal</code>&#x70ED;&#x4FE1;&#x53F7;&#x53BB;&#x89E3;&#x51B3;&#xFF0C;&#x5176;&#x5B9E;<code>RACMulticastConnection</code>&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x628A;<code>signal</code>&#x53D8;&#x6210;&#x4E86;&#x70ED;&#x4FE1;&#x53F7;&#xFF1A;</p>
<pre><code class="lang-objc">RACSubject *subject = [RACSubject subject];
[subject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) { <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x7B2C;&#x4E00;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;%@&quot;</span>,x);}];
[subject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) { <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x7B2C;&#x4E8C;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;%@&quot;</span>,x);}];
<span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x4FE1;&#x53F7;1&quot;</span>);
[subject sendNext:<span class="hljs-string">@&quot;1&quot;</span>];
<span class="hljs-comment">/*
2020-06-08 16:26:34.201680+0800 RACExample[47240:355739] &#x53D1;&#x9001;&#x4FE1;&#x53F7;1
2020-06-08 16:26:34.202059+0800 RACExample[47240:355739] &#x7B2C;&#x4E00;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;1
2020-06-08 16:26:34.202349+0800 RACExample[47240:355739] &#x7B2C;&#x4E8C;&#x6B21;&#x8BA2;&#x9605;&#xFF1A;1
*/</span>
</code></pre>
<h2 id="&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;"><a name="&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;" class="plugin-anchor" href="#&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;" class="anchor-navigation-ex-anchor" href="#&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;"><i class="fa fa-link" aria-hidden="true"></i></a>3.2. &#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;</h2>
<ul>
<li>&#x526F;&#x4F5C;&#x7528;&#xFF1A;&#x5173;&#x4E8E;&#x4FE1;&#x53F7;&#x4E0E;&#x7EBF;&#x7A0B;,&#x6211;&#x4EEC;&#x628A;&#x5728;&#x521B;&#x5EFA;&#x4FE1;&#x53F7;&#x65F6;block&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x79F0;&#x4E4B;&#x4E3A;&#x526F;&#x4F5C;&#x7528;&#x3002;</li>
<li><code>deliverON</code>&#xFF1A;&#x5207;&#x6362;&#x5230;&#x6307;&#x5B9A;&#x7EBF;&#x7A0B;&#x4E2D;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x56DE;&#x5230;&#x4E3B;&#x7EBF;&#x4E2D;&#x5237;&#x65B0;UI,&#x5185;&#x5BB9;&#x4F20;&#x9012;&#x5207;&#x6362;&#x5230;&#x6307;&#x5B9A;&#x7EBF;&#x7A0B;&#x4E2D;&#xFF0C;</li>
<li><code>subscribeOn</code>&#xFF1A;&#x5185;&#x5BB9;&#x4F20;&#x9012;&#x548C;&#x526F;&#x4F5C;&#x7528;&#x90FD;&#x4F1A;&#x5207;&#x6362;&#x5230;&#x6307;&#x5B9A;&#x7EBF;&#x7A0B;&#x4E2D;&#x3002;</li>
<li><code>deliverOnMainThread</code>&#xFF1A;&#x80FD;&#x4FDD;&#x8BC1;&#x539F;&#x4FE1;&#x53F7;<code>subscribeNext</code>&#xFF0C;<code>sendError</code>&#xFF0C;<code>sendCompleted</code>&#x90FD;&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;<code>MainThread</code>&#x4E2D;&#x6267;&#x884C;&#x3002;</li>
</ul>
<pre><code class="lang-objc"><span class="hljs-built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="hljs-number">0</span>), ^{
    [[RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;sendNext1:%@&quot;</span>,[<span class="hljs-built_in">NSThread</span> currentThread]);<span class="hljs-comment">// sendNext1:&lt;NSThread: 0x600001f36300&gt;{number = 4, name = (null)}</span>
        [subscriber sendNext:<span class="hljs-string">@&quot;1&quot;</span>];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext%@:%@&quot;</span>,x,[<span class="hljs-built_in">NSThread</span> currentThread]);<span class="hljs-comment">//subscribeNext1:&lt;NSThread: 0x600001f36300&gt;{number = 4, name = (null)}</span>
    }];
});
<span class="hljs-comment">// &#x53D1;&#x9001;&#x6D88;&#x606F;&#x3001;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x90FD;&#x662F;&#x5728;&#x5F02;&#x6B65;&#x7EBF;&#x7A0B;&#x3002;</span>

<span class="hljs-built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="hljs-number">0</span>), ^{
    [[[RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;sendNext1:%@&quot;</span>,[<span class="hljs-built_in">NSThread</span> currentThread]);<span class="hljs-comment">// sendNext1:&lt;NSThread: 0x600003e40040&gt;{number = 4, name = (null)}</span>
        [subscriber sendNext:<span class="hljs-string">@&quot;1&quot;</span>];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }] deliverOn:[RACScheduler mainThreadScheduler]] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext%@:%@&quot;</span>,x,[<span class="hljs-built_in">NSThread</span> currentThread]);<span class="hljs-comment">//subscribeNext1:&lt;NSThread: 0x600003e04980&gt;{number = 1, name = main}</span>
    }];
});
<span class="hljs-comment">// &#x63A5;&#x6536;&#x6D88;&#x606F;&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;&#x3002;</span>

<span class="hljs-built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="hljs-number">0</span>), ^{
    [[[RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;sendNext1:%@&quot;</span>,[<span class="hljs-built_in">NSThread</span> currentThread]);<span class="hljs-comment">// sendNext1:&lt;NSThread: 0x6000035fcbc0&gt;{number = 1, name = main}</span>
        [subscriber sendNext:<span class="hljs-string">@&quot;1&quot;</span>];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }] subscribeOn:[RACScheduler mainThreadScheduler]] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext%@:%@&quot;</span>,x,[<span class="hljs-built_in">NSThread</span> currentThread]);<span class="hljs-comment">//subscribeNext1:&lt;NSThread: 0x6000035fcbc0&gt;{number = 1, name = main}</span>
    }];
});
<span class="hljs-comment">// &#x53D1;&#x9001;&#x6D88;&#x606F;&#x3001;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x90FD;&#x662F;&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;&#x3002;</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x8282;&#x6D41;throttle"><a name="&#x4FE1;&#x53F7;&#x8282;&#x6D41;throttle" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x8282;&#x6D41;throttle"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x8282;&#x6D41;throttle" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x8282;&#x6D41;throttle"><i class="fa fa-link" aria-hidden="true"></i></a>3.3. &#x4FE1;&#x53F7;&#x8282;&#x6D41;:throttle</h2>
<ul>
<li><code>throttle&#x8282;&#x6D41;</code>:&#x5F53;&#x67D0;&#x4E2A;&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x6BD4;&#x8F83;&#x9891;&#x7E41;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8282;&#x6D41;&#xFF0C;&#x5728;&#x67D0;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x4E0D;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x5185;&#x5BB9;&#xFF0C;&#x8FC7;&#x4E86;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x7684;&#x6700;&#x65B0;&#x5185;&#x5BB9;&#x53D1;&#x51FA;&#x3002;</li>
</ul>
<pre><code class="lang-objc">[[[RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;11&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;11&quot;</span>];
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="hljs-number">2</span> * <span class="hljs-built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^{
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;21&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;21&quot;</span>];
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;22&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;22&quot;</span>];
    });
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="hljs-number">3</span> * <span class="hljs-built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^{
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;31&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;31&quot;</span>];
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;32&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;32&quot;</span>];
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;33&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;33&quot;</span>];
    });
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="hljs-number">4</span> * <span class="hljs-built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^{
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;41&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;41&quot;</span>];
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;42&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;42&quot;</span>];
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;43&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;43&quot;</span>];
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;44&quot;</span>);[subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x6D88;&#x606F;44&quot;</span>];
    });
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}] throttle:<span class="hljs-number">2</span>] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Next:%@&quot;</span>,x);
}];

<span class="hljs-comment">/*
2020-06-08 19:09:37.356497+0800 RACExample[54681:455884] 11
2020-06-08 19:09:39.357101+0800 RACExample[54681:455884] Next:&#x53D1;&#x9001;&#x6D88;&#x606F;11
2020-06-08 19:09:39.357366+0800 RACExample[54681:455884] 21
2020-06-08 19:09:39.357518+0800 RACExample[54681:455884] 22
2020-06-08 19:09:40.540307+0800 RACExample[54681:455884] 31
2020-06-08 19:09:40.541107+0800 RACExample[54681:455884] 32
2020-06-08 19:09:40.541341+0800 RACExample[54681:455884] 33
2020-06-08 19:09:41.357386+0800 RACExample[54681:455884] 41
2020-06-08 19:09:41.357600+0800 RACExample[54681:455884] 42
2020-06-08 19:09:41.357734+0800 RACExample[54681:455884] 43
2020-06-08 19:09:41.357856+0800 RACExample[54681:455884] 44
2020-06-08 19:09:43.369260+0800 RACExample[54681:455884] Next:&#x53D1;&#x9001;&#x6D88;&#x606F;44
*/</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x9519;&#x8BEF;&#x91CD;&#x8BD5;retry"><a name="&#x4FE1;&#x53F7;&#x9519;&#x8BEF;&#x91CD;&#x8BD5;retry" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x9519;&#x8BEF;&#x91CD;&#x8BD5;retry"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x9519;&#x8BEF;&#x91CD;&#x8BD5;retry" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x9519;&#x8BEF;&#x91CD;&#x8BD5;retry"><i class="fa fa-link" aria-hidden="true"></i></a>3.4. &#x4FE1;&#x53F7;&#x9519;&#x8BEF;&#x91CD;&#x8BD5;:retry</h2>
<ul>
<li><code>retry&#x91CD;&#x8BD5;</code> &#xFF1A;&#x53EA;&#x8981;&#x5931;&#x8D25;&#xFF0C;&#x5C31;&#x4F1A;&#x91CD;&#x65B0;&#x6267;&#x884C;&#x521B;&#x5EFA;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;block,&#x76F4;&#x5230;&#x6210;&#x529F;.</li>
</ul>
<pre><code class="lang-objc"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> signalANum = <span class="hljs-number">0</span>;
RACSignal *signal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    <span class="hljs-keyword">if</span> (signalANum &gt;= <span class="hljs-number">5</span>) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;sendNext %d&quot;</span>,signalANum);
        [subscriber sendNext:[<span class="hljs-built_in">NSString</span> stringWithFormat:<span class="hljs-string">@&quot;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;&#x7D2F;&#x8BA1;&#xFF1A;%d&quot;</span>,signalANum]];
        [subscriber sendCompleted];
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;sendError %d&quot;</span>,signalANum);
        [subscriber sendError:[<span class="hljs-built_in">NSError</span> errorWithDomain:<span class="hljs-string">@&quot;&quot;</span> code:<span class="hljs-number">0</span> userInfo:@{<span class="hljs-built_in">NSLocalizedDescriptionKey</span>:<span class="hljs-string">@&quot;Something is wrong!&quot;</span>}]];
    }
    signalANum++;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}];

[[signal retry] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext&#xFF1A;%@&quot;</span>,x);
} error:^(<span class="hljs-built_in">NSError</span> * _Nullable error) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;error info: %@&quot;</span>,error.localizedDescription);
}];
<span class="hljs-comment">/*
2020-06-08 19:03:16.750255+0800 RACExample[54389:451981] sendError 0
2020-06-08 19:03:16.774608+0800 RACExample[54389:451981] sendError 1
2020-06-08 19:03:16.774899+0800 RACExample[54389:451981] sendError 2
2020-06-08 19:03:16.775074+0800 RACExample[54389:451981] sendError 3
2020-06-08 19:03:16.775254+0800 RACExample[54389:451981] sendError 4
2020-06-08 19:03:16.775446+0800 RACExample[54389:451981] sendNext 5
2020-06-08 19:03:16.775579+0800 RACExample[54389:451981] subscribeNext&#xFF1A;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;&#x7D2F;&#x8BA1;&#xFF1A;5
*/</span>
</code></pre>
<h2 id="&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;-switchtolatest"><a name="&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;-switchtolatest" class="plugin-anchor" href="#&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;-switchtolatest"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;-switchtolatest" class="anchor-navigation-ex-anchor" href="#&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;-switchtolatest"><i class="fa fa-link" aria-hidden="true"></i></a>3.5. &#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;: switchToLatest</h2>
<ul>
<li><code>switchToLatest</code>&#x53EA;&#x80FD;&#x7528;&#x4E8E;&#x4FE1;&#x53F7;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;(&#x5426;&#x5219;&#x5D29;&#x6E83;)&#xFF0C;&#x83B7;&#x53D6;&#x6700;&#x65B0;&#x53D1;&#x9001;&#x7684;&#x4FE1;&#x53F7;&#x3002;</li>
<li><code>switchToLatest</code>:&#x7528;&#x4E8E;<code>signalOfSignals&#xFF08;&#x4FE1;&#x53F7;&#x7684;&#x4FE1;&#x53F7;&#xFF09;</code>&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x4FE1;&#x53F7;&#x4E5F;&#x4F1A;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#xFF0C;&#x4F1A;&#x5728;<code>signalOfSignals</code>&#x4E2D;&#xFF0C;&#x83B7;&#x53D6;<code>signalOfSignals</code>&#x53D1;&#x9001;&#x7684;&#x6700;&#x65B0;&#x4FE1;&#x53F7;&#x3002;</li>
</ul>
<h2 id="&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x987A;&#x5E8F;donext&#x3001;docompleted"><a name="&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x987A;&#x5E8F;donext&#x3001;docompleted" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x987A;&#x5E8F;donext&#x3001;docompleted"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x987A;&#x5E8F;donext&#x3001;docompleted" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x987A;&#x5E8F;donext&#x3001;docompleted"><i class="fa fa-link" aria-hidden="true"></i></a>3.6. &#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x987A;&#x5E8F;:doNext&#x3001;doCompleted</h2>
<ul>
<li>&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x524D;&#x4E0E;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x540E;&#x64CD;&#x4F5C;&#xFF1A;<code>doNext</code>&#x3001;<code>doCompleted</code>&#x3002;</li>
<li><code>doNext</code>&#xFF1A;&#x5728;&#x8BA2;&#x9605;&#x8005;&#x53D1;&#x9001;&#x6D88;&#x606F;sendNext&#x4E4B;&#x524D;&#x6267;&#x884C;&#x3002;</li>
<li><code>doCompleted</code>&#xFF1A;&#x5728;&#x8BA2;&#x9605;&#x8005;&#x53D1;&#x9001;&#x5B8C;&#x6210;sendCompleted&#x4E4B;&#x540E;&#x6267;&#x884C;&#x3002;</li>
</ul>
<pre><code class="lang-objc">RACSignal *signal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;1&quot;</span>);
    [subscriber sendNext:<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;1&quot;</span>];
    [subscriber sendCompleted];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}];
[[[signal doNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;doNext,%@&quot;</span>,x);
}] doCompleted:^{
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;doCompleted&quot;</span>);
}] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x6FC0;&#x6D3B;&#x4FE1;&#x53F7;&#xFF1A;%@&quot;</span>,x);
}];
<span class="hljs-comment">/*
2020-06-08 18:49:53.413848+0800 RACExample[53730:443023] &#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;1
2020-06-08 18:49:53.414098+0800 RACExample[53730:443023] doNext,&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;1
2020-06-08 18:49:53.414220+0800 RACExample[53730:443023] &#x6FC0;&#x6D3B;&#x4FE1;&#x53F7;&#xFF1A;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;1
2020-06-08 18:49:53.414823+0800 RACExample[53730:443023] doCompleted
*/</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x53D6;&#x503C;take&#x3001;takeuntil&#x3001;takelast"><a name="&#x4FE1;&#x53F7;&#x53D6;&#x503C;take&#x3001;takeuntil&#x3001;takelast" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x53D6;&#x503C;take&#x3001;takeuntil&#x3001;takelast"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x53D6;&#x503C;take&#x3001;takeuntil&#x3001;takelast" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x53D6;&#x503C;take&#x3001;takeuntil&#x3001;takelast"><i class="fa fa-link" aria-hidden="true"></i></a>3.7. &#x4FE1;&#x53F7;&#x53D6;&#x503C;:take&#x3001;takeUntil&#x3001;takeLast</h2>
<ul>
<li><code>take</code>:&#x4ECE;&#x5F00;&#x59CB;&#x4E00;&#x5171;&#x53D6;N&#x6B21;&#x7684;&#x4FE1;&#x53F7;</li>
<li><code>takeLast</code>:&#x53D6;&#x6700;&#x540E;N&#x6B21;&#x7684;&#x4FE1;&#x53F7;,&#x524D;&#x63D0;&#x6761;&#x4EF6;&#xFF0C;&#x8BA2;&#x9605;&#x8005;&#x5FC5;&#x987B;&#x8C03;&#x7528;&#x5B8C;&#x6210;&#xFF0C;&#x56E0;&#x4E3A;&#x53EA;&#x6709;&#x5B8C;&#x6210;&#xFF0C;&#x5C31;&#x77E5;&#x9053;&#x603B;&#x5171;&#x6709;&#x591A;&#x5C11;&#x4FE1;&#x53F7;.</li>
<li><code>takeUntil</code>:(RACSignal):&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x76F4;&#x5230;&#x67D0;&#x4E2A;&#x4FE1;&#x53F7;&#x6267;&#x884C;&#x5B8C;&#x6210;(&#x539F;&#x59CB;&#x4FE1;&#x53F7;&#x4E00;&#x76F4;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF0C;&#x76F4;&#x5230;&#xFF0C;&#x66FF;&#x4EE3;&#x7684;&#x4FE1;&#x53F7;&#x53D1;&#x51FA;&#x4E8B;&#x4EF6;&#xFF0C;&#x539F;&#x59CB;&#x4FE1;&#x53F7;&#x7EC8;&#x6B62;)&#x3002;</li>
<li><code>skip</code>:(NSUInteger):&#x8DF3;&#x8FC7;&#x51E0;&#x4E2A;&#x4FE1;&#x53F7;,&#x4E0D;&#x63A5;&#x53D7;&#x3002;</li>
</ul>
<pre><code class="lang-objc">-(RACSignal*)createSignal{
    <span class="hljs-keyword">return</span> [RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscriber sendNext -- %d&quot;</span>, i);
            [subscriber sendNext:@(i)];
        }
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;sendCompleted&quot;</span>);
        [subscriber sendCompleted];

        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
}
-(<span class="hljs-keyword">void</span>)test_take{
    RACSignal *signal = [<span class="hljs-keyword">self</span> createSignal];
   [signal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
       <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext -- %@&quot;</span>, x);
   }];
    <span class="hljs-comment">/*
     2020-06-03 14:51:53.558366+0800 RACExample[30888:2260368] subscriber sendNext -- 0
     2020-06-03 14:51:53.558606+0800 RACExample[30888:2260368] subscribeNext -- 0
     2020-06-03 14:51:53.558714+0800 RACExample[30888:2260368] subscriber sendNext -- 1
     2020-06-03 14:51:53.558807+0800 RACExample[30888:2260368] subscribeNext -- 1
     2020-06-03 14:51:53.558898+0800 RACExample[30888:2260368] subscriber sendNext -- 2
     2020-06-03 14:51:53.558985+0800 RACExample[30888:2260368] subscribeNext -- 2
     2020-06-03 14:51:53.559069+0800 RACExample[30888:2260368] subscriber sendNext -- 3
     2020-06-03 14:51:53.559159+0800 RACExample[30888:2260368] subscribeNext -- 3
     2020-06-03 14:51:53.559249+0800 RACExample[30888:2260368] subscriber sendNext -- 4
     2020-06-03 14:51:53.559439+0800 RACExample[30888:2260368] subscribeNext -- 4
     2020-06-03 14:51:53.559708+0800 RACExample[30888:2260368] sendCompleted
     */</span>
</code></pre>
<p>&#x4E0A;&#x9762;&#x662F;&#x6B63;&#x5E38;&#x7684;&#x8BA2;&#x9605;&#x3002;</p>
<pre><code class="lang-objc">-(<span class="hljs-keyword">void</span>)test_take{
    [[signal take:<span class="hljs-number">2</span>] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext -- %@&quot;</span>, x);
    }];
    <span class="hljs-comment">/*
     2020-06-03 14:53:40.530949+0800 RACExample[30990:2262219] subscriber sendNext -- 0
     2020-06-03 14:53:40.531286+0800 RACExample[30990:2262219] subscribeNext -- 0
     2020-06-03 14:53:40.531476+0800 RACExample[30990:2262219] subscriber sendNext -- 1
     2020-06-03 14:53:40.531610+0800 RACExample[30990:2262219] subscribeNext -- 1
     2020-06-03 14:53:40.531734+0800 RACExample[30990:2262219] subscriber sendNext -- 2
     2020-06-03 14:53:40.531829+0800 RACExample[30990:2262219] subscriber sendNext -- 3
     2020-06-03 14:53:40.531924+0800 RACExample[30990:2262219] subscriber sendNext -- 4
     2020-06-03 14:53:40.532056+0800 RACExample[30990:2262219] sendCompleted
     */</span>
}
</code></pre>
<p><code>take:2</code> : &#x53EA;&#x53D6;&#x524D;&#x4E24;&#x6B21;&#x8BA2;&#x9605;&#x7684;&#x4FE1;&#x53F7;&#x3002;</p>
<pre><code class="lang-objc">-(<span class="hljs-keyword">void</span>)test_take{
    [[[signal skip:<span class="hljs-number">1</span>] take:<span class="hljs-number">1</span>] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext -- %@&quot;</span>, x);
    }];
    <span class="hljs-comment">/*
     2020-06-03 14:59:58.615703+0800 RACExample[31246:2265921] subscriber sendNext -- 0 ==&gt; &#x867D;&#x7136;&#x53D1;&#x9001;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4F46;&#x662F; subscriber &#x6CA1;&#x6709;&#x4F7F;&#x7528;&#xFF0C;&#x8DF3;&#x8FC7;&#x8FD9;&#x4E00;&#x6761;
     2020-06-03 14:59:58.616069+0800 RACExample[31246:2265921] subscriber sendNext -- 1
     2020-06-03 14:59:58.616254+0800 RACExample[31246:2265921] subscribeNext -- 1       ==&gt; take:1
     2020-06-03 14:59:58.616376+0800 RACExample[31246:2265921] subscriber sendNext -- 2
     2020-06-03 14:59:58.616494+0800 RACExample[31246:2265921] subscriber sendNext -- 3
     2020-06-03 14:59:58.616608+0800 RACExample[31246:2265921] subscriber sendNext -- 4
     */</span>
}
</code></pre>
<p><code>skip:1</code>&#x548C;<code>take:1</code> : &#x8DF3;&#x8FC7;&#x7B2C;&#x4E00;&#x6761;&#x5F00;&#x59CB;&#x63A5;&#x6536;&#x6570;&#x636E;&#xFF0C;&#x5E76;&#x4E14;&#x53EA;&#x53D6;&#x524D;&#x4E00;&#x6761;&#x6570;&#x636E;&#x3002;</p>
<pre><code class="lang-objc">-(<span class="hljs-keyword">void</span>)test_takeLast{
    [[signal takeLast:<span class="hljs-number">1</span>] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext -- %@&quot;</span>, x);
    }];
    <span class="hljs-comment">/*
     2020-06-03 15:04:32.363153+0800 RACExample[31419:2268388] signal -- 0
     2020-06-03 15:04:32.363415+0800 RACExample[31419:2268388] signal -- 1
     2020-06-03 15:04:32.363534+0800 RACExample[31419:2268388] signal -- 2
     2020-06-03 15:04:32.363639+0800 RACExample[31419:2268388] signal -- 3
     2020-06-03 15:04:32.363741+0800 RACExample[31419:2268388] signal -- 4
     2020-06-03 15:04:32.363943+0800 RACExample[31419:2268388] subscribeNext -- 3
     2020-06-03 15:04:32.364053+0800 RACExample[31419:2268388] subscribeNext -- 4
     */</span>
}
</code></pre>
<p><code>takeLast:1</code> : &#x53EA;&#x83B7;&#x53D6;&#x6700;&#x65B0;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<h2 id="map&#x3001;flattenmap&#x62E6;&#x622A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x6570;&#x636E;"><a name="map&#x3001;flattenmap&#x62E6;&#x622A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x6570;&#x636E;" class="plugin-anchor" href="#map&#x3001;flattenmap&#x62E6;&#x622A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x6570;&#x636E;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="map&#x3001;flattenmap&#x62E6;&#x622A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x6570;&#x636E;" class="anchor-navigation-ex-anchor" href="#map&#x3001;flattenmap&#x62E6;&#x622A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x6570;&#x636E;"><i class="fa fa-link" aria-hidden="true"></i></a>3.8. map&#x3001;flattenMap(&#x62E6;&#x622A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x6570;&#x636E;)</h2>
<ul>
<li><code>map</code> &#xFF1A;&#x5C06;&#x4FE1;&#x53F7;&#x5185;&#x5BB9;&#x4FEE;&#x6539;&#x4E3A;&#x53E6;&#x4E00;&#x79CD;&#x65B0;&#x503C;&#x3002;&#x6539;&#x53D8;&#x4E86;&#x4F20;&#x9012;&#x7684;&#x503C;&#x3002;</li>
<li><code>flattenMap</code>&#xFF1A;&#x5C06;&#x6E90;&#x4FE1;&#x53F7;&#x6620;&#x5C04;&#x4FEE;&#x6539;&#x4E3A;&#x53E6;&#x4E00;&#x79CD;&#x65B0;&#x7684;&#x4FE1;&#x53F7;(<code>RACSignal</code>),&#x4FEE;&#x6539;&#x4E86;&#x4FE1;&#x53F7;&#x672C;&#x8EAB;&#x3002;</li>
</ul>
<h3 id="&#x793A;&#x4F8B;"><a name="&#x793A;&#x4F8B;" class="plugin-anchor" href="#&#x793A;&#x4F8B;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x793A;&#x4F8B;" class="anchor-navigation-ex-anchor" href="#&#x793A;&#x4F8B;"><i class="fa fa-link" aria-hidden="true"></i></a>3.8.1. &#x793A;&#x4F8B;</h3>
<pre><code class="lang-objc">-(<span class="hljs-keyword">void</span>)test_map{
    RACSignal *syncSignal = [RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;signal -- %d&quot;</span>, i);
            [subscriber sendNext:@(i)];
        }
        [subscriber sendCompleted];

        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];

    [[syncSignal map:^<span class="hljs-keyword">id</span> _Nullable(<span class="hljs-keyword">id</span>  _Nullable value) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;map -- %@&quot;</span>, value);
        <span class="hljs-keyword">return</span> [<span class="hljs-built_in">NSString</span> stringWithFormat:<span class="hljs-string">@&quot;MAP+%@&quot;</span>,value];
    }] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext -- %@&quot;</span>, x);
    }];
}
<span class="hljs-comment">/*
2019-08-30 14:00:05.098586+0800 RACExample[99686:2868124] signal -- 0
2019-08-30 14:00:05.098791+0800 RACExample[99686:2868124] map -- 0
2019-08-30 14:00:05.098987+0800 RACExample[99686:2868124] subscribeNext -- MAP+0
2019-08-30 14:00:05.099149+0800 RACExample[99686:2868124] signal -- 1
2019-08-30 14:00:05.099244+0800 RACExample[99686:2868124] map -- 1
2019-08-30 14:00:05.099370+0800 RACExample[99686:2868124] subscribeNext -- MAP+1
2019-08-30 14:00:05.099522+0800 RACExample[99686:2868124] signal -- 2
2019-08-30 14:00:05.099601+0800 RACExample[99686:2868124] map -- 2
2019-08-30 14:00:05.099717+0800 RACExample[99686:2868124] subscribeNext -- MAP+2
2019-08-30 14:00:05.099866+0800 RACExample[99686:2868124] signal -- 3
2019-08-30 14:00:05.100081+0800 RACExample[99686:2868124] map -- 3
2019-08-30 14:00:05.100398+0800 RACExample[99686:2868124] subscribeNext -- MAP+3
2019-08-30 14:00:05.100599+0800 RACExample[99686:2868124] signal -- 4
2019-08-30 14:00:05.100759+0800 RACExample[99686:2868124] map -- 4
2019-08-30 14:00:05.100999+0800 RACExample[99686:2868124] subscribeNext -- MAP+4
*/</span>
</code></pre>
<p>flattenMap</p>
<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];

    RACSignal *syncSignal = [RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;signal -- %d&quot;</span>, i);
            [subscriber sendNext:@(i)];
        }
        [subscriber sendCompleted];

        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];

    [[syncSignal flattenMap:^__kindof RACSignal * _Nullable(<span class="hljs-keyword">id</span>  _Nullable value) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;map -- %@&quot;</span>, value);
        <span class="hljs-keyword">return</span> [RACSignal <span class="hljs-keyword">return</span>:value].logCompleted;
    }] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext -- %@&quot;</span>, x);
    }];
}
<span class="hljs-comment">/*
2020-05-28 14:44:12.520009+0800 RACExample[45556:11658886] signal -- 0
2020-05-28 14:44:12.520142+0800 RACExample[45556:11658886] map -- 0
2020-05-28 14:44:12.520316+0800 RACExample[45556:11658886] subscribeNext -- 0
2020-05-28 14:44:12.520456+0800 RACExample[45556:11658886] &lt;RACReturnSignal: 0x60000023e320&gt; name:  completed
2020-05-28 14:44:12.520567+0800 RACExample[45556:11658886] signal -- 1
2020-05-28 14:44:12.520658+0800 RACExample[45556:11658886] map -- 1
2020-05-28 14:44:12.520790+0800 RACExample[45556:11658886] subscribeNext -- 1
2020-05-28 14:44:12.520902+0800 RACExample[45556:11658886] &lt;RACReturnSignal: 0x60000023e360&gt; name:  completed
2020-05-28 14:44:12.521116+0800 RACExample[45556:11658886] signal -- 2
2020-05-28 14:44:12.521573+0800 RACExample[45556:11658886] map -- 2
2020-05-28 14:44:12.521995+0800 RACExample[45556:11658886] subscribeNext -- 2
2020-05-28 14:44:12.522413+0800 RACExample[45556:11658886] &lt;RACReturnSignal: 0x600000238520&gt; name:  completed
2020-05-28 14:44:12.522804+0800 RACExample[45556:11658886] signal -- 3
2020-05-28 14:44:12.537218+0800 RACExample[45556:11658886] map -- 3
2020-05-28 14:44:12.537473+0800 RACExample[45556:11658886] subscribeNext -- 3
2020-05-28 14:44:12.537624+0800 RACExample[45556:11658886] &lt;RACReturnSignal: 0x600000238560&gt; name:  completed
2020-05-28 14:44:12.537738+0800 RACExample[45556:11658886] signal -- 4
2020-05-28 14:44:12.537825+0800 RACExample[45556:11658886] map -- 4
2020-05-28 14:44:12.537941+0800 RACExample[45556:11658886] subscribeNext -- 4
2020-05-28 14:44:12.538046+0800 RACExample[45556:11658886] &lt;RACReturnSignal: 0x600000238580&gt; name:  completed
*/</span>
</code></pre>
<h3 id="&#x793A;&#x4F8B;_1"><a name="&#x793A;&#x4F8B;_1" class="plugin-anchor" href="#&#x793A;&#x4F8B;_1"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x793A;&#x4F8B;_1" class="anchor-navigation-ex-anchor" href="#&#x793A;&#x4F8B;_1"><i class="fa fa-link" aria-hidden="true"></i></a>3.8.2. &#x793A;&#x4F8B;</h3>
<pre><code class="lang-objc"><span class="hljs-comment">//&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x4FE1;&#x53F7;</span>
RACSignal *signal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">NSInteger</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">5</span>; i ++) {
        [subscriber sendNext:@(i)];
    }
    [subscriber sendCompleted];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}];

<span class="hljs-comment">//&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7684;&#x4FE1;&#x53F7;&#xFF0C;&#x4FE1;&#x53F7;&#x7684;&#x4FE1;&#x53F7;</span>
RACSignal *signalOfSignals = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    [subscriber sendNext:signal];
    [subscriber sendCompleted];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}];

[signalOfSignals subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-comment">//&#x4E0D;&#x4F7F;&#x7528;flattenMap&#xFF0C;&#x4F1A;&#x6253;&#x5370;&#x51FA;&#x5185;&#x90E8;&#x4FE1;&#x53F7;</span>
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x8BA2;&#x9605;signalOfSignals&#xFF1A;%@&quot;</span>,x);
}];

[[signalOfSignals flattenMap:^__kindof RACSignal * _Nullable(<span class="hljs-keyword">id</span>  _Nullable value) {
    <span class="hljs-keyword">return</span> [value filter:^<span class="hljs-built_in">BOOL</span>(<span class="hljs-built_in">NSNumber</span>*  _Nullable value) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;filter&#xFF1A;%@&quot;</span>,value);
        <span class="hljs-keyword">return</span> [value integerValue] &gt;= <span class="hljs-number">2</span> ? <span class="hljs-literal">YES</span>: <span class="hljs-literal">NO</span>;
    }];
}] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-comment">//&#x4F7F;&#x7528;flattenMap&#xFF0C;&#x4F1A;&#x6253;&#x5370;&#x5185;&#x90E8;&#x4FE1;&#x53F7;&#x7684;&#x503C;</span>
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x4F7F;&#x7528;flattenMap&#x540E;&#x8BA2;&#x9605;signalOfSignals&#xFF1A;%@&quot;</span>,x);
}];

<span class="hljs-comment">/*
2020-06-08 17:54:26.211401+0800 RACExample[51286:408356] &#x8BA2;&#x9605;signalOfSignals&#xFF1A;&lt;RACDynamicSignal: 0x6000011c3880&gt; name: 
2020-06-08 17:54:26.213350+0800 RACExample[51286:408356] filter&#xFF1A;0
2020-06-08 17:54:26.213911+0800 RACExample[51286:408356] filter&#xFF1A;1
2020-06-08 17:54:26.214308+0800 RACExample[51286:408356] filter&#xFF1A;2
2020-06-08 17:54:26.214501+0800 RACExample[51286:408356] &#x4F7F;&#x7528;flattenMap&#x540E;&#x8BA2;&#x9605;signalOfSignals&#xFF1A;2
2020-06-08 17:54:26.214642+0800 RACExample[51286:408356] filter&#xFF1A;3
2020-06-08 17:54:26.214780+0800 RACExample[51286:408356] &#x4F7F;&#x7528;flattenMap&#x540E;&#x8BA2;&#x9605;signalOfSignals&#xFF1A;3
2020-06-08 17:54:26.214903+0800 RACExample[51286:408356] filter&#xFF1A;4
2020-06-08 17:54:26.215048+0800 RACExample[51286:408356] &#x4F7F;&#x7528;flattenMap&#x540E;&#x8BA2;&#x9605;signalOfSignals&#xFF1A;4
2020-06-08 17:54:26.215221+0800 RACExample[51286:408356] filter&#xFF1A;5
2020-06-08 17:54:26.215357+0800 RACExample[51286:408356] &#x4F7F;&#x7528;flattenMap&#x540E;&#x8BA2;&#x9605;signalOfSignals&#xFF1A;5
*/</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;delay&#x5EF6;&#x8FDF;"><a name="&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;delay&#x5EF6;&#x8FDF;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;delay&#x5EF6;&#x8FDF;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;delay&#x5EF6;&#x8FDF;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;delay&#x5EF6;&#x8FDF;"><i class="fa fa-link" aria-hidden="true"></i></a>3.9. &#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;:delay(&#x5EF6;&#x8FDF;)</h2>
<blockquote>
<p>&#x5EF6;&#x8FDF;&#x53D1;&#x9001;next&#x3002;</p>
</blockquote>
<pre><code class="lang-objc">[[[RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {
    [subscriber sendNext:@(<span class="hljs-number">1</span>)];
    [subscriber sendCompleted];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}] delay:<span class="hljs-number">2</span>] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext:%@&quot;</span>, x);
}];
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;interval&#x5B9A;&#x65F6;"><a name="&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;interval&#x5B9A;&#x65F6;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;interval&#x5B9A;&#x65F6;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;interval&#x5B9A;&#x65F6;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;interval&#x5B9A;&#x65F6;"><i class="fa fa-link" aria-hidden="true"></i></a>3.10. &#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;:interval(&#x5B9A;&#x65F6;)</h2>
<blockquote>
<p>&#x6BCF;&#x9694;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;</p>
</blockquote>
<pre><code class="lang-objc">-(<span class="hljs-keyword">void</span>)test_interval_onScheduler{
    [[RACSignal interval:<span class="hljs-number">1</span> onScheduler:[RACScheduler mainThreadScheduler]] subscribeNext:^(<span class="hljs-built_in">NSDate</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;interval -- %@&quot;</span>, x);
    }];
    <span class="hljs-comment">// &#x4FDD;&#x8BC1;&#x4E0A;&#x9762;&#x7684;&#x5EF6;&#x65F6;&#x64CD;&#x4F5C;&#x5F97;&#x4EE5;&#x5B8C;&#x6210;</span>
    [[RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }] asynchronouslyWaitUntilCompleted:<span class="hljs-literal">nil</span>];
}
<span class="hljs-comment">/*
2019-08-07 10:10:38.795691+0800 RACDemo02[45596:1122009] interval -- Wed Aug  7 10:10:38 2019
2019-08-07 10:10:39.796486+0800 RACDemo02[45596:1122009] interval -- Wed Aug  7 10:10:39 2019
2019-08-07 10:10:40.796486+0800 RACDemo02[45596:1122009] interval -- Wed Aug  7 10:10:40 2019
2019-08-07 10:10:41.796472+0800 RACDemo02[45596:1122009] interval -- Wed Aug  7 10:10:41 2019
2019-08-07 10:10:42.796452+0800 RACDemo02[45596:1122009] interval -- Wed Aug  7 10:10:42 2019
2019-08-07 10:10:43.796631+0800 RACDemo02[45596:1122009] interval -- Wed Aug  7 10:10:43 2019
2019-08-07 10:10:44.796494+0800 RACDemo02[45596:1122009] interval -- Wed Aug  7 10:10:44 2019
2019-08-07 10:10:45.796493+0800 RACDemo02[45596:1122009] interval -- Wed Aug  7 10:10:45 2019
*/</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;timeout&#x8D85;&#x65F6;"><a name="&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;timeout&#x8D85;&#x65F6;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;timeout&#x8D85;&#x65F6;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;timeout&#x8D85;&#x65F6;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;timeout&#x8D85;&#x65F6;"><i class="fa fa-link" aria-hidden="true"></i></a>3.11. &#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x65F6;&#x95F4;:timeout(&#x8D85;&#x65F6;)</h2>
<ul>
<li><code>timeout</code>&#xFF1A;&#x8D85;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x8BA9;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x5728;&#x4E00;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x540E;&#xFF0C;&#x81EA;&#x52A8;&#x62A5;&#x9519;&#x3002;</li>
</ul>
<pre><code class="lang-objc">[[[RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    [[RACScheduler mainThreadScheduler] afterDelay:<span class="hljs-number">3</span> schedule:^{
        [subscriber sendNext:@<span class="hljs-number">1</span>];
        [subscriber sendCompleted];
    }];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}] timeout:<span class="hljs-number">2.0</span> onScheduler:[RACScheduler currentScheduler]] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext&#xFF1A;%@&quot;</span>,x);
} error:^(<span class="hljs-built_in">NSError</span> * _Nullable error) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;error&#xFF1A;%@&quot;</span>,error.localizedDescription);
} completed:^{
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;completed&quot;</span>);
}];
<span class="hljs-comment">/*
error&#xFF1A;The operation couldn&#x2019;t be completed. (RACSignalErrorDomain error 1.)
*/</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;distinctuntilchanged"><a name="&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;distinctuntilchanged" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;distinctuntilchanged"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;distinctuntilchanged" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;distinctuntilchanged"><i class="fa fa-link" aria-hidden="true"></i></a>3.12. &#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;:distinctUntilChanged</h2>
<blockquote>
<p><code>distinctUntilChanged</code>:&#x5F53;&#x4E0A;&#x4E00;&#x6B21;&#x7684;&#x503C;&#x548C;&#x5F53;&#x524D;&#x7684;&#x503C;&#x6709;&#x660E;&#x663E;&#x7684;&#x53D8;&#x5316;&#x5C31;&#x4F1A;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;&#x6389;&#x3002;</p>
</blockquote>
<pre><code class="lang-objc"><span class="hljs-comment">// distinctUntilChanged &#x53EA;&#x6709;&#x8F93;&#x5165;&#x5408;&#x6CD5;&#x624D;&#x80FD;&#x8FDB;&#x884C;&#x6253;&#x5370;</span>
RACSignal *validSearchSignal = [[RACObserve(<span class="hljs-keyword">self</span>, searchText) map:^<span class="hljs-keyword">id</span> _Nullable(<span class="hljs-built_in">NSString</span>*  _Nullable value) {
    <span class="hljs-keyword">return</span> @(value.length &gt; <span class="hljs-number">3</span>);
}]distinctUntilChanged];
[validSearchSignal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;search text is valid %@&quot;</span>, x);
}];
<span class="hljs-keyword">self</span>.executeSearch = [[RACCommand alloc] initWithEnabled:validSearchSignal signalBlock:^RACSignal * _Nonnull(<span class="hljs-keyword">id</span>  _Nullable input) {
    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">self</span> executeSearchSignal];
}];
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;ignore&#x5FFD;&#x7565;"><a name="&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;ignore&#x5FFD;&#x7565;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;ignore&#x5FFD;&#x7565;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;ignore&#x5FFD;&#x7565;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;ignore&#x5FFD;&#x7565;"><i class="fa fa-link" aria-hidden="true"></i></a>3.13. &#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;:ignore(&#x5FFD;&#x7565;)</h2>
<blockquote>
<p>&#x5FFD;&#x7565;&#x5B8C;&#x67D0;&#x4E9B;&#x503C;&#x7684;&#x4FE1;&#x53F7;&#xFF0C;&#x9488;&#x5BF9;&#x4FE1;&#x53F7;&#x503C;&#x7684;&#x67D0;&#x4E00;&#x79CD;&#x72B6;&#x6001;&#x8FDB;&#x884C;&#x5FFD;&#x7565;&#xFF0C;&#x5FFD;&#x7565;&#x65F6;&#x4E0D;&#x4F1A;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x3002;</p>
</blockquote>
<pre><code class="lang-objc">[[<span class="hljs-keyword">self</span>.textField.rac_textSignal ignore:<span class="hljs-string">@&quot;123&quot;</span>] subscribeNext:^(<span class="hljs-built_in">NSString</span> * _Nullable x) {
   <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;%@&quot;</span>,x);
}];

<span class="hljs-comment">/*
2020-05-28 19:02:21.305235+0800 RACExample[54835:11820168] 1
2020-05-28 19:02:22.011735+0800 RACExample[54835:11820168] 12
2020-05-28 19:02:23.618772+0800 RACExample[54835:11820168] 1234
2020-05-28 19:02:24.323828+0800 RACExample[54835:11820168] 12345
2020-05-28 19:02:25.367480+0800 RACExample[54835:11820168] 123456
2020-05-28 19:02:26.316891+0800 RACExample[54835:11820168] 12345
2020-05-28 19:02:26.874963+0800 RACExample[54835:11820168] 1234
2020-05-28 19:02:29.028761+0800 RACExample[54835:11820168] 12
2020-05-28 19:02:29.442549+0800 RACExample[54835:11820168] 1
2020-05-28 19:02:30.029542+0800 RACExample[54835:11820168] 
*/</span>
</code></pre>
<p><img src="../assets/images/iOS/rac/06.gif"></p>
<h2 id="&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;filter&#x8FC7;&#x6EE4;"><a name="&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;filter&#x8FC7;&#x6EE4;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;filter&#x8FC7;&#x6EE4;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;filter&#x8FC7;&#x6EE4;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;filter&#x8FC7;&#x6EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>3.14. &#x4FE1;&#x53F7;&#x8FC7;&#x6EE4;:filter(&#x8FC7;&#x6EE4;)</h2>
<blockquote>
<p>&#x8FC7;&#x6EE4;&#x4FE1;&#x53F7;&#xFF0C;&#x4F7F;&#x7528;&#x5B83;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;&#x4FE1;&#x53F7;,&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x7684;&#x4FE1;&#x53F7;&#x624D;&#x80FD;&#x53D1;&#x51FA;&#x6D88;&#x606F;&#x3002;</p>
</blockquote>
<pre><code class="lang-objc">RAC(<span class="hljs-keyword">self</span>.textLabel,text) = [<span class="hljs-keyword">self</span>.textField.rac_textSignal filter:^<span class="hljs-built_in">BOOL</span>(<span class="hljs-built_in">NSString</span> * _Nullable value) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;%@&quot;</span>,value);
    <span class="hljs-keyword">return</span> [value isEqualToString:<span class="hljs-string">@&quot;12345&quot;</span>];
}];

[[<span class="hljs-keyword">self</span>.textField.rac_textSignal filter:^<span class="hljs-built_in">BOOL</span>(<span class="hljs-built_in">NSString</span> * _Nullable value) {
    <span class="hljs-keyword">return</span> [value isEqualToString:<span class="hljs-string">@&quot;12345&quot;</span>];
}] subscribeNext:^(<span class="hljs-built_in">NSString</span> * _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;%@&quot;</span>,x);
}];
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x5408;&#x5E76;combinelatest&#x7ED3;&#x5408;&#x3001;reduce&#x805A;&#x5408;"><a name="&#x4FE1;&#x53F7;&#x5408;&#x5E76;combinelatest&#x7ED3;&#x5408;&#x3001;reduce&#x805A;&#x5408;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x5408;&#x5E76;combinelatest&#x7ED3;&#x5408;&#x3001;reduce&#x805A;&#x5408;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x5408;&#x5E76;combinelatest&#x7ED3;&#x5408;&#x3001;reduce&#x805A;&#x5408;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x5408;&#x5E76;combinelatest&#x7ED3;&#x5408;&#x3001;reduce&#x805A;&#x5408;"><i class="fa fa-link" aria-hidden="true"></i></a>3.15. &#x4FE1;&#x53F7;&#x5408;&#x5E76;:combineLatest(&#x7ED3;&#x5408;)&#x3001;reduce(&#x805A;&#x5408;)</h2>
<blockquote>
<p>combineLatest: &#x5C06;&#x591A;&#x4E2A;&#x4FE1;&#x53F7;&#x5408;&#x5E76;&#x8D77;&#x6765;&#xFF0C;&#x5E76;&#x4E14;&#x62FF;&#x5230;&#x5404;&#x4E2A;&#x4FE1;&#x53F7;&#x7684;&#x6700;&#x65B0;&#x7684;&#x503C;,&#x5FC5;&#x987B;&#x6BCF;&#x4E2A;&#x5408;&#x5E76;&#x7684;signal&#x81F3;&#x5C11;&#x90FD;&#x6709;&#x8FC7;&#x4E00;&#x6B21;sendNext&#xFF0C;&#x624D;&#x4F1A;&#x89E6;&#x53D1;&#x5408;&#x5E76;&#x7684;&#x4FE1;&#x53F7;&#x3002;combineLatest &#x529F;&#x80FD;&#x548C; zipWith&#x4E00;&#x6837;&#x3002; <br>
reduce:&#x7528;&#x4E8E;&#x4FE1;&#x53F7;&#x53D1;&#x51FA;&#x7684;&#x5185;&#x5BB9;&#x662F;&#x5143;&#x7EC4;&#xFF0C;&#x628A;&#x4FE1;&#x53F7;&#x53D1;&#x51FA;&#x5143;&#x7EC4;&#x7684;&#x503C;&#x805A;&#x5408;&#x6210;&#x4E00;&#x4E2A;&#x503C;,&#x4E00;&#x822C;&#x90FD;&#x662F;&#x5148;&#x7ED3;&#x5408;&#x518D;&#x805A;&#x5408;&#x3002;</p>
</blockquote>
<p>combineLatest&#x793A;&#x4F8B;:</p>
<pre><code class="lang-objc">-(<span class="hljs-keyword">void</span>)test_combineLatest_1{
    RACReplaySubject * subjectA = [RACReplaySubject subject];
    RACReplaySubject * subjectB = [RACReplaySubject subject];
    RACReplaySubject * subjectC = [RACReplaySubject subject];

    <span class="hljs-comment">// &#x4E09;&#x4E2A;&#x5BF9;&#x8C61;&#x540C;&#x65F6;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF0C;&#x7F3A;&#x4E00;&#x4E0D;&#x53EF;</span>
    [subjectA sendNext:@<span class="hljs-number">1</span>];
    [subjectB sendNext:@<span class="hljs-number">2</span>];
    [subjectC sendNext:@<span class="hljs-number">3</span>];

    [[RACSignal combineLatest:@[subjectA,subjectB,subjectC]] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-comment">// x &#x7684;&#x7C7B;&#x578B;&#x4E3A; RACTuple &#x5143;&#x7EC4;&#x7C7B; -&gt; RACOneTuple&#x3001;RACTwoTuple&#x3001;RACThreeTuple&#x3001;RACFourTuple</span>
         <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;%@&quot;</span>,x);
    }];
    <span class="hljs-comment">/*
     2020-05-28 18:54:23.910080+0800 RACExample[54517:11813771] &lt;RACTuple: 0x600002aa1410&gt; (
         1,
         2,
         3
     )
     */</span>
}
</code></pre>
<p>combineLatest&#x3001;reduce&#x793A;&#x4F8B;:</p>
<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];

    RACReplaySubject * subjectA = [RACReplaySubject subject];
    RACReplaySubject * subjectB = [RACReplaySubject subject];
    RACReplaySubject * subjectC = [RACReplaySubject subject];

    <span class="hljs-comment">// &#x4E09;&#x4E2A;&#x5BF9;&#x8C61;&#x540C;&#x65F6;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF0C;&#x7F3A;&#x4E00;&#x4E0D;&#x53EF;</span>
    [subjectA sendNext:<span class="hljs-string">@&quot;&#x90AE;&#x4EF6;AA&quot;</span>];
    [subjectB sendNext:<span class="hljs-string">@&quot;&#x90AE;&#x4EF6;BB&quot;</span>];
    [subjectC sendNext:<span class="hljs-string">@&quot;&#x90AE;&#x4EF6;CC&quot;</span>];

    <span class="hljs-comment">// &#x9075;&#x5B88; NSFastEnumeration &#x534F;&#x8BAE;&#x7684;&#x7C7B;&#x90FD;&#x53EF;&#x6210;&#x4E3A;&#x6570;&#x7EC4;</span>
    <span class="hljs-comment">// reduce block &#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x6839;&#x636E;&#x4FE1;&#x53F7;&#x8BBE;&#x7F6E;</span>
    [[RACSignal combineLatest:@[subjectA,subjectB,subjectC] reduce:^<span class="hljs-keyword">id</span> (<span class="hljs-built_in">NSString</span> * signalA,<span class="hljs-built_in">NSString</span> * signalB,<span class="hljs-built_in">NSString</span> * signalC){
        <span class="hljs-comment">// &#x628A;&#x8FD9; &#x4E09;&#x4E2A;&#x4E2D;&#x4EFB;&#x610F; &#x4E00;&#x4E2A;&#x53D1;&#x51FA;&#x7684;&#x4FE1;&#x53F7;&#x503C; &#x805A;&#x5408;&#x6210;&#x4E00;&#x4E2A;&#x503C; NSString &#x7C7B;&#x578B;</span>
        <span class="hljs-keyword">return</span> [<span class="hljs-built_in">NSString</span> stringWithFormat:<span class="hljs-string">@&quot;A = %@ , B = %@ , C = %@&quot;</span>,signalA , signalB , signalC];
    }] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x805A;&#x5408;&#x540E;&#x4E09;&#x4E2A;&#x503C;&#x53D8;&#x6210;&#x4E00;&#x4E2A; NSString &#x7C7B;&#x578B;&#x7684;&#x503C;&#xFF1A; %@&quot;</span>,x);
    }];

    <span class="hljs-comment">// &#x6216;&#x8005;</span>
    RAC(<span class="hljs-keyword">self</span>.textLabel,text) = [RACSignal combineLatest:@[subjectA,subjectB,subjectC] reduce:^<span class="hljs-keyword">id</span> (<span class="hljs-built_in">NSString</span> * signalA,<span class="hljs-built_in">NSString</span> * signalB,<span class="hljs-built_in">NSString</span> * signalC){
        <span class="hljs-keyword">return</span> [<span class="hljs-built_in">NSString</span> stringWithFormat:<span class="hljs-string">@&quot;A = %@ , B = %@ , C = %@&quot;</span>,signalA , signalB , signalC];
    }];
}
<span class="hljs-comment">/*
2020-05-28 14:28:01.127620+0800 RACExample[44949:11647817] &#x805A;&#x5408;&#x540E;&#x4E09;&#x4E2A;&#x503C;&#x53D8;&#x6210;&#x4E00;&#x4E2A; NSString &#x7C7B;&#x578B;&#x7684;&#x503C;&#xFF1A; A = &#x90AE;&#x4EF6;AA , B = &#x90AE;&#x4EF6;BB , C = &#x90AE;&#x4EF6;CC
*/</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x5408;&#x5E76;zipwith&#x538B;&#x7F29;"><a name="&#x4FE1;&#x53F7;&#x5408;&#x5E76;zipwith&#x538B;&#x7F29;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x5408;&#x5E76;zipwith&#x538B;&#x7F29;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x5408;&#x5E76;zipwith&#x538B;&#x7F29;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x5408;&#x5E76;zipwith&#x538B;&#x7F29;"><i class="fa fa-link" aria-hidden="true"></i></a>3.16. &#x4FE1;&#x53F7;&#x5408;&#x5E76;:zipWith(&#x538B;&#x7F29;)</h2>
<blockquote>
<p>&#x628A;&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;&#x538B;&#x7F29;&#x6210;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;&#x540C;&#x65F6;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#x5185;&#x5BB9;&#x65F6;&#xFF0C;&#x5E76;&#x4E14;&#x628A;&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;&#x7684;&#x5185;&#x5BB9;&#x5408;&#x5E76;&#x6210;&#x4E00;&#x4E2A;&#x5143;&#x7EC4;&#xFF0C;&#x624D;&#x4F1A;&#x89E6;&#x53D1;&#x538B;&#x7F29;&#x6D41;&#x7684;next&#x4E8B;&#x4EF6;&#x3002; <br>
&#x4F7F;&#x7528; zipWith &#x65F6;&#xFF0C;&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;&#x5FC5;&#x987B;&#x540C;&#x65F6;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#x5185;&#x5BB9;</p>
</blockquote>
<p><img src="../assets/images/iOS/rac/05.png" width="50%" height="50%"></p>
<pre><code class="lang-objc">-(<span class="hljs-keyword">void</span>)test_zipWith{
    RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {
        [subscriber sendNext:@<span class="hljs-number">1</span>];
        [subscriber sendCompleted];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];

    RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {
        [subscriber sendNext:@<span class="hljs-number">2</span>];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
    [[signalA zipWith:signalB] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-comment">// x &#x7684;&#x7C7B;&#x578B;&#x4E3A; RACTuple &#x5143;&#x7EC4;&#x7C7B; -&gt; RACOneTuple&#x3001;RACTwoTuple&#x3001;RACThreeTuple&#x3001;RACFourTuple</span>
         <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;%@&quot;</span>,x);
    }];
}
<span class="hljs-comment">/*
2020-05-28 18:38:30.014387+0800 RACExample[53947:11801545] &lt;RACTwoTuple: 0x600000560900&gt; (
    1,
    2
)
*/</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x5408;&#x5E76;merge&#x5408;&#x5E76;"><a name="&#x4FE1;&#x53F7;&#x5408;&#x5E76;merge&#x5408;&#x5E76;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x5408;&#x5E76;merge&#x5408;&#x5E76;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x5408;&#x5E76;merge&#x5408;&#x5E76;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x5408;&#x5E76;merge&#x5408;&#x5E76;"><i class="fa fa-link" aria-hidden="true"></i></a>3.17. &#x4FE1;&#x53F7;&#x5408;&#x5E76;:merge(&#x5408;&#x5E76;)</h2>
<blockquote>
<p>&#x628A;&#x591A;&#x4E2A;&#x4FE1;&#x53F7;&#x5408;&#x5E76;&#x4E3A;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x6709;&#x65B0;&#x503C;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x8C03;&#x7528; <br>
&#x53EA;&#x8981;&#x6709;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x88AB;&#x53D1;&#x51FA;&#x5C31;&#x4F1A;&#x88AB;&#x76D1;&#x542C;</p>
</blockquote>
<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    RACReplaySubject * subjectA = [RACReplaySubject subject];
    RACReplaySubject * subjectB = [RACReplaySubject subject];
    RACReplaySubject * subjectC = [RACReplaySubject subject];

    <span class="hljs-comment">// &#x4E09;&#x4E2A;&#x5BF9;&#x8C61;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF08;&#x53EA;&#x9700;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x65F6;&#xFF0C;&#x5408;&#x5E76;&#x7684; &#x4FE1;&#x53F7;&#x5BF9;&#x8C61; &#x90FD;&#x53EF;&#x4EE5;&#x5728;&#x8BA2;&#x9605;&#x7684; block &#x63A5;&#x6536;&#x5230;&#x4FE1;&#x606F;&#xFF09;</span>
    [subjectC sendNext:<span class="hljs-string">@&quot;CC&quot;</span>];
    [subjectA sendNext:<span class="hljs-string">@&quot;AA&quot;</span>];
    [subjectB sendNext:<span class="hljs-string">@&quot;BB&quot;</span>];

    <span class="hljs-comment">// &#x5408;&#x5E76;&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;&#x5BF9;&#x8C61;&#x53D8;&#x6210;&#x4E00;&#x4E2A;&#x63A5;&#x6536;&#x4FE1;&#x53F7;&#x5BF9;&#x8C61; subjectD , subjectD &#x8BA2;&#x9605; &#x63A5;&#x6536; subjectB &#x548C; subjectA &#x53D1;&#x9001;&#x7684;&#x4FE1;&#x53F7;,&#x4FE1;&#x53F7;&#x8F93;&#x5165;&#x7684;&#x987A;&#x5E8F;&#x548C;&#x4FE1;&#x53F7;merge&#x7684;&#x987A;&#x5E8F;&#x6709;&#x5173;&#x8054;&#x3002;</span>
    [[[subjectB merge:subjectA] merge:subjectC] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;%@&quot;</span>,x);
    }];
}
<span class="hljs-comment">/*
2020-05-28 14:16:49.377200+0800 RACExample[44542:11640972] BB
2020-05-28 14:16:49.377353+0800 RACExample[44542:11640972] AA
2020-05-28 14:16:49.377509+0800 RACExample[44542:11640972] CC
*/</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x62FC;&#x63A5;then&#x8FDE;&#x63A5;"><a name="&#x4FE1;&#x53F7;&#x62FC;&#x63A5;then&#x8FDE;&#x63A5;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x62FC;&#x63A5;then&#x8FDE;&#x63A5;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x62FC;&#x63A5;then&#x8FDE;&#x63A5;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x62FC;&#x63A5;then&#x8FDE;&#x63A5;"><i class="fa fa-link" aria-hidden="true"></i></a>3.18. &#x4FE1;&#x53F7;&#x62FC;&#x63A5;:then(&#x8FDE;&#x63A5;)</h2>
<ul>
<li>&#x4F7F;&#x7528;then&#x8FDE;&#x63A5;&#x4FE1;&#x53F7;&#xFF0C;&#x4E0A;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x624D;&#x4F1A;&#x8FDE;&#x63A5;then&#x8FD4;&#x56DE;&#x7684;&#x4FE1;&#x53F7;&#xFF0C;&#x6240;&#x4EE5;then&#x8FDE;&#x63A5;&#x7684;&#x4E0A;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x5FC5;&#x987B;&#x4F7F;&#x7528;<code>sendCompleted</code>&#xFF0C;&#x5426;&#x5219;&#x540E;&#x7EED;&#x4FE1;&#x53F7;&#x65E0;&#x6CD5;&#x6267;&#x884C;&#x3002;</li>
<li>then&#x8FDE;&#x63A5;&#x7684;&#x591A;&#x4E2A;&#x4FE1;&#x53F7;&#x4E0E;concat&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF1A;<strong>&#x4E4B;&#x524D;&#x7684;&#x4FE1;&#x53F7;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;&#x6389;&#xFF0C;&#x5373;&#x8BA2;&#x9605;&#x4FE1;&#x53F7;&#x53EA;&#x4F1A;&#x63A5;&#x6536;&#x5230;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x7684;&#x503C;</strong>&#x3002;</li>
</ul>
<pre><code class="lang-objc">[[RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;signalOne&quot;</span>);
    [subscriber sendNext:<span class="hljs-string">@&quot;signalOne&quot;</span>];
    [subscriber sendCompleted];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:%@&quot;</span>,x);
}];
<span class="hljs-comment">/*
2020-06-08 18:28:17.835711+0800 RACExample[52619:427692] signalOne
2020-06-08 18:28:17.836206+0800 RACExample[52619:427692] &#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:signalOne
*/</span>
</code></pre>
<p>&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;<code>then</code>&#x4FE1;&#x53F7;&#xFF1A;</p>
<pre><code class="lang-objc">[[[[RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;signalOne&quot;</span>);
    [subscriber sendNext:<span class="hljs-string">@&quot;signalOne&quot;</span>];
    [subscriber sendCompleted];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}] then:^RACSignal * _Nonnull{
    <span class="hljs-keyword">return</span> [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;signalTwo&quot;</span>);
        [subscriber sendNext:<span class="hljs-string">@&quot;signalTwo&quot;</span>];
        [subscriber sendCompleted];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
}] then:^RACSignal * _Nonnull{
    <span class="hljs-keyword">return</span> [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;signalThree&quot;</span>);
        [subscriber sendNext:<span class="hljs-string">@&quot;signalThree&quot;</span>];
        [subscriber sendCompleted];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
}] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:%@&quot;</span>,x);
}];
<span class="hljs-comment">/*
2020-06-08 18:34:42.158566+0800 RACExample[52963:432992] signalOne
2020-06-08 18:34:42.159054+0800 RACExample[52963:432992] signalTwo
2020-06-08 18:34:42.159283+0800 RACExample[52963:432992] signalThree
2020-06-08 18:34:42.159633+0800 RACExample[52963:432992] &#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:signalThree
*/</span>
</code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x62FC;&#x63A5;concat&#x5408;&#x5E76;"><a name="&#x4FE1;&#x53F7;&#x62FC;&#x63A5;concat&#x5408;&#x5E76;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x62FC;&#x63A5;concat&#x5408;&#x5E76;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x62FC;&#x63A5;concat&#x5408;&#x5E76;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x62FC;&#x63A5;concat&#x5408;&#x5E76;"><i class="fa fa-link" aria-hidden="true"></i></a>3.19. &#x4FE1;&#x53F7;&#x62FC;&#x63A5;:concat(&#x5408;&#x5E76;)</h2>
<ul>
<li>&#x4F7F;&#x7528;<code>concat</code>&#x53EF;&#x4EE5;&#x6309;&#x5E8F;&#x62FC;&#x63A5;&#x591A;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x62FC;&#x63A5;&#x540E;&#x7684;&#x4FE1;&#x53F7;&#x6309;&#x5E8F;&#x6267;&#x884C;&#x3002;</li>
<li>&#x53EA;&#x6709;&#x524D;&#x9762;&#x7684;&#x4FE1;&#x53F7;&#x6267;&#x884C;<code>sendCompleted</code>&#xFF0C;&#x540E;&#x9762;&#x7684;&#x4FE1;&#x53F7;&#x624D;&#x4F1A;&#x88AB;&#x6FC0;&#x6D3B;&#x3002;</li>
</ul>
<p><img src="../assets/images/iOS/rac/04.png" width="50%" height="50%"></p>
<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];

    RACSignal *signalOne = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        [subscriber sendNext:<span class="hljs-string">@&quot;signalOne&quot;</span>];
        [subscriber sendCompleted];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
    RACSignal *signalTwo = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        [subscriber sendNext:<span class="hljs-string">@&quot;signalTwo&quot;</span>];
<span class="hljs-comment">//        [subscriber sendCompleted];</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
    RACSignal *signalThree = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        [subscriber sendNext:<span class="hljs-string">@&quot;signalThree&quot;</span>];
        [subscriber sendCompleted];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
    <span class="hljs-comment">//&#x62FC;&#x63A5;&#x4E86;&#x4E09;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x8BA2;&#x9605;&#x4E4B;&#x540E;&#xFF0C;&#x4E09;&#x4E2A;&#x4FE1;&#x53F7;&#x4F9D;&#x6B21;&#x6FC0;&#x6D3B;</span>
    RACSignal *concatSignal = [[signalOne concat:signalTwo] concat:signalThree];
    [concatSignal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:%@&quot;</span>,x);
    }];
}
<span class="hljs-comment">/*
2020-06-08 18:20:53.103639+0800 RACExample[52202:421372] &#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:signalOne
2020-06-08 18:20:53.103922+0800 RACExample[52202:421372] &#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:signalTwo
*/</span>
</code></pre>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x770B;&#x51FA;<code>signalOne-&gt;signalTwo-&gt;signalThree</code>&#x6309;&#x7167;&#x987A;&#x5E8F;&#x8FDE;&#x63A5;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x4FE1;&#x53F7;<code>signalTwo</code>&#x4E2D;&#x6CA1;&#x53D1;&#x9001;<code>sendCompleted</code>&#xFF0C;&#x6240;&#x4EE5;&#x540E;&#x9762;&#x7684;&#x4FE1;&#x53F7;<code>signalThree</code>&#x6CA1;&#x6709;&#x88AB;&#x6FC0;&#x6D3B;&#x3002;</p>
<pre><code class="lang-objc">RACSignal *signalTwo = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
    [subscriber sendNext:<span class="hljs-string">@&quot;signalTwo&quot;</span>];
    [subscriber sendCompleted];
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
}];
<span class="hljs-comment">/*
2020-06-08 18:23:40.588477+0800 RACExample[52340:423182] &#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:signalOne
2020-06-08 18:23:40.589093+0800 RACExample[52340:423182] &#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:signalTwo
2020-06-08 18:23:40.589539+0800 RACExample[52340:423182] &#x4FE1;&#x53F7;&#x88AB;&#x6FC0;&#x6D3B;:signalThree
*/</span>
</code></pre>
<h2 id="racobserve"><a name="racobserve" class="plugin-anchor" href="#racobserve"><i class="fa fa-link" aria-hidden="true"></i></a><a name="racobserve" class="anchor-navigation-ex-anchor" href="#racobserve"><i class="fa fa-link" aria-hidden="true"></i></a>3.20. RACObserve</h2>
<blockquote>
<p>RACObserve : KVO &#x76D1;&#x542C;&#x5C5E;&#x6027;&#x5185;&#x5BB9;&#x53D8;&#x5316;</p>
</blockquote>
<pre><code class="lang-objc">[RACObserve(<span class="hljs-keyword">self</span>.textLabel, text) subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;KVO &#x76D1;&#x542C;&#x5230; age &#x5185;&#x5BB9;&#x53D1;&#x751F;&#x53D8;&#x5316; &#xFF0C;&#x53D8;&#x4E3A; %@ , thread = %@&quot;</span>,x,[<span class="hljs-built_in">NSThread</span> currentThread]);
}];
</code></pre>
<h2 id="&#x5176;&#x4ED6;&#x4F7F;&#x7528;"><a name="&#x5176;&#x4ED6;&#x4F7F;&#x7528;" class="plugin-anchor" href="#&#x5176;&#x4ED6;&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5176;&#x4ED6;&#x4F7F;&#x7528;" class="anchor-navigation-ex-anchor" href="#&#x5176;&#x4ED6;&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>3.21. &#x5176;&#x4ED6;&#x4F7F;&#x7528;</h2>
<ul>
<li><code>replay&#x91CD;&#x653E;</code>&#xFF1A;&#x5F53;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x88AB;&#x591A;&#x6B21;&#x8BA2;&#x9605;,&#x53CD;&#x590D;&#x64AD;&#x653E;&#x5185;&#x5BB9;</li>
</ul>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="raccommand"><a name="raccommand" class="plugin-anchor" href="#raccommand"><i class="fa fa-link" aria-hidden="true"></i></a><a name="raccommand" class="anchor-navigation-ex-anchor" href="#raccommand"><i class="fa fa-link" aria-hidden="true"></i></a>4. RACCommand</h1>
<blockquote>
<p>RACCommand&#xFF1A;&#x5904;&#x7406;&#x4E8B;&#x4EF6;&#x7684;&#x64CD;&#x4F5C;,&#x548C;UI&#x5173;&#x8054;.(&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#x6267;&#x884C;)&#xFF0C;&#x6700;&#x5E38;&#x7528;&#x4E8E;&#x4E24;&#x4E2A;&#x5730;&#x65B9;&#xFF0C;&#x76D1;&#x542C;&#x6309;&#x94AE;&#x70B9;&#x51FB;&#xFF0C;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x3002;</p>
</blockquote>
<pre><code class="lang-objc"><span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) RACSignal&lt;RACSignal&lt;ValueType&gt; *&gt; *executionSignals;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) RACSignal&lt;<span class="hljs-built_in">NSNumber</span> *&gt; *executing;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) RACSignal&lt;<span class="hljs-built_in">NSNumber</span> *&gt; *enabled;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) RACSignal&lt;<span class="hljs-built_in">NSError</span> *&gt; *errors;
<span class="hljs-keyword">@property</span> (atomic, <span class="hljs-keyword">assign</span>) <span class="hljs-built_in">BOOL</span> allowsConcurrentExecution;

- (instancetype)initWithSignalBlock:(RACSignal&lt;ValueType&gt; * (^)(InputType _Nullable input))signalBlock;
<span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;RACCommand&#x7684;&#x5165;&#x53C2;enabledSignal&#x5C31;&#x51B3;&#x5B9A;&#x4E86;RACCommand&#x662F;&#x5426;&#x80FD;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x3002;&#x5165;&#x53C2;enabledSignal&#x5C31;&#x662F;&#x89E6;&#x53D1;&#x6761;&#x4EF6;&#x3002;</span>
- (instancetype)initWithEnabled:(nullable RACSignal&lt;<span class="hljs-built_in">NSNumber</span> *&gt; *)enabledSignal signalBlock:(RACSignal&lt;ValueType&gt; * (^)(InputType _Nullable input))signalBlock;
- (RACSignal&lt;ValueType&gt; *)execute:(nullable InputType)input;
</code></pre>
<p><code>executionSignals</code>:&#x662F;&#x4E00;&#x4E2A;&#x9AD8;&#x9636;&#x4FE1;&#x53F7;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x964D;&#x9636;&#x64CD;&#x4F5C;(<code>flatten</code>&#xFF0C;<code>switchToLatest</code>&#xFF0C;<code>concat</code>)&#xFF0C;&#x964D;&#x9636;&#x7684;&#x65B9;&#x5F0F;&#x6839;&#x636E;&#x9700;&#x6C42;&#x6765;&#x9009;&#x53D6;&#x3002;&#x4E00;&#x822C;&#x9009;&#x62E9;&#x7684;&#x539F;&#x5219;&#xFF1A;&#x4E00;&#x822C;&#x4E0D;&#x5141;&#x8BB8;&#x5E76;&#x53D1;(<code>dispatch_queue_concurrent</code>)&#x7684;<code>RACCommand</code>&#x4F7F;&#x7528;<code>switchToLatest</code>&#xFF0C;&#x5141;&#x8BB8;&#x5E76;&#x53D1;&#x7684;&#x4F7F;&#x7528;<code>flatten</code>&#x3002;</p>
<p><code>executing</code>:&#x8868;&#x793A;&#x4E86;&#x5F53;&#x524D;<code>RACCommand</code>&#x662F;&#x5426;&#x5728;&#x6267;&#x884C;&#xFF0C;&#x4FE1;&#x53F7;&#x91CC;&#x9762;&#x7684;&#x503C;&#x90FD;&#x662F;<code>BOOL</code>&#x7C7B;&#x578B;&#x7684;&#x3002;<code>YES</code>&#x8868;&#x793A;&#x7684;&#x662F;<code>RACCommand</code>&#x6B63;&#x5728;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x547D;&#x540D;&#x4E5F;&#x8BF4;&#x660E;&#x7684;&#x662F;&#x6B63;&#x5728;&#x8FDB;&#x884C;&#x65F6;ing&#x3002;<code>NO</code>&#x8868;&#x793A;&#x7684;&#x662F;<code>RACCommand</code>&#x6CA1;&#x6709;&#x88AB;&#x6267;&#x884C;&#x6216;&#x8005;&#x5DF2;&#x7ECF;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x3002;</p>
<p><code>enabled</code>: &#x4FE1;&#x53F7;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5F00;&#x5173;&#xFF0C;&#x5224;&#x65AD;<code>RACCommand</code>&#x662F;&#x5426;&#x53EF;&#x7528;:<br></p>
<ul>
<li><code>RACCommand</code> &#x521D;&#x59CB;&#x5316;&#x4F20;&#x5165;&#x7684;<code>enabledSignal</code>&#x4FE1;&#x53F7;&#xFF0C;&#x5982;&#x679C;&#x8FD4;&#x56DE;<code>NO</code>&#xFF0C;&#x90A3;&#x4E48;<code>enabled</code>&#x4FE1;&#x53F7;&#x5C31;&#x8FD4;&#x56DE;<code>NO</code>&#x3002;</li>
<li><code>RACCommand</code>&#x5F00;&#x59CB;&#x6267;&#x884C;&#x4E2D;&#xFF0C;<code>allowsConcurrentExecution</code>&#x4E3A;<code>NO</code>&#xFF0C;&#x90A3;&#x4E48;<code>enabled</code>&#x4FE1;&#x53F7;&#x5C31;&#x8FD4;&#x56DE;<code>NO</code>&#x3002;</li>
<li>&#x9664;&#x53BB;&#x4EE5;&#x4E0A;2&#x79CD;&#x60C5;&#x51B5;&#x4EE5;&#x5916;&#xFF0C;<code>enabled</code>&#x4FE1;&#x53F7;&#x57FA;&#x672C;&#x90FD;&#x662F;&#x8FD4;&#x56DE;YES&#x3002;</li>
</ul>
<p><code>errors</code>: &#x4FE1;&#x53F7;&#x5C31;&#x662F;<code>RACCommand</code>&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x4EA7;&#x751F;&#x7684;&#x9519;&#x8BEF;&#x4FE1;&#x53F7;&#x3002;</p>
<blockquote>
<p>&#x5728;&#x5BF9;<code>RACCommand</code>&#x8FDB;&#x884C;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;<code>subscribeError:</code>&#x5BF9;<code>RACCommand</code>&#x7684;<code>executionSignals</code> &#x8FDB;&#x884C;&#x9519;&#x8BEF;&#x7684;&#x8BA2;&#x9605;&#xFF0C;&#x56E0;&#x4E3A;<code>executionSignals</code>&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x662F;&#x4E0D;&#x4F1A;&#x53D1;&#x9001;<code>error</code>&#x4E8B;&#x4EF6;&#x7684;&#x3002;</p>
</blockquote>
<pre><code class="lang-objc"><span class="hljs-comment">// &#x7528;subscribeNext:&#x53BB;&#x8BA2;&#x9605;&#x9519;&#x8BEF;&#x4FE1;&#x53F7;&#x3002;</span>
[commandSignal.errors subscribeNext:^(<span class="hljs-built_in">NSError</span> *x) {     
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;ERROR! --&gt; %@&quot;</span>,x);
}];
</code></pre>
<p><code>allowsConcurrentExecution</code>: &#x7528;&#x6765;&#x8868;&#x793A;&#x5F53;&#x524D;<code>RACCommand</code>&#x662F;&#x5426;&#x5141;&#x8BB8;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x3002;&#x9ED8;&#x8BA4;&#x503C;&#x662F;<code>NO</code>&#x3002;&#x6309;&#x7167;&#x4E0A;&#x9762;&#x8BF4;&#x7684;&#x5219;<code>enabled</code>&#x7684;&#x503C;&#x4E5F;&#x4F1A;&#x4E3A;<code>NO</code>&#x3002;</p>
<p><code>allowsConcurrentExecution</code>&#x5728;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x4E2D;&#x662F;&#x7528;&#x7684;<code>volatile</code>&#x539F;&#x5B50;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5728;&#x5B9E;&#x73B0;&#x4E2D;&#x91CD;&#x5199;&#x4E86;&#x5B83;&#x7684;get&#x548C;set&#x65B9;&#x6CD5;&#x3002;</p>
<pre><code class="lang-objc"><span class="hljs-comment">// &#x91CD;&#x5199; get&#x65B9;&#x6CD5;</span>
- (<span class="hljs-built_in">BOOL</span>)allowsConcurrentExecution {
    <span class="hljs-keyword">return</span> _allowsConcurrentExecution != <span class="hljs-number">0</span>;
}

<span class="hljs-comment">// &#x91CD;&#x5199; set&#x65B9;&#x6CD5;</span>
- (<span class="hljs-keyword">void</span>)setAllowsConcurrentExecution:(<span class="hljs-built_in">BOOL</span>)allowed {
    [<span class="hljs-keyword">self</span> willChangeValueForKey:@keypath(<span class="hljs-keyword">self</span>.allowsConcurrentExecution)];

    <span class="hljs-keyword">if</span> (allowed) {
        <span class="hljs-comment">// OSAtomicOr32Barrier&#x662F;&#x539F;&#x5B50;&#x8FD0;&#x7B97;&#xFF0C;&#x5B83;&#x7684;&#x610F;&#x4E49;&#x662F;&#x8FDB;&#x884C;&#x903B;&#x8F91;&#x7684;&#x201C;&#x6216;&#x201D;&#x8FD0;&#x7B97;&#x3002;&#x901A;&#x8FC7;&#x539F;&#x5B50;&#x6027;&#x64CD;&#x4F5C;&#x8BBF;&#x95EE;&#x88AB;volatile&#x4FEE;&#x9970;&#x7684;_allowsConcurrentExecution&#x5BF9;&#x8C61;&#x5373;&#x53EF;&#x4FDD;&#x969C;&#x51FD;&#x6570;&#x53EA;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x3002;</span>
        OSAtomicOr32Barrier(<span class="hljs-number">1</span>, &amp;_allowsConcurrentExecution);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// OSAtomicAnd32Barrier&#x662F;&#x539F;&#x5B50;&#x8FD0;&#x7B97;&#xFF0C;&#x5B83;&#x7684;&#x610F;&#x4E49;&#x662F;&#x8FDB;&#x884C;&#x903B;&#x8F91;&#x7684;&#x201C;&#x4E0E;&#x201D;&#x8FD0;&#x7B97;&#x3002;</span>
        OSAtomicAnd32Barrier(<span class="hljs-number">0</span>, &amp;_allowsConcurrentExecution);
    }

    [<span class="hljs-keyword">self</span> didChangeValueForKey:@keypath(<span class="hljs-keyword">self</span>.allowsConcurrentExecution)];
}
</code></pre>
<p><code>initWithSignalBlock:</code>&#x4E0E;<code>initWithEnabled:signalBlock:</code>&#x7684;&#x533A;&#x522B;&#xFF1A;</p>
<pre><code class="lang-objc">- (instancetype)initWithSignalBlock:(RACSignal&lt;<span class="hljs-keyword">id</span>&gt; * (^)(<span class="hljs-keyword">id</span> input))signalBlock {
    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">self</span> initWithEnabled:<span class="hljs-literal">nil</span> signalBlock:signalBlock];<span class="hljs-comment">// nil &#x76F8;&#x5F53;&#x4E8E;&#xFF1A;[RACSignal return:@YES]</span>
}
</code></pre>
<h2 id="&#x4F7F;&#x7528;"><a name="&#x4F7F;&#x7528;" class="plugin-anchor" href="#&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4F7F;&#x7528;" class="anchor-navigation-ex-anchor" href="#&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>4.1. &#x4F7F;&#x7528;</h2>
<pre><code class="lang-objc">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal * _Nonnull(<span class="hljs-built_in">NSNumber</span> * _Nullable input) {
    <span class="hljs-keyword">return</span> [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;%@&quot;</span>,input);<span class="hljs-comment">//2</span>
        [subscriber sendNext:input];
        [subscriber sendError:[<span class="hljs-built_in">NSError</span> errorWithDomain:<span class="hljs-string">@&quot;&quot;</span> code:<span class="hljs-number">0</span> userInfo:@{<span class="hljs-built_in">NSLocalizedDescriptionKey</span>:<span class="hljs-string">@&quot;----&quot;</span>}]];
        [subscriber sendCompleted];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
}];
[command.executionSignals subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {

    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x6536;&#x5230;&#x4FE1;&#x53F7;(subscribeNext)&#xFF1A;%@&quot;</span>,x);<span class="hljs-comment">// &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x628A;&#x5904;&#x7406;&#x4E8B;&#x4EF6;(&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x3001;&#x903B;&#x8F91;&#x5904;&#x7406;)&#x4E4B;&#x524D;&#x7684;&#x903B;&#x8F91;(showHUD...)&#x653E;&#x5230;&#x8FD9;&#x3002;</span>

    [x subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;x-&#x6536;&#x5230;&#x4FE1;&#x53F7;(subscribeNext)&#xFF1A;%@&quot;</span>,x);<span class="hljs-comment">// &#x6536;&#x5230;&#x4FE1;&#x53F7;B&#xFF1A;1</span>
    } error:^(<span class="hljs-built_in">NSError</span> * _Nullable error) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;x-&#x6536;&#x5230;&#x4FE1;&#x53F7;(error)&#xFF1A;%@&quot;</span>,x);<span class="hljs-comment">//&#x6536;&#x4E0D;&#x5230;error&#xFF0C;&#x56E0;&#x4E3A; executionSignals &#x4E0D;&#x4F1A;&#x5904;&#x7406; error</span>
    } completed:^{
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;x-&#x6536;&#x5230;&#x4FE1;&#x53F7;(completed)&quot;</span>);
    }];

} error:^(<span class="hljs-built_in">NSError</span> * _Nullable error) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x6536;&#x5230;&#x4FE1;&#x53F7;(error)&#xFF1A;%@&quot;</span>,error.localizedDescription);<span class="hljs-comment">//&#x6536;&#x4E0D;&#x5230;error&#xFF0C;&#x56E0;&#x4E3A; executionSignals &#x4E0D;&#x4F1A;&#x5904;&#x7406; error</span>
} completed:^{
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x6536;&#x5230;&#x4FE1;&#x53F7;(completed)&quot;</span>);
}];
[command execute:@<span class="hljs-number">1</span>];
<span class="hljs-comment">/*
&#x6536;&#x5230;&#x4FE1;&#x53F7;(subscribeNext)&#xFF1A;&lt;RACDynamicSignal: 0x60000318f5a0&gt; name: 
&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;1
x-&#x6536;&#x5230;&#x4FE1;&#x53F7;(subscribeNext)&#xFF1A;1
x-&#x6536;&#x5230;&#x4FE1;&#x53F7;(completed)
&#x6536;&#x5230;&#x4FE1;&#x53F7;(completed)
*/</span>
</code></pre>
<p>&#x6362;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#xFF1A;</p>
<pre><code class="lang-objc">RACCommand *command = [[RACCommand alloc] initWithSignalBlock:^RACSignal * _Nonnull(<span class="hljs-built_in">NSNumber</span> * _Nullable input) {
    <span class="hljs-keyword">return</span> [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;%@&quot;</span>,input);<span class="hljs-comment">//2</span>
        [subscriber sendNext:input];
        [subscriber sendError:[<span class="hljs-built_in">NSError</span> errorWithDomain:<span class="hljs-string">@&quot;&quot;</span> code:<span class="hljs-number">0</span> userInfo:@{<span class="hljs-built_in">NSLocalizedDescriptionKey</span>:<span class="hljs-string">@&quot;----&quot;</span>}]];
        [subscriber sendCompleted];
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
    }];
}];
<span class="hljs-comment">// &#x901A;&#x8FC7; switchToLatest &#x628A;&#x9AD8;&#x9636;&#x4FE1;&#x53F7;&#x964D;&#x9636;&#x5904;&#x7406;&#x3002;</span>
[[command.executionSignals switchToLatest] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x6536;&#x5230;&#x4FE1;&#x53F7;(switchToLatest)&#xFF1A;%@&quot;</span>,x);
}];
[command.errors subscribeNext:^(<span class="hljs-built_in">NSError</span> * _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x6536;&#x5230;&#x4FE1;&#x53F7;(errors)&#xFF1A;%@&quot;</span>,x.localizedDescription);
}];
[command.executing subscribeNext:^(<span class="hljs-built_in">NSNumber</span> * _Nullable x) {
    <span class="hljs-keyword">if</span>([x boolValue] == <span class="hljs-literal">YES</span>){
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RACCommand&#x547D;&#x4EE4;&#x6B63;&#x5728;&#x6267;&#x884C;...&quot;</span>);
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RACCommand&#x547D;&#x4EE4;&#x4E0D;&#x5728;&#x6267;&#x884C;&#x4E2D;&#xFF01;&#xFF01;&#xFF01;&quot;</span>);
    }
}];
[command execute:@<span class="hljs-number">1</span>];
<span class="hljs-comment">/*
RACCommand&#x547D;&#x4EE4;&#x4E0D;&#x5728;&#x6267;&#x884C;&#x4E2D;&#xFF01;&#xFF01;&#xFF01;
RACCommand&#x547D;&#x4EE4;&#x6B63;&#x5728;&#x6267;&#x884C;...     &lt;==== &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x628A;&#x5904;&#x7406;&#x4E8B;&#x4EF6;(&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x3001;&#x903B;&#x8F91;&#x5904;&#x7406;)&#x4E4B;&#x524D;&#x7684;&#x903B;&#x8F91;(showHUD...)&#x653E;&#x5230;&#x8FD9;&#x3002;
&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;1
&#x6536;&#x5230;&#x4FE1;&#x53F7;(switchToLatest)&#xFF1A;1
&#x6536;&#x5230;&#x4FE1;&#x53F7;(errors)&#xFF1A;----
RACCommand&#x547D;&#x4EE4;&#x4E0D;&#x5728;&#x6267;&#x884C;&#x4E2D;&#xFF01;&#xFF01;&#xFF01;
*/</span>
</code></pre>
<p>&#x6211;&#x4EEC;&#x5BF9;<code>executing</code>&#x8FDB;&#x884C;&#x4E00;&#x4E0B;&#x5904;&#x7406;&#xFF0C;&#x53BB;&#x6389;&#x65E0;&#x7528;&#x7684;&#x89E6;&#x53D1;&#x3002;</p>
<pre><code class="lang-objc">[[[command.executing skip:<span class="hljs-number">1</span>] take:<span class="hljs-number">1</span>] subscribeNext:^(<span class="hljs-built_in">NSNumber</span> * _Nullable x) {
    <span class="hljs-keyword">if</span>([x boolValue] == <span class="hljs-literal">YES</span>){
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RACCommand&#x547D;&#x4EE4;&#x6B63;&#x5728;&#x6267;&#x884C;...&quot;</span>);
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RACCommand&#x547D;&#x4EE4;&#x4E0D;&#x5728;&#x6267;&#x884C;&#x4E2D;&#xFF01;&#xFF01;&#xFF01;&quot;</span>);
    }
}];
<span class="hljs-comment">/*
2020-06-08 17:00:00.488046+0800 RACExample[49056:380458] RACCommand&#x547D;&#x4EE4;&#x6B63;&#x5728;&#x6267;&#x884C;...
2020-06-08 17:00:00.488513+0800 RACExample[49056:380458] &#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;1
2020-06-08 17:00:00.488740+0800 RACExample[49056:380458] &#x6536;&#x5230;&#x4FE1;&#x53F7;(switchToLatest)&#xFF1A;1
2020-06-08 17:00:00.489372+0800 RACExample[49056:380458] &#x6536;&#x5230;&#x4FE1;&#x53F7;(errors)&#xFF1A;----
*/</span>
</code></pre>
<p>&#x6216;&#x8005;&#x76F4;&#x63A5;&#x8BA2;&#x9605;&#x4FE1;&#x53F7;&#xFF1A;</p>
<pre><code class="lang-objc">[[command execute:@<span class="hljs-number">1</span>] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x63A5;&#x6536;&#x4FE1;&#x53F7;(subscribeNext)&#xFF1A;%@&quot;</span>,x);
} error:^(<span class="hljs-built_in">NSError</span> * _Nullable error) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x63A5;&#x6536;&#x4FE1;&#x53F7;(error)&#xFF1A;%@&quot;</span>,error.localizedDescription);
} completed:^{
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x63A5;&#x6536;&#x4FE1;&#x53F7;(completed)&quot;</span>);
}];
<span class="hljs-comment">/*
&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;1
&#x63A5;&#x6536;&#x4FE1;&#x53F7;(subscribeNext)&#xFF1A;1
&#x63A5;&#x6536;&#x4FE1;&#x53F7;(error)&#xFF1A;----
*/</span>
</code></pre>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="racchannel"><a name="racchannel" class="plugin-anchor" href="#racchannel"><i class="fa fa-link" aria-hidden="true"></i></a><a name="racchannel" class="anchor-navigation-ex-anchor" href="#racchannel"><i class="fa fa-link" aria-hidden="true"></i></a>5. RACChannel</h1>
<h2 id="racchannel&#x5B9E;&#x73B0;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;"><a name="racchannel&#x5B9E;&#x73B0;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;" class="plugin-anchor" href="#racchannel&#x5B9E;&#x73B0;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="racchannel&#x5B9E;&#x73B0;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;" class="anchor-navigation-ex-anchor" href="#racchannel&#x5B9E;&#x73B0;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;"><i class="fa fa-link" aria-hidden="true"></i></a>5.1. RACChannel&#x5B9E;&#x73B0;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;</h2>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="foundation"><a name="foundation" class="plugin-anchor" href="#foundation"><i class="fa fa-link" aria-hidden="true"></i></a><a name="foundation" class="anchor-navigation-ex-anchor" href="#foundation"><i class="fa fa-link" aria-hidden="true"></i></a>6. Foundation</h1>
<p>&#x6D89;&#x53CA;<code>Foundation</code>&#x76F8;&#x5173;&#x7684;RAC&#x5206;&#x7C7B;:<code>NSArray</code>&#x3001;<code>NSData</code>&#x3001;<code>NSDictionary</code>&#x3001;<code>NSEnumerator</code>&#x3001;<code>NSFileHandle</code>&#x3001;<code>NSIndexSet</code>&#x3001;<code>NSInvocation</code>&#x3001;<code>NSNotificationCenter</code>&#x3001;<code>NSObject</code>&#x3001;<code>NSOrderedSet</code>&#x3001;<code>NSSet</code>&#x3001;<code>NSString</code>&#x3001;<code>NSURLConnection</code>&#x3001;<code>NSUserDefaults</code>&#x3002;</p>
<pre><code>NSArray+RACSequenceAdditions.h
NSData+RACSupport.h
NSDictionary+RACSequenceAdditions.h
NSEnumerator+RACSequenceAdditions.h
NSFileHandle+RACSupport.h
NSIndexSet+RACSequenceAdditions.h
NSInvocation+RACTypeParsing.h
NSNotificationCenter+RACSupport.h
NSObject+RACDeallocating.h
NSObject+RACDescription.h
NSObject+RACKVOWrapper.h
NSObject+RACLifting.h
NSObject+RACPropertySubscribing.h
NSObject+RACSelectorSignal.h
NSOrderedSet+RACSequenceAdditions.h
NSSet+RACSequenceAdditions.h
NSString+RACKeyPathUtilities.h
NSString+RACSequenceAdditions.h
NSString+RACSupport.h
NSURLConnection+RACSupport.h
NSUserDefaults+RACSupport.h
</code></pre><h2 id="nsobject"><a name="nsobject" class="plugin-anchor" href="#nsobject"><i class="fa fa-link" aria-hidden="true"></i></a><a name="nsobject" class="anchor-navigation-ex-anchor" href="#nsobject"><i class="fa fa-link" aria-hidden="true"></i></a>6.1. NSObject</h2>
<pre><code>NSObject+RACDeallocating.h
NSObject+RACDescription.h
NSObject+RACKVOWrapper.h
NSObject+RACLifting.h
NSObject+RACPropertySubscribing.h
NSObject+RACSelectorSignal.h
</code></pre><h3 id="nsobjectraclifting"><a name="nsobjectraclifting" class="plugin-anchor" href="#nsobjectraclifting"><i class="fa fa-link" aria-hidden="true"></i></a><a name="nsobjectraclifting" class="anchor-navigation-ex-anchor" href="#nsobjectraclifting"><i class="fa fa-link" aria-hidden="true"></i></a>6.1.1. NSObject+RACLifting</h3>
<blockquote>
<p>&#x7B49;&#x5F85;&#x6210;&#x6240;&#x6709;&#x7684; RACSignal &#x5BF9;&#x8C61;&#x53D1;&#x9001;&#x5B8C;&#x4FE1;&#x53F7;&#x518D;&#x6267;&#x884C;&#x65B9;&#x6CD5;) (&#x4E3B;&#x7A0B;&#x4E2D;&#x6267;&#x884C;)</p>
</blockquote>
<pre><code class="lang-objc">- (RACSignal *)rac_liftSelector:(SEL)selector withSignals:(RACSignal *)firstSignal, ... <span class="hljs-built_in">NS_REQUIRES_NIL_TERMINATION</span>;
- (RACSignal *)rac_liftSelector:(SEL)selector withSignalsFromArray:(<span class="hljs-built_in">NSArray</span>&lt;RACSignal *&gt; *)signals;
- (RACSignal *)rac_liftSelector:(SEL)selector withSignalOfArguments:(RACSignal&lt;RACTuple *&gt; *)arguments;
</code></pre>
<pre><code class="lang-objc">- (<span class="hljs-keyword">IBAction</span>)test_rac_lift:(<span class="hljs-keyword">id</span>)sender {
    RACSignal * signalOne = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-comment">// &#x73B0;&#x5728;&#x60F3;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#x4E86;</span>
        [subscriber sendNext:<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x6570;&#x636E; 1&quot;</span>];
        <span class="hljs-comment">// &#x4E0D;&#x9700;&#x8981;&#x91CA;&#x653E;&#x64CD;&#x4F5C;</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span> ;
    }];

    RACSignal * signalTwo = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-comment">// &#x73B0;&#x5728;&#x60F3;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#x4E86;</span>
        [subscriber sendNext:<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x6570;&#x636E; 2&quot;</span>];
        <span class="hljs-comment">// &#x4E0D;&#x9700;&#x8981;&#x91CA;&#x653E;&#x64CD;&#x4F5C;</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span> ;
    }];
    [<span class="hljs-keyword">self</span> rac_liftSelector:<span class="hljs-keyword">@selector</span>(update<span class="hljs-built_in">UIWithSignalOneMessage</span>:signalTwoMessage:) withSignalsFromArray:@[signalOne,signalTwo]];
}
<span class="hljs-comment">// &#x5F53;&#x6240;&#x6709;&#x6570;&#x636E;&#x90FD;&#x62FF;&#x5230;&#x624B;&#x540E;&#x66F4;&#x65B0;UI , &#x4F20;&#x7684;&#x6570;&#x636E;&#x5C31;&#x662F; signalOne &#x548C; signalTwo &#x53D1;&#x51FA;&#x6765;&#x7684;&#x4FE1;&#x53F7;&#x6570;&#x636E; &#xFF0C;(&#x6240;&#x4EE5;&#x5F53;&#x524D;&#x8BBE;&#x8BA1;&#x7684;&#x63A5;&#x6536;&#x65B9;&#x6CD5; &#x4E5F;&#x5FC5;&#x9700;&#x8981;&#x6709;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x53D1;&#x51FA;&#x7684;&#x4FE1;&#x53F7;&#x6309;&#x987A;&#x5E8F; &#x4F20;&#x53C2;)</span>
<span class="hljs-comment">// &#x5047;&#x5982;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#x65B9;&#x6CD5;&#x53EA;&#x8BBE;&#x8BA1; &#x4F20;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x5D29;&#x6E83;</span>
-(<span class="hljs-keyword">void</span>)update<span class="hljs-built_in">UIWithSignalOneMessage</span>:(<span class="hljs-keyword">id</span>)signalOneMessage signalTwoMessage:(<span class="hljs-keyword">id</span>)signalTwoMessage{
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;signalOneMessage = %@ , signalTwoMessage = %@ , thread = %@&quot;</span>,signalOneMessage,signalTwoMessage,[<span class="hljs-built_in">NSThread</span> currentThread]);
}
<span class="hljs-comment">//signalOneMessage = &#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x6570;&#x636E; 1 , signalTwoMessage = &#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x6570;&#x636E; 2 , thread = &lt;NSThread: 0x600002f704c0&gt;{number = 1, name = main}</span>
</code></pre>
<h2 id="nsnotificationcenter"><a name="nsnotificationcenter" class="plugin-anchor" href="#nsnotificationcenter"><i class="fa fa-link" aria-hidden="true"></i></a><a name="nsnotificationcenter" class="anchor-navigation-ex-anchor" href="#nsnotificationcenter"><i class="fa fa-link" aria-hidden="true"></i></a>6.2. NSNotificationCenter</h2>
<blockquote>
<p>RAC &#x628A;&#x76D1;&#x542C;&#x901A;&#x77E5;&#x7684;&#x65B9;&#x6CD5;&#x6539;&#x6210;&#x4E86; block &#x5F62;&#x5F0F;</p>
</blockquote>
<pre><code class="lang-objc"><span class="hljs-comment">// NSNotificationCenter+RACSupport.h</span>

- (RACSignal&lt;<span class="hljs-built_in">NSNotification</span> *&gt; *)rac_addObserverForName:(nullable <span class="hljs-built_in">NSString</span> *)notificationName object:(nullable <span class="hljs-keyword">id</span>)object;
</code></pre>
<pre><code class="lang-objc">- (<span class="hljs-keyword">IBAction</span>)test_rac_addObserverForName:(<span class="hljs-keyword">id</span>)sender {
    [[[<span class="hljs-built_in">NSNotificationCenter</span> defaultCenter] rac_addObserverForName:<span class="hljs-built_in">UIKeyboardDidHideNotification</span> object:<span class="hljs-literal">nil</span>] subscribeNext:^(<span class="hljs-built_in">NSNotification</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;NSNotification 1 x = %@&quot;</span>,x.userInfo);
    }];
    [[[<span class="hljs-built_in">NSNotificationCenter</span> defaultCenter] rac_addObserverForName:<span class="hljs-built_in">UIKeyboardDidHideNotification</span> object:<span class="hljs-literal">nil</span>] subscribeNext:^(<span class="hljs-built_in">NSNotification</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;NSNotification 2 x = %@&quot;</span>,x.userInfo);
    }];
    [[<span class="hljs-built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:<span class="hljs-built_in">UIKeyboardDidHideNotification</span> object:<span class="hljs-literal">nil</span>];

    <span class="hljs-comment">// NSNotification 1 x = (null)</span>
    <span class="hljs-comment">// NSNotification 2 x = (null)</span>
}
</code></pre>
<h2 id="nsstring"><a name="nsstring" class="plugin-anchor" href="#nsstring"><i class="fa fa-link" aria-hidden="true"></i></a><a name="nsstring" class="anchor-navigation-ex-anchor" href="#nsstring"><i class="fa fa-link" aria-hidden="true"></i></a>6.3. NSString</h2>
<pre><code>NSString+RACKeyPathUtilities.h
NSString+RACSequenceAdditions.h
NSString+RACSupport.h
</code></pre><!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="uikit"><a name="uikit" class="plugin-anchor" href="#uikit"><i class="fa fa-link" aria-hidden="true"></i></a><a name="uikit" class="anchor-navigation-ex-anchor" href="#uikit"><i class="fa fa-link" aria-hidden="true"></i></a>7. UIKit</h1>
<p>&#x6D89;&#x53CA;<code>UIKit</code>&#x76F8;&#x5173;&#x7684;RAC&#x5206;&#x7C7B;&#xFF1A;<code>UIActionSheet</code>&#x3001;<code>UIAlertView</code>&#x3001;<code>UIBarButtonItem</code>&#x3001;<code>UIButton</code>&#x3001;<code>UICollectionReusableView</code>&#x3001;<code>UIControl</code>&#x3001;<code>UIControl</code>&#x3001;<code>UIDatePicker</code>&#x3001;<code>UIGestureRecognizer</code>&#x3001;<code>UIImagePickerController</code>&#x3001;<code>UIRefreshControl</code>&#x3001;<code>UISegmentedControl</code>&#x3001;<code>UISlider</code>&#x3001;<code>UIStepper</code>&#x3001;<code>UISwitch</code>&#x3001;<code>UITableViewCell</code>&#x3001;<code>UITableViewHeaderFooterView</code>&#x3001;<code>UITextField</code>&#x3001;<code>UITextView</code>&#x3002;</p>
<pre><code>UIActionSheet+RACSignalSupport.h
UIAlertView+RACSignalSupport.h
UIBarButtonItem+RACCommandSupport.h
UIButton+RACCommandSupport.h
UICollectionReusableView+RACSignalSupport.h
UIControl+RACSignalSupport.h
UIControl+RACSignalSupportPrivate.h
UIDatePicker+RACSignalSupport.h
UIGestureRecognizer+RACSignalSupport.h
UIImagePickerController+RACSignalSupport.h
UIRefreshControl+RACCommandSupport.h
UISegmentedControl+RACSignalSupport.h
UISlider+RACSignalSupport.h
UIStepper+RACSignalSupport.h
UISwitch+RACSignalSupport.h
UITableViewCell+RACSignalSupport.h
UITableViewHeaderFooterView+RACSignalSupport.h
UITextField+RACSignalSupport.h
UITextView+RACSignalSupport.h
</code></pre><h2 id="uicontrolracsignalsupportprivate"><a name="uicontrolracsignalsupportprivate" class="plugin-anchor" href="#uicontrolracsignalsupportprivate"><i class="fa fa-link" aria-hidden="true"></i></a><a name="uicontrolracsignalsupportprivate" class="anchor-navigation-ex-anchor" href="#uicontrolracsignalsupportprivate"><i class="fa fa-link" aria-hidden="true"></i></a>7.1. UIControl+RACSignalSupportPrivate</h2>
<pre><code class="lang-objc">- (RACChannelTerminal *)rac_channelForControlEvents:(<span class="hljs-built_in">UIControlEvents</span>)controlEvents key:(<span class="hljs-built_in">NSString</span> *)key nilValue:(nullable <span class="hljs-keyword">id</span>)nilValue;
</code></pre>
<pre><code class="lang-ojbc">// &#x6309;&#x94AE;&#x70B9;&#x51FB;&#x54CD;&#x5E94;
[[self.loginButton rac_signalForControlEvents:UIControlEventTouchUpInside] subscribeNext:^(__kindof UIControl * _Nullable x) { 
}];
</code></pre>
<h2 id="uitextfieldracsignalsupport"><a name="uitextfieldracsignalsupport" class="plugin-anchor" href="#uitextfieldracsignalsupport"><i class="fa fa-link" aria-hidden="true"></i></a><a name="uitextfieldracsignalsupport" class="anchor-navigation-ex-anchor" href="#uitextfieldracsignalsupport"><i class="fa fa-link" aria-hidden="true"></i></a>7.2. UITextField+RACSignalSupport</h2>
<pre><code class="lang-objc">- (RACSignal&lt;<span class="hljs-built_in">NSString</span> *&gt; *)rac_textSignal;
- (RACChannelTerminal&lt;<span class="hljs-built_in">NSString</span> *&gt; *)rac_newTextChannel;
</code></pre>
<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    @weakify(<span class="hljs-keyword">self</span>)
    [[<span class="hljs-keyword">self</span>.textField rac_textSignal] subscribeNext:^(<span class="hljs-built_in">NSString</span> * _Nullable x) {
        @strongify(<span class="hljs-keyword">self</span>)
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;text = %@ , textField.text = %@ , thread = %@&quot;</span>,x,<span class="hljs-keyword">self</span>.textField.text,[<span class="hljs-built_in">NSThread</span> currentThread]);
    }];
    RAC(<span class="hljs-keyword">self</span>.textLabel,text) = <span class="hljs-keyword">self</span>.textField.rac_textSignal;
}
</code></pre>
<p><img src="../assets/images/iOS/rac/01.gif"></p>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="&#x4FE1;&#x53F7;&#x76F8;&#x5173;&#x7C7B;"><a name="&#x4FE1;&#x53F7;&#x76F8;&#x5173;&#x7C7B;" class="plugin-anchor" href="#&#x4FE1;&#x53F7;&#x76F8;&#x5173;&#x7C7B;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4FE1;&#x53F7;&#x76F8;&#x5173;&#x7C7B;" class="anchor-navigation-ex-anchor" href="#&#x4FE1;&#x53F7;&#x76F8;&#x5173;&#x7C7B;"><i class="fa fa-link" aria-hidden="true"></i></a>8. &#x4FE1;&#x53F7;&#x76F8;&#x5173;&#x7C7B;</h1>
<pre><code>RACDynamicSignal.h
RACEmptySignal.h
RACErrorSignal.h
RACGroupedSignal.h
RACReturnSignal.h
RACSignal+Operations.h
RACSignal.h
RACSignalProvider.d
RACSignalSequence.h
</code></pre><!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="disposable"><a name="disposable" class="plugin-anchor" href="#disposable"><i class="fa fa-link" aria-hidden="true"></i></a><a name="disposable" class="anchor-navigation-ex-anchor" href="#disposable"><i class="fa fa-link" aria-hidden="true"></i></a>9. Disposable</h1>
<ul>
<li><code>NSObject</code> : <code>rac_deallocDisposable</code></li>
<li><code>NSObject</code> : <code>rac_willDeallocSignal</code></li>
<li><code>UITableViewCell</code> : <code>rac_prepareForReuseSignal</code></li>
</ul>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="tips"><a name="tips" class="plugin-anchor" href="#tips"><i class="fa fa-link" aria-hidden="true"></i></a><a name="tips" class="anchor-navigation-ex-anchor" href="#tips"><i class="fa fa-link" aria-hidden="true"></i></a>10. Tips</h1>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">HomeViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">copy</span>) <span class="hljs-built_in">NSString</span> *searchConditons;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) RACSignal  *searchBtnEnableSignal;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">HomeViewModel</span></span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> setUp];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
- (<span class="hljs-keyword">void</span>)setUp{
    [<span class="hljs-keyword">self</span> setupSearchBtnEnableSignal];
}
- (<span class="hljs-keyword">void</span>)setupSearchBtnEnableSignal {
    _searchBtnEnableSignal = [RACSignal combineLatest:@[RACObserve(<span class="hljs-keyword">self</span>, searchConditons)] reduce:^<span class="hljs-keyword">id</span>(<span class="hljs-built_in">NSString</span> *searchConditions){
        <span class="hljs-keyword">return</span> @(searchConditions.length);
    }];
}
<span class="hljs-keyword">@end</span>

<span class="hljs-comment">// =====================================================</span>

<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">MovieViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) RACCommand *requestCommand;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">copy</span>, <span class="hljs-keyword">readonly</span>) <span class="hljs-built_in">NSArray</span> *movies;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">MovieViewModel</span></span>

-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> setup];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
- (<span class="hljs-keyword">void</span>)setup {
    _requestCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal * _Nonnull(<span class="hljs-keyword">id</span>  _Nullable input) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;%@&quot;</span>, input);
        RACSignal *requestSignal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
            NetworkManager *manager = [NetworkManager manager];
            [manager getDataWithUrl:<span class="hljs-string">@&quot;https://api.douban.com/v2/movie/search&quot;</span> parameters:input success:^(<span class="hljs-keyword">id</span> json) {
                [subscriber sendNext:json];
                [subscriber sendCompleted];
            } failure:^(<span class="hljs-built_in">NSError</span> *error) {

            }];

            <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
        }];
        <span class="hljs-keyword">return</span> [requestSignal map:^<span class="hljs-keyword">id</span> _Nullable(<span class="hljs-keyword">id</span>  _Nullable value) {
            <span class="hljs-built_in">NSMutableArray</span> *dictArray = value[<span class="hljs-string">@&quot;subjects&quot;</span>];
            <span class="hljs-built_in">NSArray</span> *modelArray = [dictArray.rac_sequence map:^<span class="hljs-keyword">id</span>(<span class="hljs-keyword">id</span> value) {
                <span class="hljs-keyword">return</span> [Movie movieWithDict:value];
            }].array;
           <span class="hljs-built_in">NSSortDescriptor</span> *sortDescriptor = [<span class="hljs-built_in">NSSortDescriptor</span> sortDescriptorWithKey:<span class="hljs-string">@&quot;year&quot;</span> ascending:<span class="hljs-literal">NO</span>];
            _movies = [modelArray sortedArrayUsingDescriptors:@[sortDescriptor]];
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;%@&quot;</span>,_movies.description);

            <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
        }];
    }];
}
<span class="hljs-keyword">@end</span>
</code></pre>
<p>&#x5728;&#x4E24;&#x4E2A;VM&#x4E2D;&#xFF0C;&#x4E00;&#x4E2A;&#x7528;&#x7684;&#x662F;<code>RACSignal</code>&#xFF0C;&#x4E00;&#x4E2A;&#x7528;&#x7684;&#x662F;<code>RACCommand</code>&#xFF1A;</p>
<ul>
<li><code>RACSignal</code>&#x662F;&#x5355;&#x5411;&#x7684;&#xFF0C;&#x5C31;&#x50CF;1&#x4E2A;&#x4EBA;&#x5728;&#x505A;&#x6F14;&#x8BB2;&#xFF0C;&#x89C2;&#x4F17;&#x542C;&#x5230;&#x5C31;&#x7ED3;&#x675F;&#x4E86;</li>
<li><code>RACCommand</code>&#x662F;&#x53CC;&#x5411;&#x7684;&#xFF0C;&#x6F14;&#x8BB2;&#x8005;&#x505A;&#x6F14;&#x8BB2;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x89C2;&#x4F17;&#x542C;&#x5230;&#x540E;&#x8FD8;&#x53CD;&#x9988;&#x4E86;&#x610F;&#x89C1;&#xFF0C;&#x800C;&#x6F14;&#x8BB2;&#x8005;&#x5BF9;&#x53CD;&#x9988;&#x8FD8;&#x505A;&#x4E86;&#x56DE;&#x590D;&#x3002;(V&#x4E2D;&#x53D1;&#x51FA;&#x547D;&#x4EE4;&#xFF0C;VM&#x6536;&#x5230;&#x547D;&#x4EE4;&#x540E;&#x8FDB;&#x884C;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x5C06;&#x83B7;&#x53D6;&#x7684;&#x7F51;&#x7EDC;&#x6570;&#x636E;&#x5305;&#x53D1;&#x9001;&#x51FA;&#x53BB;&#xFF0C;V&#x5BF9;&#x6536;&#x5230;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#x548C;&#x663E;&#x793A;)&#x3002;</li>
</ul>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="racmvvm&#x5F00;&#x53D1;&#x89C4;&#x7EA6;"><a name="racmvvm&#x5F00;&#x53D1;&#x89C4;&#x7EA6;" class="plugin-anchor" href="#racmvvm&#x5F00;&#x53D1;&#x89C4;&#x7EA6;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="racmvvm&#x5F00;&#x53D1;&#x89C4;&#x7EA6;" class="anchor-navigation-ex-anchor" href="#racmvvm&#x5F00;&#x53D1;&#x89C4;&#x7EA6;"><i class="fa fa-link" aria-hidden="true"></i></a>11. RAC&amp;MVVM&#x5F00;&#x53D1;&#x89C4;&#x7EA6;</h1>
<h2 id="vm&#x5C42;"><a name="vm&#x5C42;" class="plugin-anchor" href="#vm&#x5C42;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="vm&#x5C42;" class="anchor-navigation-ex-anchor" href="#vm&#x5C42;"><i class="fa fa-link" aria-hidden="true"></i></a>11.1. VM&#x5C42;</h2>
<pre><code class="lang-objc"><span class="hljs-comment">// =============================.h=============================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">WLMSelectedApplyMerchantVM</span> :<span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) RACCommand *requestCommand;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">readonly</span>) RACSubject *messageSubject;
<span class="hljs-keyword">@end</span>
<span class="hljs-comment">// =============================.m=============================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">WLMSelectedApplyMerchantVM</span>()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readwrite</span>) RACCommand *requestCommand;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">readwrite</span>) RACSubject *messageSubject;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">WLMSelectedApplyMerchantVM</span></span>
<span class="hljs-meta">#pragma mark - Init</span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> racInit];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}

-(<span class="hljs-keyword">void</span>)dealloc{
    [<span class="hljs-keyword">self</span>.requestCommand rac_deallocDisposable];
    [<span class="hljs-keyword">self</span>.messageSubject rac_deallocDisposable];
}

- (<span class="hljs-keyword">void</span>)racInit {

    <span class="hljs-comment">//@weakify(self);</span>
    _requestCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal * _Nonnull(<span class="hljs-keyword">id</span>  _Nullable input) {
        <span class="hljs-keyword">return</span> [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
            <span class="hljs-comment">//@strongify(self);</span>

            <span class="hljs-comment">// Code here...</span>

            <span class="hljs-keyword">return</span> [RACDisposable disposableWithBlock:^{
            }];
        }];
    }];
}

<span class="hljs-meta">#pragma mark - Publish Methods</span>

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - Getter</span>
-(RACSubject *)messageSubject{
    <span class="hljs-keyword">if</span> (!_messageSubject) {
        _messageSubject = [RACSubject subject];
    }
    <span class="hljs-keyword">return</span> _messageSubject;
}
<span class="hljs-meta">#pragma mark - Stter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<h2 id="v&#x5C42;"><a name="v&#x5C42;" class="plugin-anchor" href="#v&#x5C42;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="v&#x5C42;" class="anchor-navigation-ex-anchor" href="#v&#x5C42;"><i class="fa fa-link" aria-hidden="true"></i></a>11.2. V&#x5C42;</h2>
<h3 id="controller"><a name="controller" class="plugin-anchor" href="#controller"><i class="fa fa-link" aria-hidden="true"></i></a><a name="controller" class="anchor-navigation-ex-anchor" href="#controller"><i class="fa fa-link" aria-hidden="true"></i></a>11.2.1. Controller</h3>
<pre><code class="lang-objc"><span class="hljs-comment">// =============================.h=============================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">LoginViewController</span> : <span class="hljs-title">UIViewController</span></span>
- (instancetype)initWithViewModel:(RA<span class="hljs-built_in">CAndMVVMViewModel</span>*)viewModel;
<span class="hljs-keyword">@end</span>
<span class="hljs-comment">// =============================.m=============================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">LoginViewController</span> ()</span>
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) RA<span class="hljs-built_in">CAndMVVMViewModel</span> *viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">LoginViewController</span></span>
<span class="hljs-meta">#pragma mark - life cycle</span>
- (instancetype)initWithViewModel:(RA<span class="hljs-built_in">CAndMVVMViewModel</span>*)viewModel{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> == [<span class="hljs-keyword">super</span> init]) {
        _viewModel = viewModel;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    [<span class="hljs-keyword">self</span> segInitViews];
    [<span class="hljs-keyword">self</span> bindViewModel];
}
<span class="hljs-meta">#pragma mark - Init Views</span>
-(<span class="hljs-keyword">void</span>)segInitViews{}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateViewConstraints {
    [<span class="hljs-keyword">super</span> updateViewConstraints];
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {}

<span class="hljs-meta">#pragma mark - getter</span>
-(RA<span class="hljs-built_in">CAndMVVMViewModel</span> *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[RA<span class="hljs-built_in">CAndMVVMViewModel</span> alloc]init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<p>&#x6709;&#x4E9B;&#x65B9;&#x6848;&#x4F1A;&#x628A;<code>Controller</code>&#x4E2D;&#x7684;<code>View</code>&#x4E5F;&#x81EA;&#x5B9A;&#x4E49;&#x51FA;&#x6765;&#xFF0C;&#x6210;&#x4E3A;&#x4E3B;<code>View</code>&#xFF0C;&#x5177;&#x4F53;&#x6837;&#x4F8B;&#xFF1A;</p>
<p>VM&#x5C42;&#xFF1A;</p>
<pre><code class="lang-objc"><span class="hljs-meta">#pragma mark - ====================VM&#x5C42;====================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">LoginMainViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-comment">// Demo RACSubject</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) RACSubject *pushSubject;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">LoginMainViewModel</span></span>
<span class="hljs-meta">#pragma mark - Init</span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> racInit];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}

<span class="hljs-meta">#pragma mark - business</span>
- (<span class="hljs-keyword">void</span>)racInit {}

<span class="hljs-meta">#pragma mark - getter</span>
- (RACSubject *)pushSubject {
    <span class="hljs-keyword">if</span> (!_pushSubject) {
        _pushSubject = [RACSubject subject];
    }
    <span class="hljs-keyword">return</span> _pushSubject;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<p>&#x4E3B;View&#x5C42;&#xFF1A;</p>
<pre><code class="lang-objc"><span class="hljs-meta">#pragma mark - ====================V&#x5C42;====================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">LoginMainView</span> : <span class="hljs-title">UIView</span></span>
<span class="hljs-comment">// Demo Button</span>
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>,<span class="hljs-keyword">strong</span>) <span class="hljs-built_in">UIButton</span>* button;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>,<span class="hljs-keyword">strong</span>) LoginMainViewModel* viewModel;
- (instancetype)initWithViewModel:(LoginMainViewModel*)viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">LoginMainView</span></span>
- (instancetype)initWithViewModel:(LoginMainViewModel*)viewModel {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> == [<span class="hljs-keyword">super</span> init]) {
        _viewModel = viewModel;
        [<span class="hljs-keyword">self</span> segInitViews];
        [<span class="hljs-keyword">self</span> updateConstraints];
        [<span class="hljs-keyword">self</span> bindViewModel];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}

<span class="hljs-meta">#pragma mark - Init Views</span>
-(<span class="hljs-keyword">void</span>)segInitViews{}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateConstraints {
    [<span class="hljs-keyword">super</span> updateConstraints];
}
<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    <span class="hljs-comment">// Demo sendNext</span>
    [[<span class="hljs-keyword">self</span>.button rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
        [<span class="hljs-keyword">self</span>.viewModel.pushSubject sendNext:<span class="hljs-string">@&quot;1&quot;</span>];
    }];
}

<span class="hljs-meta">#pragma mark - getter</span>
-(LoginMainViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[LoginMainViewModel alloc]init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<p>Controller&#x5C42;&#xFF1A;</p>
<pre><code class="lang-objc"><span class="hljs-meta">#pragma mark - ====================V&#x5C42;====================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">LoginViewController</span> ()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) LoginMainView *mainView;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) LoginMainViewModel *viewModel;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">LoginViewController</span></span>
<span class="hljs-meta">#pragma mark - life cycle</span>
- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    [<span class="hljs-keyword">self</span> segInitViews];
    [<span class="hljs-keyword">self</span> bindViewModel];
}
<span class="hljs-meta">#pragma mark - Init Views</span>
-(<span class="hljs-keyword">void</span>)segInitViews{
    [<span class="hljs-keyword">self</span>.view addSubview:<span class="hljs-keyword">self</span>.mainView];
}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateViewConstraints {
    [<span class="hljs-keyword">self</span>.mainView mas_makeConstraints:^(MASConstraintMaker *make) {
        make.edges.mas_equalTo(<span class="hljs-keyword">self</span>.view);
    }];
    [<span class="hljs-keyword">super</span> updateViewConstraints];
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    <span class="hljs-comment">// Demo subscribeNext</span>
    @weakify(<span class="hljs-keyword">self</span>);
    [<span class="hljs-keyword">self</span>.viewModel.pushSubject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        @strongify(<span class="hljs-keyword">self</span>);
        [<span class="hljs-keyword">self</span>.navigationController pushViewController:[<span class="hljs-built_in">UIViewController</span> new] animated:<span class="hljs-literal">YES</span>];
    }];
}

<span class="hljs-meta">#pragma mark - getter</span>
- (LoginMainView *)mainView {
    <span class="hljs-keyword">if</span> (!_mainView) {
        _mainView = [[LoginMainView alloc] initWithViewModel:<span class="hljs-keyword">self</span>.viewModel];
    }
    <span class="hljs-keyword">return</span> _mainView;
}
-(LoginMainViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[LoginMainViewModel alloc]init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<h3 id="&#x81EA;&#x5B9A;&#x4E49;uiview"><a name="&#x81EA;&#x5B9A;&#x4E49;uiview" class="plugin-anchor" href="#&#x81EA;&#x5B9A;&#x4E49;uiview"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x81EA;&#x5B9A;&#x4E49;uiview" class="anchor-navigation-ex-anchor" href="#&#x81EA;&#x5B9A;&#x4E49;uiview"><i class="fa fa-link" aria-hidden="true"></i></a>11.2.2. &#x81EA;&#x5B9A;&#x4E49;UIView</h3>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span>  <span class="hljs-title">LoginTableView</span>: <span class="hljs-title">UIView</span></span>
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>,<span class="hljs-keyword">strong</span>) LoginTableViewModel* viewModel;
- (instancetype)initWithViewModel:(LoginTableViewModel*)viewModel;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">LoginTableView</span></span>
- (instancetype)initWithViewModel:(LoginTableViewModel*)viewModel {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> == [<span class="hljs-keyword">super</span> init]) {
        _viewModel = viewModel;
        [<span class="hljs-keyword">self</span> segInitViews];
        [<span class="hljs-keyword">self</span> updateConstraints];
        [<span class="hljs-keyword">self</span> bindViewModel];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}

<span class="hljs-meta">#pragma mark - Init Views</span>
-(<span class="hljs-keyword">void</span>)segInitViews{}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateConstraints {
    [<span class="hljs-keyword">super</span> updateConstraints];
}
<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {}

<span class="hljs-meta">#pragma mark - getter</span>
-(LoginTableViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[LoginTableViewModel alloc]init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<h3 id="&#x81EA;&#x5B9A;&#x4E49;&#x590D;&#x7528;&#x673A;&#x5236;uiview"><a name="&#x81EA;&#x5B9A;&#x4E49;&#x590D;&#x7528;&#x673A;&#x5236;uiview" class="plugin-anchor" href="#&#x81EA;&#x5B9A;&#x4E49;&#x590D;&#x7528;&#x673A;&#x5236;uiview"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x81EA;&#x5B9A;&#x4E49;&#x590D;&#x7528;&#x673A;&#x5236;uiview" class="anchor-navigation-ex-anchor" href="#&#x81EA;&#x5B9A;&#x4E49;&#x590D;&#x7528;&#x673A;&#x5236;uiview"><i class="fa fa-link" aria-hidden="true"></i></a>11.2.3. &#x81EA;&#x5B9A;&#x4E49;&#x590D;&#x7528;&#x673A;&#x5236;UIView</h3>
<blockquote>
<p>&#x6709;&#x590D;&#x7528;&#x673A;&#x5236;&#x7684;View&#xFF1A;UICollectionviewCell&#x3001;UITableViewCell...,&#x56E0;&#x4E3A;&#x6709;&#x590D;&#x7528;&#x673A;&#x5236;&#xFF0C;&#x4F1A;&#x6709;&#x90E8;&#x4EFD;cell&#x4E0D;&#x4F1A;&#x8D70;<code>init</code>&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x8D70;<code>cell&#x590D;&#x7528;&#x6C60;</code>&#x3002;</p>
</blockquote>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span>  <span class="hljs-title">LoginTableViewCell</span>: <span class="hljs-title">UITableViewCell</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">NSIndexPath</span> *indexPath;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>,<span class="hljs-keyword">strong</span>) CircleListMainViewCellViewModel* viewModel;

+(<span class="hljs-built_in">NSString</span>*)reuseIdentifier;
+(CircleListMainViewCell*)cellWithTableView:(<span class="hljs-built_in">UITableView</span>*)tableView indexPath:(<span class="hljs-built_in">NSIndexPath</span>*)indexPath;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">LoginTableViewCell</span></span>
<span class="hljs-meta">#pragma mark - Init Views</span>
+(<span class="hljs-built_in">NSString</span>*)reuseIdentifier{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">NSStringFromClass</span>([<span class="hljs-keyword">self</span> class]);
}

+(CircleListMainViewCell*)cellWithTableView:(<span class="hljs-built_in">UITableView</span>*)tableView indexPath:(<span class="hljs-built_in">NSIndexPath</span>*)indexPath{
    CircleListMainViewCell *cell = [tableView dequeueReusableCellWithIdentifier:[<span class="hljs-keyword">self</span> reuseIdentifier]];
    <span class="hljs-keyword">if</span> (!cell) {
        cell = [[<span class="hljs-keyword">self</span> alloc] initWithStyle:<span class="hljs-built_in">UITableViewCellStyleDefault</span> reuseIdentifier:[<span class="hljs-keyword">self</span> reuseIdentifier]];
    }
    cell.indexPath = indexPath;
    <span class="hljs-keyword">return</span> cell;
}

-(instancetype)initWithStyle:(<span class="hljs-built_in">UITableViewCellStyle</span>)style reuseIdentifier:(<span class="hljs-built_in">NSString</span> *)reuseIdentifier{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> == [<span class="hljs-keyword">super</span> initWithStyle:style reuseIdentifier:reuseIdentifier]) {
        <span class="hljs-keyword">self</span>.selectionStyle = <span class="hljs-built_in">UITableViewCellSelectionStyleNone</span>;
        [<span class="hljs-keyword">self</span> segInitViews];
        [<span class="hljs-keyword">self</span> updateConstraints];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}

-(<span class="hljs-keyword">void</span>)segInitViews{}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateConstraints {
    [<span class="hljs-keyword">super</span> updateConstraints];
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {}

<span class="hljs-meta">#pragma mark - getter</span>

<span class="hljs-meta">#pragma mark setter</span>
-(<span class="hljs-keyword">void</span>)setViewModel:(LoginTableViewCellViewModel *)viewModel{
    _viewModel = viewModel;
    <span class="hljs-keyword">if</span> (!viewModel)  <span class="hljs-keyword">return</span>;
    [<span class="hljs-keyword">self</span> bindViewModel];
}
<span class="hljs-keyword">@end</span>
</code></pre>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="mvvmrac"><a name="mvvmrac" class="plugin-anchor" href="#mvvmrac"><i class="fa fa-link" aria-hidden="true"></i></a><a name="mvvmrac" class="anchor-navigation-ex-anchor" href="#mvvmrac"><i class="fa fa-link" aria-hidden="true"></i></a>12. MVVM&amp;RAC</h1>
<h2 id="&#x4F7F;&#x7528;&#x8BBE;&#x8BA1;"><a name="&#x4F7F;&#x7528;&#x8BBE;&#x8BA1;" class="plugin-anchor" href="#&#x4F7F;&#x7528;&#x8BBE;&#x8BA1;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4F7F;&#x7528;&#x8BBE;&#x8BA1;" class="anchor-navigation-ex-anchor" href="#&#x4F7F;&#x7528;&#x8BBE;&#x8BA1;"><i class="fa fa-link" aria-hidden="true"></i></a>12.1. &#x4F7F;&#x7528;&#x8BBE;&#x8BA1;</h2>
<ul>
<li>&#x4E00;&#x4E2A;V(<code>ViewController</code>&#x4E5F;&#x662F;&#x4E00;&#x4E2A;V)&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;VM&#xFF0C;V&#x754C;&#x9762;&#x5143;&#x7D20;&#x5C5E;&#x6027;&#x4E0E; VM &#x5904;&#x7406;&#x540E;&#x7684;&#x6570;&#x636E;&#x5C5E;&#x6027;&#x7ED1;&#x5B9A;&#x3002;</li>
<li><code>ViewController</code>&#x5BF9;&#x5E94;&#x7684;VM&#x7B97;&#x662F;&#x4E3B;VM&#x3002;&#x4E3B; VM &#x627F;&#x62C5;&#x4E86;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x3001;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x534F;&#x8BAE;&#x3001;&#x521D;&#x59CB;&#x5316;&#x5B50; VM &#x5E76;&#x4E14;&#x7ED9;&#x5B50;VM&#x7684;&#x5C5E;&#x6027;&#x8D4B;&#x521D;&#x503C;&#xFF1B;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x8FC7;&#x540E;&#xFF0C;&#x4E3B; ViewModel &#x8FD8;&#x9700;&#x8981;&#x7ED9;&#x5B50; ViewModel &#x7684;&#x5C5E;&#x6027;&#x8D4B;&#x4E88;&#x65B0;&#x7684;&#x503C;&#x3002;</li>
</ul>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">mainViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) MineHeaderViewModel *mineHeaderViewModel;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) <span class="hljs-built_in">NSArray</span>&lt;MineTopCollectionViewCellViewModel *&gt; *dataSorceOfMineTopCollectionViewCell;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) <span class="hljs-built_in">NSArray</span>&lt;MineDownCollectionViewCellViewModel *&gt; *dataSorceOfMineDownCollectionViewCell;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) RACCommand *autoLoginCommand;<span class="hljs-comment">//&#x7528;&#x4E8E;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) RACSubject *pushSubject;<span class="hljs-comment">//&#x76F8;&#x5F53;&#x4E8E;&#x534F;&#x8BAE;&#xFF0C;&#x8FD9;&#x91CC;&#x7528;&#x4E8E;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x7684;&#x4EE3;&#x7406;</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<h2 id="&#x793A;&#x4F8B;&#xFF1A;&#x5217;&#x8868;&#x5237;&#x65B0;"><a name="&#x793A;&#x4F8B;&#xFF1A;&#x5217;&#x8868;&#x5237;&#x65B0;" class="plugin-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;&#x5217;&#x8868;&#x5237;&#x65B0;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x793A;&#x4F8B;&#xFF1A;&#x5217;&#x8868;&#x5237;&#x65B0;" class="anchor-navigation-ex-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;&#x5217;&#x8868;&#x5237;&#x65B0;"><i class="fa fa-link" aria-hidden="true"></i></a>12.2. &#x793A;&#x4F8B;&#xFF1A;&#x5217;&#x8868;&#x5237;&#x65B0;</h2>
<p>&#x5177;&#x4F53;&#x6548;&#x679C;&#xFF1A;</p>
<p><img src="../assets/images/iOS/rac/15.gif"></p>
<pre><code>2020-06-03 14:20:34.431310+0800 RACExample[29796:2244630] refreshDataCommand execute
2020-06-03 14:20:34.464985+0800 RACExample[29796:2244630] executing subscribeNext
2020-06-03 14:20:34.465376+0800 RACExample[29796:2244630] RefreshLoading
2020-06-03 14:20:35.088477+0800 RACExample[29796:2244630] refreshDataCommand subscriber sendNext
2020-06-03 14:20:35.088770+0800 RACExample[29796:2244630] switchToLatest subscribeNext
2020-06-03 14:20:35.092880+0800 RACExample[29796:2244630] RefreshUI
2020-06-03 14:20:35.093239+0800 RACExample[29796:2244630] refreshDataCommand subscriber sendCompleted
2020-06-03 14:20:37.458024+0800 RACExample[29796:2244630] refreshDataCommand subscriber sendNext
2020-06-03 14:20:37.458241+0800 RACExample[29796:2244630] switchToLatest subscribeNext
2020-06-03 14:20:37.458642+0800 RACExample[29796:2244630] RefreshUI
2020-06-03 14:20:37.458772+0800 RACExample[29796:2244630] refreshDataCommand subscriber sendCompleted
2020-06-03 14:20:38.549670+0800 RACExample[29796:2244630] refreshDataCommand subscriber sendNext
2020-06-03 14:20:38.549901+0800 RACExample[29796:2244630] switchToLatest subscribeNext
2020-06-03 14:20:38.550304+0800 RACExample[29796:2244630] RefreshUI
2020-06-03 14:20:38.550600+0800 RACExample[29796:2244630] refreshDataCommand subscriber sendCompleted
2020-06-03 14:20:40.055668+0800 RACExample[29796:2244630] refreshDataCommand subscriber sendNext
2020-06-03 14:20:40.055887+0800 RACExample[29796:2244630] switchToLatest subscribeNext
2020-06-03 14:20:40.056336+0800 RACExample[29796:2244630] RefreshUI
2020-06-03 14:20:40.056514+0800 RACExample[29796:2244630] refreshDataCommand subscriber sendCompleted
</code></pre><p>&#x4ED6;&#x4EEC;&#x7684;&#x9879;&#x76EE;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre><code>&#x251C;&#x2500;&#x2500; Controller
&#x2502;   &#x251C;&#x2500;&#x2500; CircleListViewController.h
&#x2502;   &#x2514;&#x2500;&#x2500; CircleListViewController.m
&#x251C;&#x2500;&#x2500; Model
&#x2502;   &#x251C;&#x2500;&#x2500; DouBanTheatersModel.h
&#x2502;   &#x2514;&#x2500;&#x2500; DouBanTheatersModel.m
&#x251C;&#x2500;&#x2500; View
&#x2502;   &#x251C;&#x2500;&#x2500; CircleListMainView.h
&#x2502;   &#x251C;&#x2500;&#x2500; CircleListMainView.m
&#x2502;   &#x251C;&#x2500;&#x2500; CircleListMainViewCell.h
&#x2502;   &#x2514;&#x2500;&#x2500; CircleListMainViewCell.m
&#x2514;&#x2500;&#x2500; ViewModel
    &#x251C;&#x2500;&#x2500; CircleListMainViewCellViewModel.h
    &#x251C;&#x2500;&#x2500; CircleListMainViewCellViewModel.m
    &#x251C;&#x2500;&#x2500; CircleListMainViewModel.h
    &#x2514;&#x2500;&#x2500; CircleListMainViewModel.m
</code></pre><h3 id="circlelistviewcontroller"><a name="circlelistviewcontroller" class="plugin-anchor" href="#circlelistviewcontroller"><i class="fa fa-link" aria-hidden="true"></i></a><a name="circlelistviewcontroller" class="anchor-navigation-ex-anchor" href="#circlelistviewcontroller"><i class="fa fa-link" aria-hidden="true"></i></a>12.2.1. CircleListViewController</h3>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">CircleListViewController</span> ()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) CircleListMainView *mainView;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) CircleListMainViewModel *viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">CircleListViewController</span></span>
<span class="hljs-meta">#pragma mark - life cycle</span>
- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    [<span class="hljs-keyword">self</span> segInitViews];
    [<span class="hljs-keyword">self</span> bindViewModel];
}
<span class="hljs-meta">#pragma mark - Init Views</span>
-(<span class="hljs-keyword">void</span>)segInitViews{
    [<span class="hljs-keyword">self</span>.view addSubview:<span class="hljs-keyword">self</span>.mainView];
}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateViewConstraints {
    [<span class="hljs-keyword">self</span>.mainView mas_makeConstraints:^(MASConstraintMaker *make) {
        make.edges.mas_equalTo(<span class="hljs-keyword">self</span>.view);
    }];
    [<span class="hljs-keyword">super</span> updateViewConstraints];
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    <span class="hljs-comment">// &#x70B9;&#x51FB; cell &#x8DF3;&#x8F6C; Controller</span>
    @weakify(<span class="hljs-keyword">self</span>);
    [[<span class="hljs-keyword">self</span>.viewModel.cellClickSubject takeUntil:<span class="hljs-keyword">self</span>.rac_willDeallocSignal] subscribeNext:^(CircleListMainViewCellViewModel*  _Nullable x) {
        @strongify(<span class="hljs-keyword">self</span>);
        <span class="hljs-built_in">UIViewController</span> *VC = [<span class="hljs-built_in">UIViewController</span> new];
        VC.view.backgroundColor = [<span class="hljs-built_in">UIColor</span> whiteColor];
        [<span class="hljs-keyword">self</span>.navigationController pushViewController:VC animated:<span class="hljs-literal">YES</span>];
    }];
}

<span class="hljs-meta">#pragma mark - getter</span>
- (CircleListMainView *)mainView {
    <span class="hljs-keyword">if</span> (!_mainView) {
        _mainView = [[CircleListMainView alloc] initWithViewModel:<span class="hljs-keyword">self</span>.viewModel];
    }
    <span class="hljs-keyword">return</span> _mainView;
}
-(CircleListMainViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[CircleListMainViewModel alloc]init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<h3 id="viewmodel"><a name="viewmodel" class="plugin-anchor" href="#viewmodel"><i class="fa fa-link" aria-hidden="true"></i></a><a name="viewmodel" class="anchor-navigation-ex-anchor" href="#viewmodel"><i class="fa fa-link" aria-hidden="true"></i></a>12.2.2. ViewModel</h3>
<h4 id="circlelistmainviewmodel"><a name="circlelistmainviewmodel" class="plugin-anchor" href="#circlelistmainviewmodel"><i class="fa fa-link" aria-hidden="true"></i></a><a name="circlelistmainviewmodel" class="anchor-navigation-ex-anchor" href="#circlelistmainviewmodel"><i class="fa fa-link" aria-hidden="true"></i></a>CircleListMainViewModel</h4>
<pre><code class="lang-objc"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> : <span class="hljs-built_in">NSUInteger</span> {
    RefreshLoading, <span class="hljs-comment">// &#x6B63;&#x5728;&#x5237;&#x65B0;</span>
    RefreshError, <span class="hljs-comment">// &#x5237;&#x65B0;&#x51FA;&#x9519;</span>
    RefreshUI, <span class="hljs-comment">// &#x4EC5;&#x4EC5;&#x5237;&#x65B0;UI&#x5E03;&#x5C40;</span>
} RefreshDataStatus;

<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">CircleListMainViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) RACCommand *refreshDataCommand;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) RACSubject *refreshDataSubject;

<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) RACSubject *cellClickSubject;<span class="hljs-comment">//&#x70B9;&#x51FB;cell&#x7684;&#x70ED;&#x4FE1;&#x53F7;</span>

<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>,<span class="hljs-keyword">readonly</span>) <span class="hljs-built_in">NSArray</span>&lt;CircleListMainViewCellViewModel*&gt; *dataArray;
<span class="hljs-keyword">@end</span>

<span class="hljs-comment">// ============================.m==========================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">CircleListMainViewModel</span>()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) HttpManager *httpManager;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>,<span class="hljs-keyword">readwrite</span>) <span class="hljs-built_in">NSArray</span>&lt;CircleListMainViewCellViewModel*&gt; *dataArray;
<span class="hljs-keyword">@end</span>

implementation CircleListMainViewModel
<span class="hljs-meta">#pragma mark - Init</span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> racInit];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
<span class="hljs-meta">#pragma mark - business</span>
- (<span class="hljs-keyword">void</span>)racInit {
    <span class="hljs-comment">// &#x521D;&#x59CB;&#x5316; RACCommand &#xFF0C;&#x5E76;&#x53D1;&#x8D77;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x3002;</span>
    _refreshDataCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal * _Nonnull(<span class="hljs-keyword">id</span>  _Nullable input) {
        <span class="hljs-keyword">return</span> [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {

            <span class="hljs-comment">// &#x7F51;&#x7EDC;&#x8BF7;&#x6C42;</span>
            <span class="hljs-built_in">NSMutableDictionary</span> *parameters = [<span class="hljs-built_in">NSMutableDictionary</span> dictionary];
            parameters[<span class="hljs-string">@&quot;apikey&quot;</span>] = <span class="hljs-string">@&quot;0df993c66c0c636e29ecbb5344252a4a&quot;</span>;
            [<span class="hljs-keyword">self</span>.httpManager requestNetworkDataWithUrlString:<span class="hljs-string">@&quot;/v2/movie/in_theaters&quot;</span> Params:parameters completed:^(<span class="hljs-keyword">id</span>  _Nonnull response, <span class="hljs-built_in">NSError</span> * _Nonnull error) {
                <span class="hljs-keyword">if</span> (error) {
                    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;refreshDataCommand subscriber sendError&quot;</span>);
                    [subscriber sendError:error];
                }<span class="hljs-keyword">else</span>{
                    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;refreshDataCommand subscriber sendNext&quot;</span>);
                    [subscriber sendNext:response];
                }
                <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;refreshDataCommand subscriber sendCompleted&quot;</span>);
                [subscriber sendCompleted];
            }];

            <span class="hljs-keyword">return</span> [RACDisposable disposableWithBlock:^{
            }];
        }];
    }];

    <span class="hljs-comment">// &#x4FE1;&#x53F7;&#x6D41;&#xFF1A;O-O-O-O-O-O&#xFF0C;&#x800C;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x5C31;&#x662F;,&#x8DF3;&#x8FC7;&#x7B2C;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x5E76;&#x4E14;&#x53EA;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x3002;</span>
    [[[_refreshDataCommand.executing skip:<span class="hljs-number">1</span>] take:<span class="hljs-number">1</span>] subscribeNext:^(<span class="hljs-built_in">NSNumber</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;executing subscribeNext&quot;</span>);
        [<span class="hljs-keyword">self</span> showStatus:<span class="hljs-string">@&quot;&#x6B63;&#x5728;&#x52A0;&#x8F7D;...&quot;</span>];
    }];

    <span class="hljs-comment">// &#x8FDB;&#x884C;&#x4E1A;&#x52A1;&#x5904;&#x7406;</span>
    [[[_refreshDataCommand executionSignals] switchToLatest] subscribeNext:^(<span class="hljs-built_in">NSDictionary</span>*  _Nullable response) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;switchToLatest subscribeNext&quot;</span>);

        <span class="hljs-keyword">if</span> (!response) {
             [<span class="hljs-keyword">self</span> showErrorStatus:<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x6709;&#x95EE;&#x9898;&#xFF01;&quot;</span>];
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// &#x628A; BO &#x6570;&#x636E;&#x8F6C;&#x6210; VM</span>
        <span class="hljs-built_in">NSMutableArray</span>&lt;CircleListMainViewCellViewModel*&gt;*tempt = [<span class="hljs-built_in">NSMutableArray</span> array];
        <span class="hljs-built_in">NSArray</span> *subjects = [response valueForKey:<span class="hljs-string">@&quot;subjects&quot;</span>];
        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">NSDictionary</span> *object <span class="hljs-keyword">in</span> subjects) {;
            CircleListMainViewCellViewModel *cellViewModel = [[CircleListMainViewCellViewModel alloc] init];
            cellViewModel.model = [DouBanTheatersModel yy_modelWithJSON:object];
            [tempt addObject:cellViewModel];
        }
        <span class="hljs-keyword">self</span>.dataArray = [<span class="hljs-built_in">NSArray</span> arrayWithArray:tempt];
        [<span class="hljs-keyword">self</span> showMessage:<span class="hljs-string">@&quot;&#x8BF7;&#x6C42;&#x6210;&#x529F;&#xFF01;&quot;</span>];
    }];

    <span class="hljs-comment">// &#x9519;&#x8BEF;&#x5904;&#x7406;</span>
    [_refreshDataCommand.errors subscribeNext:^(<span class="hljs-built_in">NSError</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;errors subscribeNext&quot;</span>);
        [<span class="hljs-keyword">self</span> showErrorStatus:<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x6709;&#x95EE;&#x9898;&#xFF01;&quot;</span>];
    }];
}
-(<span class="hljs-keyword">void</span>)showMessage:(<span class="hljs-built_in">NSString</span>*)message{
    [<span class="hljs-keyword">self</span>.refreshDataSubject sendNext:@{<span class="hljs-string">@&quot;code&quot;</span>:@(RefreshUI),<span class="hljs-string">@&quot;msg&quot;</span>:message}];
}
-(<span class="hljs-keyword">void</span>)showStatus:(<span class="hljs-built_in">NSString</span>*)status{
    [<span class="hljs-keyword">self</span>.refreshDataSubject sendNext:@{<span class="hljs-string">@&quot;code&quot;</span>:@(RefreshLoading),<span class="hljs-string">@&quot;msg&quot;</span>:status}];
}
-(<span class="hljs-keyword">void</span>)showErrorStatus:(<span class="hljs-built_in">NSString</span>*)error{
    [<span class="hljs-keyword">self</span>.refreshDataSubject sendNext:@{<span class="hljs-string">@&quot;code&quot;</span>:@(RefreshError),<span class="hljs-string">@&quot;msg&quot;</span>:error}];
}

<span class="hljs-meta">#pragma mark - getter</span>
-(HttpManager *)httpManager{
    <span class="hljs-keyword">if</span> (!_httpManager) {
        _httpManager = [[HttpManager alloc] initWithBaseURLString:<span class="hljs-string">@&quot;https://api.douban.com&quot;</span>];
    }
    <span class="hljs-keyword">return</span> _httpManager;
}
-(RACSubject *)refreshDataSubject{
    <span class="hljs-keyword">if</span> (!_refreshDataSubject) {
        _refreshDataSubject = [RACSubject subject];
    }
    <span class="hljs-keyword">return</span> _refreshDataSubject;
}

-(RACSubject *)cellClickSubject{
    <span class="hljs-keyword">if</span> (!_cellClickSubject) {
        _cellClickSubject = [RACSubject subject];
    }
    <span class="hljs-keyword">return</span> _cellClickSubject;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<h4 id="circlelistmainviewcellviewmodel"><a name="circlelistmainviewcellviewmodel" class="plugin-anchor" href="#circlelistmainviewcellviewmodel"><i class="fa fa-link" aria-hidden="true"></i></a><a name="circlelistmainviewcellviewmodel" class="anchor-navigation-ex-anchor" href="#circlelistmainviewcellviewmodel"><i class="fa fa-link" aria-hidden="true"></i></a>CircleListMainViewCellViewModel</h4>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">CircleListMainViewCellViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) DouBanTheatersModel *model;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">CircleListMainViewCellViewModel</span></span>
<span class="hljs-meta">#pragma mark - Init</span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> racInit];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
<span class="hljs-meta">#pragma mark - business</span>
- (<span class="hljs-keyword">void</span>)racInit {}
<span class="hljs-meta">#pragma mark - getter</span>
-(DouBanTheatersModel *)model{
    <span class="hljs-keyword">if</span> (!_model) {
        _model = [[DouBanTheatersModel alloc] init];
    }
    <span class="hljs-keyword">return</span> _model;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<h3 id="view"><a name="view" class="plugin-anchor" href="#view"><i class="fa fa-link" aria-hidden="true"></i></a><a name="view" class="anchor-navigation-ex-anchor" href="#view"><i class="fa fa-link" aria-hidden="true"></i></a>12.2.3. View</h3>
<h4 id="circlelistmainview"><a name="circlelistmainview" class="plugin-anchor" href="#circlelistmainview"><i class="fa fa-link" aria-hidden="true"></i></a><a name="circlelistmainview" class="anchor-navigation-ex-anchor" href="#circlelistmainview"><i class="fa fa-link" aria-hidden="true"></i></a>CircleListMainView</h4>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">CircleListMainView</span> : <span class="hljs-title">UIView</span></span>
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>,<span class="hljs-keyword">strong</span>) CircleListMainViewModel* viewModel;
- (instancetype)initWithViewModel:(CircleListMainViewModel*)viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-comment">// ==============================.m================================</span>

<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">CircleListMainView</span>()&lt;<span class="hljs-title">UITableViewDataSource</span>, <span class="hljs-title">UITableViewDelegate</span>&gt;</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">UITableView</span> *mainTableView;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">CircleListMainView</span></span>
- (instancetype)initWithViewModel:(CircleListMainViewModel*)viewModel {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> == [<span class="hljs-keyword">super</span> init]) {
        <span class="hljs-keyword">self</span>.backgroundColor = <span class="hljs-keyword">self</span>.superview.backgroundColor;
        _viewModel = viewModel;
        [<span class="hljs-keyword">self</span> segInitViews];
        [<span class="hljs-keyword">self</span> setNeedsUpdateConstraints];
        [<span class="hljs-keyword">self</span> updateConstraintsIfNeeded];
        [<span class="hljs-keyword">self</span> bindViewModel];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}

<span class="hljs-meta">#pragma mark - Init Views</span>
-(<span class="hljs-keyword">void</span>)segInitViews{
    [<span class="hljs-keyword">self</span> addSubview:<span class="hljs-keyword">self</span>.mainTableView];
}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateConstraints {
    [<span class="hljs-keyword">self</span>.mainTableView mas_makeConstraints:^(MASConstraintMaker *make) {
        make.edges.equalTo(<span class="hljs-keyword">self</span>);
    }];
    [<span class="hljs-keyword">super</span> updateConstraints];
}
<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    [SVProgressHUD setMinimumDismissTimeInterval:<span class="hljs-number">1.0</span>];

    <span class="hljs-comment">// &#x6570;&#x636E;&#x8BF7;&#x6C42;</span>
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;refreshDataCommand execute&quot;</span>);
    [<span class="hljs-keyword">self</span>.viewModel.refreshDataCommand execute:<span class="hljs-literal">nil</span>];
    <span class="hljs-comment">// &#x6570;&#x636E;&#x5237;&#x65B0;</span>
    [<span class="hljs-keyword">self</span>.viewModel.refreshDataSubject subscribeNext:^(<span class="hljs-built_in">NSDictionary</span>*  _Nullable x) {
        [<span class="hljs-keyword">self</span>.mainTableView.mj_header endRefreshing];
        [<span class="hljs-keyword">self</span>.mainTableView.mj_footer endRefreshing];

        [<span class="hljs-keyword">self</span>.mainTableView reloadData];

        <span class="hljs-built_in">NSInteger</span> code = [[x valueForKey:<span class="hljs-string">@&quot;code&quot;</span>] integerValue];
        <span class="hljs-built_in">NSString</span>* msg = [x valueForKey:<span class="hljs-string">@&quot;msg&quot;</span>];

        <span class="hljs-keyword">switch</span> (code) {
            <span class="hljs-keyword">case</span> RefreshLoading:
                <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RefreshLoading&quot;</span>);
                [SVProgressHUD show];
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> RefreshError:
                <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RefreshError&quot;</span>);
                [SVProgressHUD showErrorWithStatus:msg];
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> RefreshUI:
                <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;RefreshUI&quot;</span>);
                [SVProgressHUD showSuccessWithStatus:msg];
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">break</span>;
        }
    }];
}

<span class="hljs-meta">#pragma mark - getter</span>
-(CircleListMainViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[CircleListMainViewModel alloc]init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
- (<span class="hljs-built_in">UITableView</span> *)mainTableView {
    <span class="hljs-keyword">if</span> (!_mainTableView) {
        _mainTableView = [[<span class="hljs-built_in">UITableView</span> alloc] init];
        _mainTableView.delegate = <span class="hljs-keyword">self</span>;
        _mainTableView.dataSource = <span class="hljs-keyword">self</span>;
        _mainTableView.backgroundColor = <span class="hljs-keyword">self</span>.backgroundColor;
        _mainTableView.separatorStyle = <span class="hljs-built_in">UITableViewCellSeparatorStyleNone</span>;
        _mainTableView.mj_header = [MJRefreshNormalHeader headerWithRefreshingBlock:^{
            [<span class="hljs-keyword">self</span>.viewModel.refreshDataCommand execute:<span class="hljs-literal">nil</span>];
        }];
        _mainTableView.mj_footer = [MJRefreshAutoNormalFooter footerWithRefreshingBlock:^{
            [<span class="hljs-keyword">self</span>.viewModel.refreshDataCommand execute:<span class="hljs-literal">nil</span>];
        }];
    }
    <span class="hljs-keyword">return</span> _mainTableView;
}

<span class="hljs-meta">#pragma mark - ====================delegate====================</span>

<span class="hljs-meta">#pragma mark - UITableViewDataSource</span>
- (<span class="hljs-built_in">NSInteger</span>)numberOfSectionsInTableView:(<span class="hljs-built_in">UITableView</span> *)tableView {
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
}
- (<span class="hljs-built_in">NSInteger</span>)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="hljs-built_in">NSInteger</span>)section {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>.viewModel.dataArray.count;
}
- (<span class="hljs-built_in">UITableViewCell</span> *)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="hljs-built_in">NSIndexPath</span> *)indexPath {
    CircleListMainViewCell *cell = [CircleListMainViewCell cellWithTableView:tableView indexPath:indexPath];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span>.viewModel.dataArray.count &gt; indexPath.row) {
        cell.viewModel = <span class="hljs-keyword">self</span>.viewModel.dataArray[indexPath.row];
    }
    <span class="hljs-keyword">return</span> cell;
}
<span class="hljs-meta">#pragma mark - UITableViewDelegate</span>
- (<span class="hljs-built_in">CGFloat</span>)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="hljs-built_in">NSIndexPath</span> *)indexPath {
    <span class="hljs-keyword">return</span> <span class="hljs-number">100</span>;
}
- (<span class="hljs-keyword">void</span>)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView didSelectRowAtIndexPath:(<span class="hljs-built_in">NSIndexPath</span> *)indexPath {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span>.viewModel.dataArray.count &gt; indexPath.row) {
        [<span class="hljs-keyword">self</span>.viewModel.cellClickSubject sendNext:<span class="hljs-keyword">self</span>.viewModel.dataArray[indexPath.row]];
    }
}
<span class="hljs-keyword">@end</span>
</code></pre>
<h4 id="circlelistmainviewcell"><a name="circlelistmainviewcell" class="plugin-anchor" href="#circlelistmainviewcell"><i class="fa fa-link" aria-hidden="true"></i></a><a name="circlelistmainviewcell" class="anchor-navigation-ex-anchor" href="#circlelistmainviewcell"><i class="fa fa-link" aria-hidden="true"></i></a>CircleListMainViewCell</h4>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">CircleListMainViewCell</span> : <span class="hljs-title">UITableViewCell</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">NSIndexPath</span> *indexPath;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>,<span class="hljs-keyword">strong</span>) CircleListMainViewCellViewModel* viewModel;

+(<span class="hljs-built_in">NSString</span>*)reuseIdentifier;
+(CircleListMainViewCell*)cellWithTableView:(<span class="hljs-built_in">UITableView</span>*)tableView indexPath:(<span class="hljs-built_in">NSIndexPath</span>*)indexPath;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">CircleListMainViewCell</span></span>
<span class="hljs-meta">#pragma mark - Init Views</span>
+(<span class="hljs-built_in">NSString</span>*)reuseIdentifier{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">NSStringFromClass</span>([<span class="hljs-keyword">self</span> class]);
}

+(CircleListMainViewCell*)cellWithTableView:(<span class="hljs-built_in">UITableView</span>*)tableView indexPath:(<span class="hljs-built_in">NSIndexPath</span>*)indexPath{
    CircleListMainViewCell *cell = [tableView dequeueReusableCellWithIdentifier:[<span class="hljs-keyword">self</span> reuseIdentifier]];
    <span class="hljs-keyword">if</span> (!cell) {
        cell = [[CircleListMainViewCell alloc] initWithStyle:<span class="hljs-built_in">UITableViewCellStyleDefault</span> reuseIdentifier:[<span class="hljs-keyword">self</span> reuseIdentifier]];
    }
    cell.indexPath = indexPath;
    <span class="hljs-keyword">return</span> cell;
}

-(instancetype)initWithStyle:(<span class="hljs-built_in">UITableViewCellStyle</span>)style reuseIdentifier:(<span class="hljs-built_in">NSString</span> *)reuseIdentifier{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> == [<span class="hljs-keyword">super</span> initWithStyle:style reuseIdentifier:reuseIdentifier]) {
        [<span class="hljs-keyword">self</span> segInitViews];
        [<span class="hljs-keyword">self</span> updateConstraints];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}

-(<span class="hljs-keyword">void</span>)segInitViews{}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateConstraints {
    [<span class="hljs-keyword">super</span> updateConstraints];
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    <span class="hljs-keyword">self</span>.textLabel.text = <span class="hljs-keyword">self</span>.viewModel.model.title;

    <span class="hljs-comment">//RAC(self.textLabel,text) = RACObserve(self.viewModel.model, title); ==&gt; &#x8FD9;&#x4E2A;&#x5728;&#x6570;&#x636E;&#x5237;&#x65B0;&#x7684;&#x65F6;&#x5019;&#x62A5;&#x9519;&#xFF01;&#x56E0;&#x4E3A;KVO&#x7684;keypath&#x91CD;&#x590D;&#x7ED1;&#x5B9A;&#x3002;</span>
    <span class="hljs-comment">//RAC(self.textLabel,text) = [RACObserve(self.viewModel.model, title) takeUntil:self.rac_prepareForReuseSignal]; ==&gt; &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x6837;&#x7684;&#x65B9;&#x5F0F;&#x641E;&#x5B9A;&#x3002;</span>
    <span class="hljs-comment">//&#x5728;cell&#x91CC;&#x9762;&#x521B;&#x5EFA;&#x7684;&#x4FE1;&#x53F7;&#x52A0;&#x4E0A;takeUntil:cell.rac_prepareForReuseSignal&#xFF0C;&#x8FD9;&#x4E2A;&#x662F;&#x8BA9;cell&#x5728;&#x6BCF;&#x6B21;&#x91CD;&#x7528;&#x7684;&#x65F6;&#x5019;&#x90FD;&#x53BB;disposable&#x521B;&#x5EFA;&#x7684;&#x4FE1;&#x53F7;&#x3002;</span>
}

<span class="hljs-meta">#pragma mark - getter</span>

<span class="hljs-meta">#pragma mark setter</span>
-(<span class="hljs-keyword">void</span>)setViewModel:(CircleListMainViewCellViewModel *)viewModel{
    _viewModel = viewModel;
    <span class="hljs-keyword">if</span> (!viewModel)  <span class="hljs-keyword">return</span>;
    [<span class="hljs-keyword">self</span> bindViewModel];
}
<span class="hljs-keyword">@end</span>
</code></pre>
<h2 id="tableviewuibutton"><a name="tableviewuibutton" class="plugin-anchor" href="#tableviewuibutton"><i class="fa fa-link" aria-hidden="true"></i></a><a name="tableviewuibutton" class="anchor-navigation-ex-anchor" href="#tableviewuibutton"><i class="fa fa-link" aria-hidden="true"></i></a>12.3. TableView&amp;UIButton</h2>
<p>&#x5728;<code>UITableViewCell</code>&#x4E2D;&#x6709;<code>UIButton</code>&#x6309;&#x94AE;&#xFF0C;&#x70B9;&#x51FB;&#x6309;&#x94AE;&#x51FA;&#x53D1;&#x56DE;&#x8C03;&#xFF0C;&#x4F1A;&#x6709;&#x5982;&#x4E0B;&#x4E00;&#x79CD;&#x9519;&#x8BEF;&#x573A;&#x666F;&#xFF1A;<strong>&#x5237;&#x65B0;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x4F1A;&#x91CD;&#x590D;&#x8BA2;&#x9605;&#xFF0C;&#x5BFC;&#x81F4;&#x65B9;&#x6CD5;&#x591A;&#x6B21;&#x89E6;&#x53D1;</strong></p>
<p><img src="../assets/images/iOS/rac/16.gif"></p>
<p><strong>CircleListMainView:</strong></p>
<pre><code class="lang-objc">- (<span class="hljs-built_in">UITableViewCell</span> *)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="hljs-built_in">NSIndexPath</span> *)indexPath {
    CircleListMainViewCell *cell = [CircleListMainViewCell cellWithTableView:tableView indexPath:indexPath];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span>.viewModel.dataArray.count &gt; indexPath.row) {
        cell.viewModel = <span class="hljs-keyword">self</span>.viewModel.dataArray[indexPath.row];
    }
    [cell.viewModel.buttonClickSubject subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;raiseButton subscribeNext--%@&quot;</span>,x);
    }];
    <span class="hljs-keyword">return</span> cell;
}
</code></pre>
<p><strong>CircleListMainViewCell:</strong></p>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">CircleListMainViewCell</span></span>
<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
   @weakify(<span class="hljs-keyword">self</span>);
   [[<span class="hljs-keyword">self</span>.raiseButton rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
       @strongify(<span class="hljs-keyword">self</span>);
       [<span class="hljs-keyword">self</span>.viewModel.buttonClickSubject sendNext:<span class="hljs-keyword">self</span>.viewModel.model];
   }];
}
<span class="hljs-keyword">@end</span>
</code></pre>
<p>&#x5728;<code>UITableViewCell</code>&#x7684;&#x5206;&#x7C7B;&#x4E2D;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;<code>rac_prepareForReuseSignal</code>&#xFF0C;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x3002;</p>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">CircleListMainViewCell</span></span>
<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    @weakify(<span class="hljs-keyword">self</span>);
    [[[<span class="hljs-keyword">self</span>.raiseButton rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] takeUntil:<span class="hljs-keyword">self</span>.rac_prepareForReuseSignal] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
        @strongify(<span class="hljs-keyword">self</span>);
        [<span class="hljs-keyword">self</span>.viewModel.buttonClickSubject sendNext:<span class="hljs-keyword">self</span>.viewModel.model.title];
    }];
}
<span class="hljs-keyword">@end</span>
</code></pre>
<p><img src="../assets/images/iOS/rac/17.gif"></p>
<h2 id="tableviewuitextfield"><a name="tableviewuitextfield" class="plugin-anchor" href="#tableviewuitextfield"><i class="fa fa-link" aria-hidden="true"></i></a><a name="tableviewuitextfield" class="anchor-navigation-ex-anchor" href="#tableviewuitextfield"><i class="fa fa-link" aria-hidden="true"></i></a>12.4. TableView&amp;UITextField</h2>
<pre><code class="lang-objc">RACChannelTo(<span class="hljs-keyword">self</span>.viewModel,leftString) =  RACChannelTo(<span class="hljs-keyword">self</span>.leftTextField,text);
[RACObserve(<span class="hljs-keyword">self</span>.viewModel,leftString) subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;leftString %@&quot;</span>,x);
}];
[[<span class="hljs-keyword">self</span>.clickButton rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
    <span class="hljs-keyword">self</span>.viewModel.leftString = <span class="hljs-string">@&quot;&#x4EE3;&#x7801;&#x8BBE;&#x7F6E;StringValue&quot;</span>;
}];
</code></pre>
<p><img src="../assets/images/iOS/rac/18.gif"></p>
<p>&#x901A;&#x8FC7;<code>RACChannelTo</code>&#x5BF9;<code>TextField.txt</code>&#x548C;<code>VM.leftString</code>&#x8FDB;&#x884C;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;<code>TextField</code>&#x8FDB;&#x884C;&#x952E;&#x76D8;&#x8F93;&#x5165;&#x65F6;&#xFF0C;<code>VM.leftString</code>&#x7684;&#x503C;&#x4E0D;&#x4F1A;&#x66F4;&#x65B0;&#x3002;&#x5F53;&#x901A;&#x8FC7;&#x4EE3;&#x7801;&#x53BB;&#x5BF9;<code>VM.leftString</code>&#x8FDB;&#x884C;&#x8D4B;&#x503C;&#x65F6;&#xFF0C;<code>TextField.txt</code>&#x7684;&#x503C;&#x66F4;&#x65B0;&#x4E86;&#x3002;&#x800C;&#x6309;&#x7167;&#x5B98;&#x65B9;&#x7684;&#x8BF4;&#x6CD5;&#x5C31;&#x662F;&#xFF0C;<code>UIKIt</code>&#x91CC;&#x9762;&#x7684;&#x5F88;&#x591A;&#x63A7;&#x4EF6;&#x672C;&#x8EAB;&#x4E0D;&#x652F;&#x6301;<code>KVO</code>&#xFF0C;&#x800C;<code>ReactiveCocoa</code>&#x672C;&#x8EAB;&#x662F;&#x57FA;&#x4E8E;<code>KVO</code>&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x53CC;&#x5411;&#x7ED1;&#x5B9A;&#x4E0D;&#x6210;&#x529F;&#x7684;&#x73B0;&#x8C61;&#x3002;</p>
<ul>
<li><code>self.valueTextField.rac_newTextChannel</code> : sends values when you type in the text field, but not when you change the text in the text field from code.</li>
<li><code>RACChannelTo(self.valueTextField, text)</code> : sends values when you change the text in the text field from code, but not when you type in the text field.</li>
</ul>
<pre><code class="lang-objc">RACChannelTo(<span class="hljs-keyword">self</span>.viewModel,leftString) = <span class="hljs-keyword">self</span>.leftTextField.rac_newTextChannel;
</code></pre>
<p><img src="../assets/images/iOS/rac/19.gif"></p>
<h3 id="tableviewcelluitextfield"><a name="tableviewcelluitextfield" class="plugin-anchor" href="#tableviewcelluitextfield"><i class="fa fa-link" aria-hidden="true"></i></a><a name="tableviewcelluitextfield" class="anchor-navigation-ex-anchor" href="#tableviewcelluitextfield"><i class="fa fa-link" aria-hidden="true"></i></a>12.4.1. TableViewCell&amp;UITextField</h3>
<p><img src="../assets/images/iOS/rac/20.gif"></p>
<pre><code class="lang-objc"><span class="hljs-meta">#pragma mark - ====================VM&#x5C42;====================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">TextFieldAndTableCellViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">copy</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">NSString</span> *leftString;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">copy</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">NSString</span> *rightString;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">NSArray</span>&lt;TextFieldAndTableViewCellViewModel*&gt; *dataArray;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">TextFieldAndTableCellViewModel</span></span>
-(<span class="hljs-built_in">NSArray</span> *)dataArray{
    <span class="hljs-keyword">if</span> (!_dataArray) {
        <span class="hljs-built_in">NSMutableArray</span> *tempt = [<span class="hljs-built_in">NSMutableArray</span> array];
        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">NSInteger</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">10</span>; i++) {
            TextFieldAndTableViewCellViewModel *data = [[TextFieldAndTableViewCellViewModel alloc] init];
            data.tag = i;
            [tempt addObject:data];
        }
        _dataArray = [<span class="hljs-built_in">NSArray</span> arrayWithArray:tempt];
    }
    <span class="hljs-keyword">return</span> _dataArray;
}
<span class="hljs-keyword">@end</span>

<span class="hljs-meta">#pragma mark - ====================V&#x5C42;====================</span>

<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">TextFieldAndTableCellViewController</span> ()&lt;<span class="hljs-title">UITableViewDataSource</span>, <span class="hljs-title">UITableViewDelegate</span>&gt;</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITableView</span> *tableView;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITextField</span> *leftTextField;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITextField</span> *rightTextField;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UILabel</span> *textLabel;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *clickButton;

<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) TextFieldAndTableCellViewModel *viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">TextFieldAndTableCellViewController</span></span>
<span class="hljs-meta">#pragma mark - life cycle</span>
- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];

    [<span class="hljs-keyword">self</span> segInitViews];
    [<span class="hljs-keyword">self</span> bindViewModel];
    [<span class="hljs-keyword">self</span>.tableView reloadData];
}
<span class="hljs-meta">#pragma mark - Init Views</span>
-(<span class="hljs-keyword">void</span>)segInitViews{
    <span class="hljs-keyword">self</span>.tableView.delegate = <span class="hljs-keyword">self</span>;
    <span class="hljs-keyword">self</span>.tableView.dataSource = <span class="hljs-keyword">self</span>;
}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateViewConstraints {
    [<span class="hljs-keyword">super</span> updateViewConstraints];
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    [[<span class="hljs-keyword">self</span>.clickButton rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
        [<span class="hljs-keyword">self</span>.tableView endEditing:<span class="hljs-literal">YES</span>];
        <span class="hljs-keyword">for</span> (TextFieldAndTableViewCellViewModel *object <span class="hljs-keyword">in</span> <span class="hljs-keyword">self</span>.viewModel.dataArray) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;inputValue %@&quot;</span>,object.inputValue);
        }
    }];
}

<span class="hljs-meta">#pragma mark - getter</span>
-(TextFieldAndTableCellViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[TextFieldAndTableCellViewModel alloc]init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}

<span class="hljs-meta">#pragma mark setter</span>

<span class="hljs-meta">#pragma mark - ====================delegate====================</span>

<span class="hljs-meta">#pragma mark - UITableViewDataSource</span>
- (<span class="hljs-built_in">NSInteger</span>)numberOfSectionsInTableView:(<span class="hljs-built_in">UITableView</span> *)tableView {
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
}
- (<span class="hljs-built_in">NSInteger</span>)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="hljs-built_in">NSInteger</span>)section {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>.viewModel.dataArray.count;
}
- (<span class="hljs-built_in">UITableViewCell</span> *)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="hljs-built_in">NSIndexPath</span> *)indexPath {
    TextFieldAndTableViewCell *cell = [TextFieldAndTableViewCell cellWithTableView:tableView indexPath:indexPath];
    cell.viewModel = <span class="hljs-keyword">self</span>.viewModel.dataArray[indexPath.row];
    <span class="hljs-keyword">return</span> cell;
}
<span class="hljs-meta">#pragma mark - UITableViewDelegate</span>
- (<span class="hljs-built_in">CGFloat</span>)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="hljs-built_in">NSIndexPath</span> *)indexPath {
    <span class="hljs-keyword">return</span> <span class="hljs-number">50</span>;
}
<span class="hljs-keyword">@end</span>
</code></pre>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">TextFieldAndTableViewCell</span> : <span class="hljs-title">UITableViewCell</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">UITextField</span> *inputTextField;

<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">NSIndexPath</span> *indexPath;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>,<span class="hljs-keyword">strong</span>) TextFieldAndTableViewCellViewModel* viewModel;

+(<span class="hljs-built_in">NSString</span>*)reuseIdentifier;
+(TextFieldAndTableViewCell*)cellWithTableView:(<span class="hljs-built_in">UITableView</span>*)tableView indexPath:(<span class="hljs-built_in">NSIndexPath</span>*)indexPath;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">TextFieldAndTableViewCell</span></span>
<span class="hljs-meta">#pragma mark - Init Views</span>
+(<span class="hljs-built_in">NSString</span>*)reuseIdentifier{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">NSStringFromClass</span>([<span class="hljs-keyword">self</span> class]);
}

+(TextFieldAndTableViewCell*)cellWithTableView:(<span class="hljs-built_in">UITableView</span>*)tableView indexPath:(<span class="hljs-built_in">NSIndexPath</span>*)indexPath{
    TextFieldAndTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:[<span class="hljs-keyword">self</span> reuseIdentifier] forIndexPath:indexPath];
    <span class="hljs-keyword">if</span> (!cell) {
        cell = [[TextFieldAndTableViewCell alloc] initWithStyle:<span class="hljs-built_in">UITableViewCellStyleDefault</span> reuseIdentifier:[<span class="hljs-keyword">self</span> reuseIdentifier]];
    }
    cell.indexPath = indexPath;
    <span class="hljs-keyword">return</span> cell;
}

-(instancetype)initWithStyle:(<span class="hljs-built_in">UITableViewCellStyle</span>)style reuseIdentifier:(<span class="hljs-built_in">NSString</span> *)reuseIdentifier{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> == [<span class="hljs-keyword">super</span> initWithStyle:style reuseIdentifier:reuseIdentifier]) {
        [<span class="hljs-keyword">self</span> segInitViews];
        [<span class="hljs-keyword">self</span> updateConstraints];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}

-(<span class="hljs-keyword">void</span>)segInitViews{
    [<span class="hljs-keyword">self</span>.contentView addSubview:<span class="hljs-keyword">self</span>.inputTextField];
}

<span class="hljs-meta">#pragma mark - Layout</span>
- (<span class="hljs-keyword">void</span>)updateConstraints {
    [<span class="hljs-keyword">self</span>.inputTextField mas_makeConstraints:^(MASConstraintMaker *make) {
        make.left.top.equalTo(<span class="hljs-keyword">self</span>.contentView).mas_offset(<span class="hljs-number">5</span>);
        make.right.bottom.equalTo(<span class="hljs-keyword">self</span>.contentView).mas_offset(<span class="hljs-number">-5</span>);
    }];
    [<span class="hljs-keyword">super</span> updateConstraints];
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    <span class="hljs-keyword">self</span>.inputTextField.text = <span class="hljs-keyword">self</span>.viewModel.inputValue;
    <span class="hljs-keyword">self</span>.inputTextField.tag = <span class="hljs-keyword">self</span>.viewModel.tag;

    @weakify(<span class="hljs-keyword">self</span>)
    [[[[<span class="hljs-keyword">self</span>.inputTextField rac_textSignal] takeUntil:<span class="hljs-keyword">self</span>.rac_prepareForReuseSignal] filter:^<span class="hljs-built_in">BOOL</span>(<span class="hljs-built_in">NSString</span> * _Nullable value) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;filter -- %@&quot;</span>, value);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">YES</span>;
    }] subscribeNext:^(<span class="hljs-built_in">NSString</span> * _Nullable x) {
        @strongify(<span class="hljs-keyword">self</span>);
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext %@ tag:%zd&quot;</span>,x,<span class="hljs-keyword">self</span>.inputTextField.tag);
        <span class="hljs-keyword">self</span>.viewModel.inputValue = x;
    }];
}

<span class="hljs-meta">#pragma mark - getter</span>

<span class="hljs-meta">#pragma mark setter</span>
-(<span class="hljs-keyword">void</span>)setViewModel:(TextFieldAndTableViewCellViewModel *)viewModel{
    _viewModel = viewModel;
    <span class="hljs-keyword">if</span> (!viewModel)  <span class="hljs-keyword">return</span>;
    [<span class="hljs-keyword">self</span> bindViewModel];
}

-(<span class="hljs-built_in">UITextField</span> *)inputTextField{
    <span class="hljs-keyword">if</span> (!_inputTextField) {
        _inputTextField = [[<span class="hljs-built_in">UITextField</span> alloc] init];
        _inputTextField.font = [<span class="hljs-built_in">UIFont</span> systemFontOfSize:<span class="hljs-number">16</span>];
        _inputTextField.textColor = [<span class="hljs-built_in">UIColor</span> blackColor];
        _inputTextField.tintColor = [<span class="hljs-built_in">UIColor</span> blackColor];
    }
    <span class="hljs-keyword">return</span> _inputTextField;
}
<span class="hljs-keyword">@end</span>
</code></pre>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">TextFieldAndTableViewCellViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">copy</span>) <span class="hljs-built_in">NSString</span> *inputValue;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">assign</span>) <span class="hljs-built_in">NSInteger</span> tag;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">TextFieldAndTableViewCellViewModel</span></span>
<span class="hljs-meta">#pragma mark - Init</span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> racInit];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
<span class="hljs-meta">#pragma mark - business</span>
- (<span class="hljs-keyword">void</span>)racInit {
}
<span class="hljs-meta">#pragma mark - getter</span>

<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<h2 id="&#x793A;&#x4F8B;&#xFF1A;&#x767B;&#x5F55;"><a name="&#x793A;&#x4F8B;&#xFF1A;&#x767B;&#x5F55;" class="plugin-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;&#x767B;&#x5F55;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x793A;&#x4F8B;&#xFF1A;&#x767B;&#x5F55;" class="anchor-navigation-ex-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;&#x767B;&#x5F55;"><i class="fa fa-link" aria-hidden="true"></i></a>12.5. &#x793A;&#x4F8B;&#xFF1A;&#x767B;&#x5F55;</h2>
<pre><code class="lang-objc"><span class="hljs-comment">/*================================================&#x5B8F;================================================*/</span>
<span class="hljs-meta">#define GreenBgColor [UIColor colorWithRed:0.8 green:1.0 blue:0.8 alpha:1]</span>
<span class="hljs-meta">#define RedBgColor   [UIColor colorWithRed:1.0 green:0.8 blue:0.8 alpha:1]</span>
<span class="hljs-meta">#define WhiteBgColor [UIColor whiteColor]</span>
<span class="hljs-meta">#define ConvertInputStateToColor(signal) [InputStateToColorConverter convert:signal]</span>
<span class="hljs-meta">#define ConvertTextToInputState(signal, minimum, maximum) [TextToInputStateConverter convert:signal m##inimum:minimum m##aximum:maximum]</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> : <span class="hljs-built_in">NSUInteger</span> {
    InputStateEmpty,
    InputStateValid,
    InputStateInvalid
} InputState;

<span class="hljs-comment">/*================================================V&#x5C42;-InputStateToColorConverter================================================*/</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">InputStateToColorConverter</span> : <span class="hljs-title">NSObject</span></span>
+ (RACSignal *)convert:(RACSignal *)signal;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">InputStateToColorConverter</span></span>
+ (RACSignal *)convert:(RACSignal *)signal{
    <span class="hljs-keyword">return</span> [signal map:^<span class="hljs-keyword">id</span>(<span class="hljs-built_in">NSNumber</span> *inputStateNumber) {
        InputState inputState = [inputStateNumber unsignedIntegerValue];
        <span class="hljs-keyword">switch</span> (inputState) {
            <span class="hljs-keyword">case</span> InputStateValid:
                <span class="hljs-keyword">return</span> GreenBgColor;
            <span class="hljs-keyword">case</span> InputStateInvalid:
                <span class="hljs-keyword">return</span> RedBgColor;
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> WhiteBgColor;
        }
    }];
}
<span class="hljs-keyword">@end</span>
<span class="hljs-comment">/*================================================V&#x5C42;-TextToInputStateConverter================================================*/</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">TextToInputStateConverter</span> : <span class="hljs-title">NSObject</span></span>
+ (RACSignal *)convert:(RACSignal *)signal minimum:(<span class="hljs-built_in">NSInteger</span>)minimum maximum:(<span class="hljs-built_in">NSInteger</span>)maximum;
+ (InputState)inputStateForText:(<span class="hljs-built_in">NSString</span> *)text minimum:(<span class="hljs-built_in">NSInteger</span>)minimum maximum:(<span class="hljs-built_in">NSInteger</span>)maximum;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">TextToInputStateConverter</span></span>
+ (RACSignal *)convert:(RACSignal *)signal minimum:(<span class="hljs-built_in">NSInteger</span>)minimum maximum:(<span class="hljs-built_in">NSInteger</span>)maximum{
    <span class="hljs-built_in">NSAssert</span>(minimum &gt; <span class="hljs-number">0</span>, <span class="hljs-string">@&quot;TextToInputStateConverter: minimum must be greater than zero&quot;</span>);
    <span class="hljs-built_in">NSAssert</span>(maximum &gt;= minimum, <span class="hljs-string">@&quot;TextToInputStateConverter: maximum must be greater than or equal to minimum&quot;</span>);
    <span class="hljs-keyword">return</span> [signal map:^<span class="hljs-keyword">id</span>(<span class="hljs-built_in">NSString</span> *text) {
        <span class="hljs-keyword">return</span> @([TextToInputStateConverter inputStateForText:text minimum:minimum maximum:maximum]);
    }];
}
+ (InputState)inputStateForText:(<span class="hljs-built_in">NSString</span> *)text minimum:(<span class="hljs-built_in">NSInteger</span>)minimum maximum:(<span class="hljs-built_in">NSInteger</span>)maximum{
    <span class="hljs-keyword">if</span> ([text length] &gt;= minimum &amp;&amp; [text length] &lt;= maximum) {
        <span class="hljs-keyword">return</span> InputStateValid;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> ([text length] == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> InputStateEmpty;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> InputStateInvalid;
        }
    }
}
<span class="hljs-keyword">@end</span>
<span class="hljs-meta">#pragma mark - ====================VM&#x5C42;====================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">LoginViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">copy</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">NSString</span> *usename;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">copy</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">NSString</span> *password;

<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">assign</span>, <span class="hljs-keyword">readonly</span>) InputState usernameInputState;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">assign</span>, <span class="hljs-keyword">readonly</span>) InputState passwordInputState;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">assign</span>, <span class="hljs-keyword">readonly</span>) <span class="hljs-built_in">BOOL</span> loginEnabled;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">LoginViewModel</span>()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">assign</span>, <span class="hljs-keyword">readwrite</span>) InputState usernameInputState;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">assign</span>, <span class="hljs-keyword">readwrite</span>) InputState passwordInputState;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">assign</span>, <span class="hljs-keyword">readwrite</span>) <span class="hljs-built_in">BOOL</span> loginEnabled;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">LoginViewModel</span></span>
<span class="hljs-meta">#pragma mark - Init</span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> racInit];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
<span class="hljs-meta">#pragma mark - business</span>
- (<span class="hljs-keyword">void</span>)racInit {
    RAC(<span class="hljs-keyword">self</span>,usernameInputState) = ConvertTextToInputState(RACObserve(<span class="hljs-keyword">self</span>,usename), <span class="hljs-number">2</span>, <span class="hljs-number">4</span>);
    RAC(<span class="hljs-keyword">self</span>,passwordInputState) = ConvertTextToInputState(RACObserve(<span class="hljs-keyword">self</span>,password), <span class="hljs-number">5</span>, <span class="hljs-number">10</span>);

    RAC(<span class="hljs-keyword">self</span>,loginEnabled) = [RACSignal combineLatest:@[RACObserve(<span class="hljs-keyword">self</span>,usernameInputState),RACObserve(<span class="hljs-keyword">self</span>,passwordInputState)] reduce:^<span class="hljs-keyword">id</span>(<span class="hljs-built_in">NSNumber</span> *usernameInputStateValue,<span class="hljs-built_in">NSNumber</span> *passwordInputStateValue){
        <span class="hljs-keyword">if</span> ([usernameInputStateValue unsignedIntegerValue] == InputStateValid &amp;&amp;
            [passwordInputStateValue unsignedIntegerValue] == InputStateValid) {
            <span class="hljs-keyword">return</span> @(<span class="hljs-literal">YES</span>);
        }
        <span class="hljs-keyword">return</span> @(<span class="hljs-literal">NO</span>);
    }];
}

<span class="hljs-meta">#pragma mark - getter</span>

<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>

<span class="hljs-meta">#pragma mark - ====================V&#x5C42;====================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">LoginViewController</span> ()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITextField</span> *usenameTextField;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITextField</span> *passwordTextFeidl;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *loginButton;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) LoginViewModel *viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">LoginViewController</span></span>
- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    [<span class="hljs-keyword">self</span> segInitViews];
    [<span class="hljs-keyword">self</span> bindViewModel];
}

<span class="hljs-meta">#pragma mark - Init Views</span>
-(<span class="hljs-keyword">void</span>)segInitViews{
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    <span class="hljs-comment">// bind input signals</span>
    RAC(<span class="hljs-keyword">self</span>.viewModel,usename) = <span class="hljs-keyword">self</span>.usenameTextField.rac_textSignal;
    RAC(<span class="hljs-keyword">self</span>.viewModel,password) = <span class="hljs-keyword">self</span>.passwordTextFeidl.rac_textSignal;
    <span class="hljs-comment">// bind output signals</span>
    RAC(<span class="hljs-keyword">self</span>.usenameTextField,backgroundColor) = ConvertInputStateToColor(RACObserve(<span class="hljs-keyword">self</span>.viewModel, usernameInputState));
    RAC(<span class="hljs-keyword">self</span>.passwordTextFeidl,backgroundColor) = ConvertInputStateToColor(RACObserve(<span class="hljs-keyword">self</span>.viewModel, passwordInputState));
    RAC(<span class="hljs-keyword">self</span>.loginButton, enabled) = RACObserve(<span class="hljs-keyword">self</span>.viewModel, loginEnabled);
    [[<span class="hljs-keyword">self</span>.loginButton rac_signalForControlEvents:<span class="hljs-built_in">UIControlEventTouchUpInside</span>] subscribeNext:^(__kindof <span class="hljs-built_in">UIControl</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Login....&quot;</span>);
    }];
}

<span class="hljs-meta">#pragma mark - getter</span>
-(LoginViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[LoginViewModel alloc]init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<p><img src="../assets/images/iOS/rac/14.gif"></p>
<h2 id="&#x793A;&#x4F8B;&#xFF1A;&#x8C46;&#x74E3;&#x5217;&#x8868;"><a name="&#x793A;&#x4F8B;&#xFF1A;&#x8C46;&#x74E3;&#x5217;&#x8868;" class="plugin-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;&#x8C46;&#x74E3;&#x5217;&#x8868;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x793A;&#x4F8B;&#xFF1A;&#x8C46;&#x74E3;&#x5217;&#x8868;" class="anchor-navigation-ex-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;&#x8C46;&#x74E3;&#x5217;&#x8868;"><i class="fa fa-link" aria-hidden="true"></i></a>12.6. &#x793A;&#x4F8B;&#xFF1A;&#x8C46;&#x74E3;&#x5217;&#x8868;</h2>
<pre><code class="lang-objc"><span class="hljs-meta">#pragma mark - ====================VM&#x5C42;====================</span>
<span class="hljs-comment">//&#x5B9A;&#x4E49;&#x547D;&#x4EE4;&#x3001;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x3001;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x3001;&#x53D1;&#x9001;&#x6570;&#x636E;</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">DouBanDetailViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">copy</span>, <span class="hljs-keyword">readonly</span>) <span class="hljs-built_in">NSArray</span>&lt;<span class="hljs-built_in">NSString</span>*&gt; *movies;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) RACCommand *requestCommand;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) AFHTTPSessionManager *manager;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">DouBanDetailViewModel</span></span>
<span class="hljs-meta">#pragma mark - Init</span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        _manager = [[AFHTTPSessionManager alloc] initWithBaseURL:[<span class="hljs-built_in">NSURL</span> URLWithString:<span class="hljs-string">@&quot;https://api.douban.com&quot;</span>]];
        [<span class="hljs-keyword">self</span> racInit];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
<span class="hljs-meta">#pragma mark - business</span>
- (<span class="hljs-keyword">void</span>)racInit {
    @weakify(<span class="hljs-keyword">self</span>)
    _requestCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal * _Nonnull(<span class="hljs-keyword">id</span>  _Nullable input) {
        <span class="hljs-comment">// &#x7F51;&#x7EDC;&#x8BF7;&#x6C42;</span>
        RACSignal *requestSignal = [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
            @strongify(<span class="hljs-keyword">self</span>)
            [<span class="hljs-keyword">self</span>.manager GET:<span class="hljs-string">@&quot;/v2/movie/in_theaters&quot;</span> parameters:input progress:<span class="hljs-literal">nil</span> success:^(<span class="hljs-built_in">NSURLSessionDataTask</span> * _Nonnull task, <span class="hljs-keyword">id</span>  _Nullable responseObject) {
                <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;sendNext&quot;</span>);
                [subscriber sendNext:responseObject];
                [subscriber sendCompleted];
            } failure:^(<span class="hljs-built_in">NSURLSessionDataTask</span> * _Nullable task, <span class="hljs-built_in">NSError</span> * _Nonnull error) {
                [subscriber sendError:error];
                <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;sendError&quot;</span>);
            }];
            <span class="hljs-keyword">return</span> [RACDisposable disposableWithBlock:^{
                <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;disposableWithBlock&quot;</span>);
            }];
        }];
        <span class="hljs-comment">// &#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x5904;&#x7406;</span>
        <span class="hljs-keyword">return</span> [requestSignal map:^<span class="hljs-keyword">id</span> _Nullable(<span class="hljs-keyword">id</span>  _Nullable value) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;map&quot;</span>);
            <span class="hljs-built_in">NSMutableArray</span> *tempt = [<span class="hljs-built_in">NSMutableArray</span> array];
            <span class="hljs-built_in">NSMutableArray</span> *dictArray = value[<span class="hljs-string">@&quot;subjects&quot;</span>];
            <span class="hljs-keyword">for</span> (<span class="hljs-built_in">NSDictionary</span> *object <span class="hljs-keyword">in</span> dictArray) {
                [tempt addObject:[object valueForKey:<span class="hljs-string">@&quot;title&quot;</span>]];
            }
            <span class="hljs-keyword">self</span>-&gt;_movies = [<span class="hljs-built_in">NSArray</span> arrayWithArray:tempt];;
            <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
        }];
    }];
}
<span class="hljs-meta">#pragma mark - getter</span>
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
<span class="hljs-meta">#pragma mark - ====================V&#x5C42;====================</span>

<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">DouBanViewDetailController</span> ()&lt;<span class="hljs-title">UITableViewDataSource</span>,<span class="hljs-title">UITableViewDelegate</span>&gt;</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITableView</span> *tableView;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) DouBanDetailViewModel *viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">DouBanViewDetailController</span></span>

- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    [<span class="hljs-keyword">self</span> segInitViews];
    [<span class="hljs-keyword">self</span> bindViewModel];
}

<span class="hljs-meta">#pragma mark - Init Views</span>
-(<span class="hljs-keyword">void</span>)segInitViews{
    <span class="hljs-keyword">self</span>.tableView.delegate = <span class="hljs-keyword">self</span>;
    <span class="hljs-keyword">self</span>.tableView.dataSource = <span class="hljs-keyword">self</span>;
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    @weakify(<span class="hljs-keyword">self</span>)
    [[[<span class="hljs-keyword">self</span>.viewModel.requestCommand executionSignals] switchToLatest] subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        @strongify(<span class="hljs-keyword">self</span>)
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;switchToLatest:%@&quot;</span>,x);
        [<span class="hljs-keyword">self</span>.tableView reloadData];
        [SVProgressHUD dismiss];
    }];

    [<span class="hljs-keyword">self</span>.viewModel.requestCommand.errors subscribeNext:^(<span class="hljs-built_in">NSError</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;errors subscribeNext:%@&quot;</span>,x);
        [SVProgressHUD dismiss];
    }];

    <span class="hljs-comment">// &#x53D1;&#x8D77;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;</span>
    <span class="hljs-built_in">NSMutableDictionary</span> *parameters = [<span class="hljs-built_in">NSMutableDictionary</span> dictionary];
    parameters[<span class="hljs-string">@&quot;apikey&quot;</span>] = <span class="hljs-string">@&quot;0df993c66c0c636e29ecbb5344252a4a&quot;</span>;
    [<span class="hljs-keyword">self</span>.viewModel.requestCommand execute:parameters];
    [SVProgressHUD show];
}

<span class="hljs-comment">// &#x6216;&#x8005;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    @weakify(<span class="hljs-keyword">self</span>)
    [[<span class="hljs-keyword">self</span>.viewModel.requestCommand executionSignals] subscribeNext:^(RACSignal*  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext1:%@&quot;</span>,x);
        [SVProgressHUD show];
        [x subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
            @strongify(<span class="hljs-keyword">self</span>)
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeNext2:%@&quot;</span>,x);
            [<span class="hljs-keyword">self</span>.tableView reloadData];
            [SVProgressHUD dismiss];
        }];
    }];

    [<span class="hljs-keyword">self</span>.viewModel.requestCommand.errors subscribeNext:^(<span class="hljs-built_in">NSError</span> * _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;errors subscribeNext:%@&quot;</span>,x);
        [SVProgressHUD dismiss];
    }];
    <span class="hljs-comment">// &#x53D1;&#x8D77;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;</span>
    <span class="hljs-built_in">NSMutableDictionary</span> *parameters = [<span class="hljs-built_in">NSMutableDictionary</span> dictionary];
    parameters[<span class="hljs-string">@&quot;apikey&quot;</span>] = <span class="hljs-string">@&quot;0df993c66c0c636e29ecbb5344252a4a&quot;</span>;
    [<span class="hljs-keyword">self</span>.viewModel.requestCommand execute:parameters];
}

<span class="hljs-meta">#pragma mark - UITableViewDataSource</span>

- (<span class="hljs-built_in">NSInteger</span>)numberOfSectionsInTableView:(<span class="hljs-built_in">UITableView</span> *)tableView {
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
}

- (<span class="hljs-built_in">NSInteger</span>)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="hljs-built_in">NSInteger</span>)section {

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>.viewModel.movies.count;
}

-(<span class="hljs-built_in">CGFloat</span>)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="hljs-built_in">NSIndexPath</span> *)indexPath{
    <span class="hljs-keyword">return</span> <span class="hljs-number">44.0</span>;
}

- (<span class="hljs-built_in">UITableViewCell</span> *)tableView:(<span class="hljs-built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="hljs-built_in">NSIndexPath</span> *)indexPath {
    DouBanDetailTableViewCell *cell = [DouBanDetailTableViewCell cellWithTableView:tableView indexPath:indexPath];
    cell.textLabel.text = <span class="hljs-keyword">self</span>.viewModel.movies[indexPath.row];
    <span class="hljs-keyword">return</span> cell;
}

<span class="hljs-meta">#pragma mark - getter</span>
-(DouBanDetailViewModel *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[DouBanDetailViewModel alloc]init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<p><img src="../assets/images/iOS/rac/13.gif"></p>
<h2 id="raccommand&#x4E2D;&#x7684;senderror&#x6CA1;&#x53CD;&#x5E94;&#x7684;&#x89E3;&#x7B54;"><a name="raccommand&#x4E2D;&#x7684;senderror&#x6CA1;&#x53CD;&#x5E94;&#x7684;&#x89E3;&#x7B54;" class="plugin-anchor" href="#raccommand&#x4E2D;&#x7684;senderror&#x6CA1;&#x53CD;&#x5E94;&#x7684;&#x89E3;&#x7B54;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="raccommand&#x4E2D;&#x7684;senderror&#x6CA1;&#x53CD;&#x5E94;&#x7684;&#x89E3;&#x7B54;" class="anchor-navigation-ex-anchor" href="#raccommand&#x4E2D;&#x7684;senderror&#x6CA1;&#x53CD;&#x5E94;&#x7684;&#x89E3;&#x7B54;"><i class="fa fa-link" aria-hidden="true"></i></a>12.7. RACCommand&#x4E2D;&#x7684;sendError&#x6CA1;&#x53CD;&#x5E94;&#x7684;&#x89E3;&#x7B54;</h2>
<ul>
<li><a href="https://blog.harrisonxi.com/2017/09/RAC%E4%B8%AD%E7%94%A8RACCommand%E5%A4%84%E7%90%86%E6%8C%87%E4%BB%A4.html" target="_blank">RAC&#x4E2D;&#x7528;RACCommand&#x5904;&#x7406;&#x6307;&#x4EE4;</a></li>
</ul>
<pre><code class="lang-objc"><span class="hljs-comment">// &#x8FD9;&#x6837;&#x4F7F;&#x7528;&#x5C31;&#x53EF;&#x4EE5;&#x6355;&#x6349;&#x5230;Error&#x4E86;&#x3002;</span>
[<span class="hljs-keyword">self</span>.viewModel.requestCommand.errors subscribeNext:^(<span class="hljs-built_in">NSError</span> * _Nullable x) {
     <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;errors subscribeNext:%@&quot;</span>,x);
}];
</code></pre>
<h2 id="&#x793A;&#x4F8B;&#x591A;&#x63A5;&#x53E3;&#x8BF7;&#x6C42;"><a name="&#x793A;&#x4F8B;&#x591A;&#x63A5;&#x53E3;&#x8BF7;&#x6C42;" class="plugin-anchor" href="#&#x793A;&#x4F8B;&#x591A;&#x63A5;&#x53E3;&#x8BF7;&#x6C42;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x793A;&#x4F8B;&#x591A;&#x63A5;&#x53E3;&#x8BF7;&#x6C42;" class="anchor-navigation-ex-anchor" href="#&#x793A;&#x4F8B;&#x591A;&#x63A5;&#x53E3;&#x8BF7;&#x6C42;"><i class="fa fa-link" aria-hidden="true"></i></a>12.8. &#x793A;&#x4F8B;:&#x591A;&#x63A5;&#x53E3;&#x8BF7;&#x6C42;</h2>
<pre><code class="lang-objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">DouBanDetailViewModel</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>, <span class="hljs-keyword">readonly</span>) RACCommand *requestCommand;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">DouBanDetailViewModel</span></span>
<span class="hljs-meta">#pragma mark - Init</span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> = [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> racInit];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
<span class="hljs-meta">#pragma mark - business</span>
- (<span class="hljs-keyword">void</span>)racInit {
    _requestCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal * _Nonnull(<span class="hljs-keyword">id</span>  _Nullable input) {
        <span class="hljs-comment">//&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;1</span>
        RACSignal *signal1 = [RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;1&quot;</span>);
            [subscriber sendNext:<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;1&quot;</span>];
            <span class="hljs-keyword">return</span>  <span class="hljs-literal">nil</span>;
        }];

        <span class="hljs-comment">//&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;2</span>
        RACSignal *signal2 = [RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;2&quot;</span>);
            [subscriber sendNext:<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;2&quot;</span>];
            <span class="hljs-keyword">return</span>  <span class="hljs-literal">nil</span>;
        }];

        <span class="hljs-comment">//&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;3</span>
        RACSignal *signal3 = [RACSignal createSignal:^RACDisposable *(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt; subscriber) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;3&quot;</span>);
            [subscriber sendNext:<span class="hljs-string">@&quot;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;3&quot;</span>];
            <span class="hljs-keyword">return</span>  <span class="hljs-literal">nil</span>;
        }];

        <span class="hljs-keyword">return</span> [<span class="hljs-keyword">self</span> rac_liftSelector:<span class="hljs-keyword">@selector</span>(dealDataWithData1:data2:data3:) withSignalsFromArray:@[signal1,signal2,signal3]];
    }];
}

-(<span class="hljs-keyword">void</span>)dealDataWithData1:(<span class="hljs-keyword">id</span>)data1 data2:(<span class="hljs-keyword">id</span>)data2 data3:(<span class="hljs-keyword">id</span>)data3{}
<span class="hljs-meta">#pragma mark - getter</span>
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>
</code></pre>
<p>V&#x5C42;&#x4F7F;&#x7528;&#xFF1A;</p>
<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)bindViewModel {
    <span class="hljs-comment">// &#x53D1;&#x8D77;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;</span>
    <span class="hljs-built_in">NSMutableDictionary</span> *parameters = [<span class="hljs-built_in">NSMutableDictionary</span> dictionary];
    parameters[<span class="hljs-string">@&quot;q&quot;</span>] = _conditions;
    parameters[<span class="hljs-string">@&quot;apikey&quot;</span>] = <span class="hljs-string">@&quot;0df993c66c0c636e29ecbb5344252a4a&quot;</span>;
    [<span class="hljs-keyword">self</span>.viewModel.requestCommand execute:parameters];
    [SVProgressHUD show];

    [<span class="hljs-keyword">self</span>.viewModel.requestCommand.executionSignals.switchToLatest subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        [<span class="hljs-keyword">self</span>.tableView reloadData];
        [SVProgressHUD dismiss];
    }];
    [<span class="hljs-keyword">self</span>.viewModel.requestCommand.executionSignals subscribeError:^(<span class="hljs-built_in">NSError</span> * _Nullable error) {
        [SVProgressHUD dismiss];
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;subscribeError&quot;</span>);
    }];
    [[[<span class="hljs-keyword">self</span>.viewModel.requestCommand executing] skip:<span class="hljs-number">1</span>] subscribeNext:^(<span class="hljs-built_in">NSNumber</span> * _Nullable x) {
    }];
}
</code></pre>
<h2 id="&#x793A;&#x4F8B;&#xFF1A;rac&#x3001;distinctuntilchanged"><a name="&#x793A;&#x4F8B;&#xFF1A;rac&#x3001;distinctuntilchanged" class="plugin-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;rac&#x3001;distinctuntilchanged"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x793A;&#x4F8B;&#xFF1A;rac&#x3001;distinctuntilchanged" class="anchor-navigation-ex-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;rac&#x3001;distinctuntilchanged"><i class="fa fa-link" aria-hidden="true"></i></a>12.9. &#x793A;&#x4F8B;&#xFF1A;RAC&#x3001;distinctUntilChanged</h2>
<pre><code class="lang-objc"><span class="hljs-comment">/*==================================VM&#x5C42;======================================*/</span> 
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">RACAndMVVMViewModel01</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-comment">// KVO TextField&#x8F93;&#x5165;&#x503C;</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-built_in">NSString</span> *searchText;
<span class="hljs-comment">//&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7ED1;&#x5B9A;View&#x7684;&#x6307;&#x4EE4;.RACCommand&#x662F;ReactiveCocoa&#x4E2D;&#x5448;&#x73B0;UI&#x52A8;&#x4F5C;&#x7684;&#x7EC4;&#x4EF6;.&#x5B83;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6765;&#x8868;&#x793A;UI&#x52A8;&#x4F5C;&#x7ED3;&#x679C;&#x3001;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x3001;&#x6807;&#x660E;&#x52A8;&#x4F5C;&#x662F;&#x5426;&#x88AB;&#x6267;&#x884C;&#x7684;&#x4FE1;&#x53F7;&#x91CF;.</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) RACCommand *executeSearch;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">RACAndMVVMViewModel01</span></span>
- (instancetype)init {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> == [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> checkSearchText];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
<span class="hljs-comment">// &#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E2D;&#x5C06;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x4F5C;&#x4E3A;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x7684;&#x7ED3;&#x679C;,&#x5E76;&#x4F1A;&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#x5F02;&#x6B65;&#x5730;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;.</span>
<span class="hljs-comment">// &#x76EE;&#x524D;&#x53EA;&#x5B8C;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x7684;&#x6267;&#x884C;&#x60C5;&#x51B5;;&#x7A7A;&#x4FE1;&#x53F7;&#x7ACB;&#x5373;&#x5B8C;&#x6210;.&#x5EF6;&#x8FDF;&#x64CD;&#x4F5C;&#x589E;&#x52A0;&#x4E86;&#x5B8C;&#x6210;&#x4E8B;&#x4EF6;&#x8FD4;&#x56DE;&#x540E;&#x7684;&#x4E24;&#x79D2;&#x5EF6;&#x8FDF;.&#x7528;&#x6765;&#x4F7F;&#x4EE3;&#x7801;&#x770B;&#x8D77;&#x6765;&#x66F4;&#x52A0;&#x771F;&#x5B9E;.</span>
- (RACSignal *)executeSearchSignal {
    <span class="hljs-keyword">return</span> [[[[RACSignal empty] logAll] delay:<span class="hljs-number">2.0</span>] logAll];
}
<span class="hljs-comment">// &#x68C0;&#x67E5; searchText &#x8F93;&#x5165;&#x7684;&#x5408;&#x6CD5;&#x6027;</span>
-(<span class="hljs-keyword">void</span>)checkSearchText{
    <span class="hljs-comment">/*[[RACObserve(self, searchText) map:^id _Nullable(NSString*  _Nullable value) {
     return @(value.length &gt; 3);
     }] subscribeNext:^(id  _Nullable x) {
     NSLog(@&quot;search text is valid %@&quot;, x);
     }];*/</span>

    <span class="hljs-comment">// distinctUntilChanged &#x53EA;&#x6709;&#x8F93;&#x5165;&#x5408;&#x6CD5;&#x624D;&#x80FD;&#x8FDB;&#x884C;&#x6253;&#x5370;</span>
    RACSignal *validSearchSignal = [[RACObserve(<span class="hljs-keyword">self</span>, searchText) map:^<span class="hljs-keyword">id</span> _Nullable(<span class="hljs-built_in">NSString</span>*  _Nullable value) {
        <span class="hljs-keyword">return</span> @(value.length &gt; <span class="hljs-number">3</span>);
    }]distinctUntilChanged];
    [validSearchSignal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;search text is valid %@&quot;</span>, x);
    }];

    <span class="hljs-keyword">self</span>.executeSearch = [[RACCommand alloc] initWithEnabled:validSearchSignal signalBlock:^RACSignal * _Nonnull(<span class="hljs-keyword">id</span>  _Nullable input) {
        <span class="hljs-keyword">return</span> [<span class="hljs-keyword">self</span> executeSearchSignal];
    }];
}
<span class="hljs-comment">/*
2020-05-29 15:57:23.746708+0800 RACExample[90175:12323634] search text is valid 0
2020-05-29 15:57:27.843193+0800 RACExample[90175:12323634] search text is valid 1
2020-05-29 15:57:34.804425+0800 RACExample[90175:12323634] search text is valid 0
*/</span>
<span class="hljs-keyword">@end</span>
<span class="hljs-comment">/*==================================V&#x5C42;======================================*/</span> 
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">RACAndMVVMViewController01</span> ()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *loginButton;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITextField</span> *searchTextField;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">strong</span>, <span class="hljs-keyword">nonatomic</span>) RA<span class="hljs-built_in">CAndMVVMViewModel01</span> *viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">RACAndMVVMViewController01</span></span>
- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    [<span class="hljs-keyword">self</span> bindViewModel];
}

- (<span class="hljs-keyword">void</span>)bindViewModel {
    RAC(<span class="hljs-keyword">self</span>.viewModel,searchText) = <span class="hljs-keyword">self</span>.searchTextField.rac_textSignal;
    <span class="hljs-keyword">self</span>.loginButton.rac_command = <span class="hljs-keyword">self</span>.viewModel.executeSearch;
}

-(RA<span class="hljs-built_in">CAndMVVMViewModel01</span> *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [[RA<span class="hljs-built_in">CAndMVVMViewModel01</span> alloc] init];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
</code></pre>
<p><img src="../assets/images/iOS/rac/11.gif"></p>
<p>&#x5F53;&#x6309;&#x94AE;&#x503C;&#x4E3A;<code>Input</code>&#x65F6;&#xFF0C;&#x6309;&#x94AE;&#x7684;&#x72B6;&#x6001;&#x662F;<code>Disabled</code>&#xFF0C;&#x56E0;&#x4E3A;&#x8F93;&#x5165;&#x7684;&#x5185;&#x5BB9;&#x4E0D;&#x5408;&#x6CD5;&#x3002;</p>
<h2 id="&#x793A;&#x4F8B;&#xFF1A;&#x53D1;&#x90AE;&#x4EF6;"><a name="&#x793A;&#x4F8B;&#xFF1A;&#x53D1;&#x90AE;&#x4EF6;" class="plugin-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;&#x53D1;&#x90AE;&#x4EF6;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x793A;&#x4F8B;&#xFF1A;&#x53D1;&#x90AE;&#x4EF6;" class="anchor-navigation-ex-anchor" href="#&#x793A;&#x4F8B;&#xFF1A;&#x53D1;&#x90AE;&#x4EF6;"><i class="fa fa-link" aria-hidden="true"></i></a>12.10. &#x793A;&#x4F8B;&#xFF1A;&#x53D1;&#x90AE;&#x4EF6;</h2>
<pre><code class="lang-objc"><span class="hljs-meta">#pragma mark - ====================VM&#x5C42;====================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">RACAndMVVMViewModel02</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) <span class="hljs-built_in">NSString</span> *email;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) <span class="hljs-built_in">NSString</span> *statusMessage;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) RACCommand *subscribeCommand;
<span class="hljs-keyword">@end</span>
<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">RACAndMVVMViewModel02</span></span>
-(instancetype)init{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span> == [<span class="hljs-keyword">super</span> init]) {
        [<span class="hljs-keyword">self</span> rac_init];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
}
-(<span class="hljs-keyword">void</span>)rac_init{
    @weakify(<span class="hljs-keyword">self</span>)
    RACSignal *emailSignal = [[RACObserve(<span class="hljs-keyword">self</span>, email) map:^<span class="hljs-keyword">id</span> _Nullable(<span class="hljs-built_in">NSString</span>*  _Nullable value) {
        @strongify(<span class="hljs-keyword">self</span>)
        <span class="hljs-keyword">return</span> @([<span class="hljs-keyword">self</span> isValidEmail:value]);
    }]distinctUntilChanged];

    [emailSignal subscribeNext:^(<span class="hljs-keyword">id</span>  _Nullable x) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;%@&quot;</span>,x);
    }];

    <span class="hljs-keyword">self</span>.subscribeCommand = [[RACCommand alloc] initWithEnabled:emailSignal signalBlock:^RACSignal * _Nonnull(<span class="hljs-keyword">id</span>  _Nullable input) {
        @strongify(<span class="hljs-keyword">self</span>)
        <span class="hljs-keyword">return</span> [<span class="hljs-keyword">self</span> businessOperation:<span class="hljs-keyword">self</span>.email];
    }];

    RACSignal *rac1 = [<span class="hljs-keyword">self</span>.subscribeCommand.executionSignals map:^<span class="hljs-keyword">id</span> _Nullable(<span class="hljs-keyword">id</span>  _Nullable value) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Request&quot;</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">@&quot;Request&quot;</span>;
    }];
    RACSignal *rac2 = [<span class="hljs-keyword">self</span>.subscribeCommand.executionSignals flattenMap:^__kindof RACSignal * _Nullable(RACSignal* signal) {
        <span class="hljs-keyword">return</span> [[[signal materialize]filter:^<span class="hljs-built_in">BOOL</span>(RACEvent *event) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;... RACEventType:%zd&quot;</span>,event.eventType);
            <span class="hljs-keyword">return</span> event.eventType == RACEventTypeCompleted;
        }] map:^<span class="hljs-keyword">id</span> _Nullable(<span class="hljs-keyword">id</span>  _Nullable value) {
            <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Thanks!&quot;</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-string">@&quot;Thanks!&quot;</span>;
        }];
    }];
    RACSignal *rac3 = [[<span class="hljs-keyword">self</span>.subscribeCommand.errors subscribeOn:[RACScheduler mainThreadScheduler]] map:^<span class="hljs-keyword">id</span> _Nullable(<span class="hljs-built_in">NSError</span> * _Nullable value) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Error&quot;</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">@&quot;Error&quot;</span>;
    }];
    RAC(<span class="hljs-keyword">self</span>,statusMessage) = [RACSignal merge:@[rac1,rac2,rac3]];
}

<span class="hljs-comment">// &#x5904;&#x7406;&#x4E1A;&#x52A1;&#x903B;&#x8F91;</span>
-(RACSignal*)businessOperation:(<span class="hljs-built_in">NSString</span>*)content{
    <span class="hljs-keyword">return</span> [RACSignal createSignal:^RACDisposable * _Nullable(<span class="hljs-keyword">id</span>&lt;RACSubscriber&gt;  _Nonnull subscriber) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@&quot;Loading...&quot;</span>);
        [subscriber sendNext:<span class="hljs-string">@&quot;Loading...&quot;</span>];
        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="hljs-number">2.0</span> * <span class="hljs-built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^{
            [subscriber sendError:<span class="hljs-literal">nil</span>];
        });
        <span class="hljs-keyword">return</span> [RACDisposable disposableWithBlock:^{
        }];
    }];
}

<span class="hljs-comment">// &#x68C0;&#x6D4B;strin&#x662F;&#x5426;&#x662F;&#x90AE;&#x4EF6;</span>
- (<span class="hljs-built_in">BOOL</span>)isValidEmail:(<span class="hljs-built_in">NSString</span>*)content {
    <span class="hljs-keyword">if</span> (!content) <span class="hljs-keyword">return</span> <span class="hljs-literal">NO</span>;

    <span class="hljs-built_in">NSString</span> *emailPattern =
    <span class="hljs-string">@&quot;(?:[a-z0-9!#$%\\&amp;&apos;*+/=?\\^_`{|}~-]+(?:\\.[a-z0-9!#$%\\&amp;&apos;*+/=?\\^_`{|}&quot;</span>
    <span class="hljs-string">@&quot;~-]+)*|\&quot;(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\&quot;</span>
    <span class="hljs-string">@&quot;x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\&quot;)@(?:(?:[a-z0-9](?:[a-&quot;</span>
    <span class="hljs-string">@&quot;z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5&quot;</span>
    <span class="hljs-string">@&quot;]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-&quot;</span>
    <span class="hljs-string">@&quot;9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21&quot;</span>
    <span class="hljs-string">@&quot;-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])&quot;</span>;
    <span class="hljs-built_in">NSError</span> *error = <span class="hljs-literal">nil</span>;
    <span class="hljs-built_in">NSRegularExpression</span> *regex = [<span class="hljs-built_in">NSRegularExpression</span> regularExpressionWithPattern:emailPattern options:<span class="hljs-built_in">NSRegularExpressionCaseInsensitive</span> error:&amp;error];
    <span class="hljs-built_in">NSTextCheckingResult</span> *match = [regex firstMatchInString:content options:<span class="hljs-number">0</span> range:<span class="hljs-built_in">NSMakeRange</span>(<span class="hljs-number">0</span>, [content length])];
    <span class="hljs-keyword">return</span> match != <span class="hljs-literal">nil</span>;
}
<span class="hljs-keyword">@end</span>
<span class="hljs-meta">#pragma mark - ====================V&#x5C42;====================</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">RACAndMVVMViewController02</span> ()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UITextField</span> *inputTextField;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UIButton</span> *loginButton;
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">weak</span>, <span class="hljs-keyword">nonatomic</span>) <span class="hljs-keyword">IBOutlet</span> <span class="hljs-built_in">UILabel</span> *statusLabel;
<span class="hljs-keyword">@property</span>(<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) RA<span class="hljs-built_in">CAndMVVMViewModel02</span> *viewModel;
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">RACAndMVVMViewController02</span></span>

- (<span class="hljs-keyword">void</span>)viewDidLoad {
    [<span class="hljs-keyword">super</span> viewDidLoad];
    [<span class="hljs-keyword">self</span> bindViewModel];
}

<span class="hljs-meta">#pragma mark - Private Methods</span>

<span class="hljs-meta">#pragma mark - RAC Data Binding</span>
- (<span class="hljs-keyword">void</span>)bindViewModel {
    RAC(<span class="hljs-keyword">self</span>.viewModel,email) = <span class="hljs-keyword">self</span>.inputTextField.rac_textSignal;
    RAC(<span class="hljs-keyword">self</span>.statusLabel,text) = RACObserve(<span class="hljs-keyword">self</span>.viewModel, statusMessage);
    <span class="hljs-keyword">self</span>.loginButton.rac_command = <span class="hljs-keyword">self</span>.viewModel.subscribeCommand;
}

<span class="hljs-meta">#pragma mark - getter</span>
-(RA<span class="hljs-built_in">CAndMVVMViewModel02</span> *)viewModel{
    <span class="hljs-keyword">if</span> (!_viewModel) {
        _viewModel = [RA<span class="hljs-built_in">CAndMVVMViewModel02</span> new];
    }
    <span class="hljs-keyword">return</span> _viewModel;
}
<span class="hljs-meta">#pragma mark setter</span>
<span class="hljs-keyword">@end</span>

<span class="hljs-comment">/*
2020-05-29 16:58:36.155235+0800 RACExample[92708:12365862] 0
2020-05-29 16:58:40.675972+0800 RACExample[92708:12365862] 1
2020-05-29 16:58:43.872743+0800 RACExample[92708:12365862] Request
2020-05-29 16:58:43.873233+0800 RACExample[92708:12365862] Loading...
2020-05-29 16:58:43.873464+0800 RACExample[92708:12365862] ... RACEventType:2 --&gt; 0 = RACEventTypeNext
2020-05-29 16:58:45.874203+0800 RACExample[92708:12365862] ... RACEventType:0 --&gt; 0 = RACEventTypeCompleted
2020-05-29 16:58:45.874431+0800 RACExample[92708:12365862] Thanks!
2020-05-29 16:58:45.876062+0800 RACExample[92708:12365862] Error
*/</span>
</code></pre>
<p><img src="../assets/images/iOS/rac/12.gif"></p>
<!-- 










 -->
<!--====================================================================================================-->
<!-- 










 -->
<h1 id="&#x8D44;&#x6599;"><a name="&#x8D44;&#x6599;" class="plugin-anchor" href="#&#x8D44;&#x6599;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x8D44;&#x6599;" class="anchor-navigation-ex-anchor" href="#&#x8D44;&#x6599;"><i class="fa fa-link" aria-hidden="true"></i></a>13. &#x8D44;&#x6599;</h1>
<ul>
<li><a href="https://github.com/ReactiveCocoa/ReactiveCocoa" target="_blank">Github-ReactiveCocoa</a></li>
<li><a href="https://www.tuicool.com/articles/BBNRRf" target="_blank">&#x54CD;&#x5E94;&#x5F0F;&#x7F16;&#x7A0B;&#xFF08;Reactive Programming&#xFF09;&#x4ECB;&#x7ECD;</a></li>
<li><a href="https://link.jianshu.com/?t=http://www.raywenderlich.com/?p=62699" target="_blank">UITextField-RAC&#x4F7F;&#x7528;&#x8BE6;&#x89E3;</a></li>
<li><a href="https://blog.harrisonxi.com/2017/07/iOS%E4%BD%BF%E7%94%A8RAC%E5%AE%9E%E7%8E%B0MVVM%E7%9A%84%E6%AD%A3%E7%BB%8F%E5%A7%BF%E5%8A%BF.html" target="_blank">iOS&#x4F7F;&#x7528;RAC&#x5B9E;&#x73B0;MVVM&#x7684;&#x6B63;&#x7ECF;&#x59FF;&#x52BF;</a></li>
<li><a href="https://draveness.me/raccommand/" target="_blank">&#x4F18;&#x96C5;&#x7684; RACCommand</a></li>
</ul>
<p><a href="http://timmy6.github.io/2019/02/27/MVVM/" target="_blank">http://timmy6.github.io/2019/02/27/MVVM/</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Part I">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../part2/" class="navigation navigation-next " aria-label="Next page: Part II">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Writing is nice","level":"1.2.1","depth":2,"next":{"title":"Part II","level":"1.3","depth":1,"path":"part2/README.md","ref":"part2/README.md","articles":[{"title":"We love feedback","level":"1.3.1","depth":2,"path":"part2/stackview.md","ref":"part2/stackview.md","articles":[]}]},"previous":{"title":"Part I","level":"1.2","depth":1,"path":"part1/README.md","ref":"part1/README.md","articles":[{"title":"Writing is nice","level":"1.2.1","depth":2,"path":"part1/reactivecocoa.md","ref":"part1/reactivecocoa.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["simple-page-toc","anchor-navigation-ex","-lunr","-search","search-plus","advanced-emoji","splitter","expandable-chapters-small","local-video","anchors","copy-code-button","alerts","include-csv","include-codeblock","ace","favicon","todo","emphasize","disqus"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"include-csv":{},"disqus":{"useIdentifier":false,"shortName":"samLau-Hua"},"emphasize":{},"ace":{},"simple-page-toc":{"maxDepth":3,"skipFirstH1":true},"todo":{},"splitter":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"mode":"float","pageTop":{"level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"showLevel":true,"showGoTop":true,"favicon":{"shortcut":"assets/favicon.ico","bookmark":"assets/favicon.ico","appleTouch":"assets/favicon.ico","appleTouchMore":{"120x120":"assets/favicon.ico","180x180":"assets/favicon.ico"}},"printLog":false,"multipleH1":true,"associatedWithSummary":true,"include-codeblock":{"template":"ace"},"float":{"floatIcon":"fa fa-navicon","level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false}},"favicon":{},"alerts":{},"expandable-chapters-small":{},"local-video":{},"copy-code-button":{},"advanced-emoji":{"embedEmojis":false},"include-codeblock":{"check":false,"edit":false,"fixlang":false,"lang":"","template":"default","theme":"chrome","unindent":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{},"search-plus":{}},"theme":"default","author":"Sam Lau","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Objective-C","language":"zh-hans","gitbook":"*","description":"记录学习Objective-C的知识点！"},"file":{"path":"part1/reactivecocoa.md","mtime":"2020-06-18T06:16:13.151Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-06-18T10:49:08.416Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-local-video/video.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-alerts/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-ace/ace/ace.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-ace/ace.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

